#map = affine_map<(d0, d1, d2) -> (d0, d1, d2)>
#map1 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, d3)>
module {
  func.func @subgraph0_decode(%arg0: tensor<151936x1536xf32>, 
  %arg1: tensor<1x1xi64>, //输入的数据
  %arg2: tensor<1xi64>,  //和下面是用一个，没用上
  %arg3: tensor<1xi64>,  //位置IDs 掩码
  %arg4: tensor<64xf32>,  // RoPE旋转位置编码的频率因子
  
  %arg5: tensor<1536xf32>, 
  %arg6: tensor<1536x1536xf32>, 
  %arg7: tensor<1536xf32>, 
  %arg8: tensor<256x1536xf32>, 
  %arg9: tensor<256xf32>, 
  %arg10: tensor<256x1536xf32>, 
  %arg11: tensor<256xf32>, 
  %arg12: tensor<1x2x1024x128xf32>, //v cache
  %arg13: tensor<1x2x1024x128xf32>, //k cache
  %arg14: tensor<1536x1536xf32>, 
  
  %arg15: tensor<1536xf32>, 
  %arg16: tensor<8960x1536xf32>, 
  %arg17: tensor<8960x1536xf32>, 
  %arg18: tensor<1536x8960xf32>, 
  
  %arg19: tensor<1536xf32>, %arg20: tensor<1536x1536xf32>, %arg21: tensor<1536xf32>, %arg22: tensor<256x1536xf32>, %arg23: tensor<256xf32>, %arg24: tensor<256x1536xf32>, %arg25: tensor<256xf32>, %arg26: tensor<1x2x1024x128xf32>, %arg27: tensor<1x2x1024x128xf32>, %arg28: tensor<1536x1536xf32>, %arg29: tensor<1536xf32>, %arg30: tensor<8960x1536xf32>, %arg31: tensor<8960x1536xf32>, %arg32: tensor<1536x8960xf32>, 
  %arg33: tensor<1536xf32>, %arg34: tensor<1536x1536xf32>, %arg35: tensor<1536xf32>, %arg36: tensor<256x1536xf32>, %arg37: tensor<256xf32>, %arg38: tensor<256x1536xf32>, %arg39: tensor<256xf32>, %arg40: tensor<1x2x1024x128xf32>, %arg41: tensor<1x2x1024x128xf32>, %arg42: tensor<1536x1536xf32>, %arg43: tensor<1536xf32>, %arg44: tensor<8960x1536xf32>, %arg45: tensor<8960x1536xf32>, %arg46: tensor<1536x8960xf32>, 
  %arg47: tensor<1536xf32>, %arg48: tensor<1536x1536xf32>, %arg49: tensor<1536xf32>, %arg50: tensor<256x1536xf32>, %arg51: tensor<256xf32>, %arg52: tensor<256x1536xf32>, %arg53: tensor<256xf32>, %arg54: tensor<1x2x1024x128xf32>, %arg55: tensor<1x2x1024x128xf32>, %arg56: tensor<1536x1536xf32>, %arg57: tensor<1536xf32>, %arg58: tensor<8960x1536xf32>, %arg59: tensor<8960x1536xf32>, %arg60: tensor<1536x8960xf32>, 
  %arg61: tensor<1536xf32>, %arg62: tensor<1536x1536xf32>, %arg63: tensor<1536xf32>, %arg64: tensor<256x1536xf32>, %arg65: tensor<256xf32>, %arg66: tensor<256x1536xf32>, %arg67: tensor<256xf32>, %arg68: tensor<1x2x1024x128xf32>, %arg69: tensor<1x2x1024x128xf32>, %arg70: tensor<1536x1536xf32>, %arg71: tensor<1536xf32>, %arg72: tensor<8960x1536xf32>, %arg73: tensor<8960x1536xf32>, %arg74: tensor<1536x8960xf32>, 
  %arg75: tensor<1536xf32>, %arg76: tensor<1536x1536xf32>, %arg77: tensor<1536xf32>, %arg78: tensor<256x1536xf32>, %arg79: tensor<256xf32>, %arg80: tensor<256x1536xf32>, %arg81: tensor<256xf32>, %arg82: tensor<1x2x1024x128xf32>, %arg83: tensor<1x2x1024x128xf32>, %arg84: tensor<1536x1536xf32>, %arg85: tensor<1536xf32>, %arg86: tensor<8960x1536xf32>, %arg87: tensor<8960x1536xf32>, %arg88: tensor<1536x8960xf32>, 
  %arg89: tensor<1536xf32>, %arg90: tensor<1536x1536xf32>, %arg91: tensor<1536xf32>, %arg92: tensor<256x1536xf32>, %arg93: tensor<256xf32>, %arg94: tensor<256x1536xf32>, %arg95: tensor<256xf32>, %arg96: tensor<1x2x1024x128xf32>, %arg97: tensor<1x2x1024x128xf32>, %arg98: tensor<1536x1536xf32>, %arg99: tensor<1536xf32>, %arg100: tensor<8960x1536xf32>, %arg101: tensor<8960x1536xf32>, %arg102: tensor<1536x8960xf32>, 
  %arg103: tensor<1536xf32>, %arg104: tensor<1536x1536xf32>, %arg105: tensor<1536xf32>, %arg106: tensor<256x1536xf32>, %arg107: tensor<256xf32>, %arg108: tensor<256x1536xf32>, %arg109: tensor<256xf32>, %arg110: tensor<1x2x1024x128xf32>, %arg111: tensor<1x2x1024x128xf32>, %arg112: tensor<1536x1536xf32>, %arg113: tensor<1536xf32>, %arg114: tensor<8960x1536xf32>, %arg115: tensor<8960x1536xf32>, %arg116: tensor<1536x8960xf32>, 
  %arg117: tensor<1536xf32>, %arg118: tensor<1536x1536xf32>, %arg119: tensor<1536xf32>, %arg120: tensor<256x1536xf32>, %arg121: tensor<256xf32>, %arg122: tensor<256x1536xf32>, %arg123: tensor<256xf32>, %arg124: tensor<1x2x1024x128xf32>, %arg125: tensor<1x2x1024x128xf32>, %arg126: tensor<1536x1536xf32>, %arg127: tensor<1536xf32>, %arg128: tensor<8960x1536xf32>, %arg129: tensor<8960x1536xf32>, %arg130: tensor<1536x8960xf32>, 
  %arg131: tensor<1536xf32>, %arg132: tensor<1536x1536xf32>, %arg133: tensor<1536xf32>, %arg134: tensor<256x1536xf32>, %arg135: tensor<256xf32>, %arg136: tensor<256x1536xf32>, %arg137: tensor<256xf32>, %arg138: tensor<1x2x1024x128xf32>, %arg139: tensor<1x2x1024x128xf32>, %arg140: tensor<1536x1536xf32>, %arg141: tensor<1536xf32>, %arg142: tensor<8960x1536xf32>, %arg143: tensor<8960x1536xf32>, %arg144: tensor<1536x8960xf32>, 
  %arg145: tensor<1536xf32>, %arg146: tensor<1536x1536xf32>, %arg147: tensor<1536xf32>, %arg148: tensor<256x1536xf32>, %arg149: tensor<256xf32>, %arg150: tensor<256x1536xf32>, %arg151: tensor<256xf32>, %arg152: tensor<1x2x1024x128xf32>, %arg153: tensor<1x2x1024x128xf32>, %arg154: tensor<1536x1536xf32>, %arg155: tensor<1536xf32>, %arg156: tensor<8960x1536xf32>, %arg157: tensor<8960x1536xf32>, %arg158: tensor<1536x8960xf32>, 
  %arg159: tensor<1536xf32>, %arg160: tensor<1536x1536xf32>, %arg161: tensor<1536xf32>, %arg162: tensor<256x1536xf32>, %arg163: tensor<256xf32>, %arg164: tensor<256x1536xf32>, %arg165: tensor<256xf32>, %arg166: tensor<1x2x1024x128xf32>, %arg167: tensor<1x2x1024x128xf32>, %arg168: tensor<1536x1536xf32>, %arg169: tensor<1536xf32>, %arg170: tensor<8960x1536xf32>, %arg171: tensor<8960x1536xf32>, %arg172: tensor<1536x8960xf32>, 
  %arg173: tensor<1536xf32>, %arg174: tensor<1536x1536xf32>, %arg175: tensor<1536xf32>, %arg176: tensor<256x1536xf32>, %arg177: tensor<256xf32>, %arg178: tensor<256x1536xf32>, %arg179: tensor<256xf32>, %arg180: tensor<1x2x1024x128xf32>, %arg181: tensor<1x2x1024x128xf32>, %arg182: tensor<1536x1536xf32>, %arg183: tensor<1536xf32>, %arg184: tensor<8960x1536xf32>, %arg185: tensor<8960x1536xf32>, %arg186: tensor<1536x8960xf32>, 
  %arg187: tensor<1536xf32>, %arg188: tensor<1536x1536xf32>, %arg189: tensor<1536xf32>, %arg190: tensor<256x1536xf32>, %arg191: tensor<256xf32>, %arg192: tensor<256x1536xf32>, %arg193: tensor<256xf32>, %arg194: tensor<1x2x1024x128xf32>, %arg195: tensor<1x2x1024x128xf32>, %arg196: tensor<1536x1536xf32>, %arg197: tensor<1536xf32>, %arg198: tensor<8960x1536xf32>, %arg199: tensor<8960x1536xf32>, %arg200: tensor<1536x8960xf32>, 
  %arg201: tensor<1536xf32>, %arg202: tensor<1536x1536xf32>, %arg203: tensor<1536xf32>, %arg204: tensor<256x1536xf32>, %arg205: tensor<256xf32>, %arg206: tensor<256x1536xf32>, %arg207: tensor<256xf32>, %arg208: tensor<1x2x1024x128xf32>, %arg209: tensor<1x2x1024x128xf32>, %arg210: tensor<1536x1536xf32>, %arg211: tensor<1536xf32>, %arg212: tensor<8960x1536xf32>, %arg213: tensor<8960x1536xf32>, %arg214: tensor<1536x8960xf32>, 
  %arg215: tensor<1536xf32>, %arg216: tensor<1536x1536xf32>, %arg217: tensor<1536xf32>, %arg218: tensor<256x1536xf32>, %arg219: tensor<256xf32>, %arg220: tensor<256x1536xf32>, %arg221: tensor<256xf32>, %arg222: tensor<1x2x1024x128xf32>, %arg223: tensor<1x2x1024x128xf32>, %arg224: tensor<1536x1536xf32>, %arg225: tensor<1536xf32>, %arg226: tensor<8960x1536xf32>, %arg227: tensor<8960x1536xf32>, %arg228: tensor<1536x8960xf32>, 
  %arg229: tensor<1536xf32>, %arg230: tensor<1536x1536xf32>, %arg231: tensor<1536xf32>, %arg232: tensor<256x1536xf32>, %arg233: tensor<256xf32>, %arg234: tensor<256x1536xf32>, %arg235: tensor<256xf32>, %arg236: tensor<1x2x1024x128xf32>, %arg237: tensor<1x2x1024x128xf32>, %arg238: tensor<1536x1536xf32>, %arg239: tensor<1536xf32>, %arg240: tensor<8960x1536xf32>, %arg241: tensor<8960x1536xf32>, %arg242: tensor<1536x8960xf32>, 
  %arg243: tensor<1536xf32>, %arg244: tensor<1536x1536xf32>, %arg245: tensor<1536xf32>, %arg246: tensor<256x1536xf32>, %arg247: tensor<256xf32>, %arg248: tensor<256x1536xf32>, %arg249: tensor<256xf32>, %arg250: tensor<1x2x1024x128xf32>, %arg251: tensor<1x2x1024x128xf32>, %arg252: tensor<1536x1536xf32>, %arg253: tensor<1536xf32>, %arg254: tensor<8960x1536xf32>, %arg255: tensor<8960x1536xf32>, %arg256: tensor<1536x8960xf32>, 
  %arg257: tensor<1536xf32>, %arg258: tensor<1536x1536xf32>, %arg259: tensor<1536xf32>, %arg260: tensor<256x1536xf32>, %arg261: tensor<256xf32>, %arg262: tensor<256x1536xf32>, %arg263: tensor<256xf32>, %arg264: tensor<1x2x1024x128xf32>, %arg265: tensor<1x2x1024x128xf32>, %arg266: tensor<1536x1536xf32>, %arg267: tensor<1536xf32>, %arg268: tensor<8960x1536xf32>, %arg269: tensor<8960x1536xf32>, %arg270: tensor<1536x8960xf32>, 
  %arg271: tensor<1536xf32>, %arg272: tensor<1536x1536xf32>, %arg273: tensor<1536xf32>, %arg274: tensor<256x1536xf32>, %arg275: tensor<256xf32>, %arg276: tensor<256x1536xf32>, %arg277: tensor<256xf32>, %arg278: tensor<1x2x1024x128xf32>, %arg279: tensor<1x2x1024x128xf32>, %arg280: tensor<1536x1536xf32>, %arg281: tensor<1536xf32>, %arg282: tensor<8960x1536xf32>, %arg283: tensor<8960x1536xf32>, %arg284: tensor<1536x8960xf32>, 
  %arg285: tensor<1536xf32>, %arg286: tensor<1536x1536xf32>, %arg287: tensor<1536xf32>, %arg288: tensor<256x1536xf32>, %arg289: tensor<256xf32>, %arg290: tensor<256x1536xf32>, %arg291: tensor<256xf32>, %arg292: tensor<1x2x1024x128xf32>, %arg293: tensor<1x2x1024x128xf32>, %arg294: tensor<1536x1536xf32>, %arg295: tensor<1536xf32>, %arg296: tensor<8960x1536xf32>, %arg297: tensor<8960x1536xf32>, %arg298: tensor<1536x8960xf32>, 
  %arg299: tensor<1536xf32>, %arg300: tensor<1536x1536xf32>, %arg301: tensor<1536xf32>, %arg302: tensor<256x1536xf32>, %arg303: tensor<256xf32>, %arg304: tensor<256x1536xf32>, %arg305: tensor<256xf32>, %arg306: tensor<1x2x1024x128xf32>, %arg307: tensor<1x2x1024x128xf32>, %arg308: tensor<1536x1536xf32>, %arg309: tensor<1536xf32>, %arg310: tensor<8960x1536xf32>, %arg311: tensor<8960x1536xf32>, %arg312: tensor<1536x8960xf32>, 
  %arg313: tensor<1536xf32>, %arg314: tensor<1536x1536xf32>, %arg315: tensor<1536xf32>, %arg316: tensor<256x1536xf32>, %arg317: tensor<256xf32>, %arg318: tensor<256x1536xf32>, %arg319: tensor<256xf32>, %arg320: tensor<1x2x1024x128xf32>, %arg321: tensor<1x2x1024x128xf32>, %arg322: tensor<1536x1536xf32>, %arg323: tensor<1536xf32>, %arg324: tensor<8960x1536xf32>, %arg325: tensor<8960x1536xf32>, %arg326: tensor<1536x8960xf32>, 
  %arg327: tensor<1536xf32>, %arg328: tensor<1536x1536xf32>, %arg329: tensor<1536xf32>, %arg330: tensor<256x1536xf32>, %arg331: tensor<256xf32>, %arg332: tensor<256x1536xf32>, %arg333: tensor<256xf32>, %arg334: tensor<1x2x1024x128xf32>, %arg335: tensor<1x2x1024x128xf32>, %arg336: tensor<1536x1536xf32>, %arg337: tensor<1536xf32>, %arg338: tensor<8960x1536xf32>, %arg339: tensor<8960x1536xf32>, %arg340: tensor<1536x8960xf32>, 
  %arg341: tensor<1536xf32>, %arg342: tensor<1536x1536xf32>, %arg343: tensor<1536xf32>, %arg344: tensor<256x1536xf32>, %arg345: tensor<256xf32>, %arg346: tensor<256x1536xf32>, %arg347: tensor<256xf32>, %arg348: tensor<1x2x1024x128xf32>, %arg349: tensor<1x2x1024x128xf32>, %arg350: tensor<1536x1536xf32>, %arg351: tensor<1536xf32>, %arg352: tensor<8960x1536xf32>, %arg353: tensor<8960x1536xf32>, %arg354: tensor<1536x8960xf32>, 
  %arg355: tensor<1536xf32>, %arg356: tensor<1536x1536xf32>, %arg357: tensor<1536xf32>, %arg358: tensor<256x1536xf32>, %arg359: tensor<256xf32>, %arg360: tensor<256x1536xf32>, %arg361: tensor<256xf32>, %arg362: tensor<1x2x1024x128xf32>, %arg363: tensor<1x2x1024x128xf32>, %arg364: tensor<1536x1536xf32>, %arg365: tensor<1536xf32>, %arg366: tensor<8960x1536xf32>, %arg367: tensor<8960x1536xf32>, %arg368: tensor<1536x8960xf32>, 
  %arg369: tensor<1536xf32>, %arg370: tensor<1536x1536xf32>, %arg371: tensor<1536xf32>, %arg372: tensor<256x1536xf32>, %arg373: tensor<256xf32>, %arg374: tensor<256x1536xf32>, %arg375: tensor<256xf32>, %arg376: tensor<1x2x1024x128xf32>, %arg377: tensor<1x2x1024x128xf32>, %arg378: tensor<1536x1536xf32>, %arg379: tensor<1536xf32>, %arg380: tensor<8960x1536xf32>, %arg381: tensor<8960x1536xf32>, %arg382: tensor<1536x8960xf32>, 
  %arg383: tensor<1536xf32>, %arg384: tensor<1536x1536xf32>, %arg385: tensor<1536xf32>, %arg386: tensor<256x1536xf32>, %arg387: tensor<256xf32>, %arg388: tensor<256x1536xf32>, %arg389: tensor<256xf32>, %arg390: tensor<1x2x1024x128xf32>, %arg391: tensor<1x2x1024x128xf32>, %arg392: tensor<1536x1536xf32>, %arg393: tensor<1536xf32>, %arg394: tensor<8960x1536xf32>, %arg395: tensor<8960x1536xf32>, %arg396: tensor<1536x8960xf32>, 
  
  %arg397: tensor<1536xf32>, %arg398: tensor<151936x1536xf32>)
  -> (tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, 
  tensor<1x1x151936xf32>) {
    // ===========================================
    // 1. TOKEN EMBEDDING LAYER
    // ===========================================
    // Input: %arg1 (1x40xi64) - token IDs for sequence of length 40
    // Embedding weights: %arg0 (151936x1536) - vocabulary_size x hidden_dim
    // Output: token embeddings (1x40x1536)
    //embedding
    %0 = tosa.cast %arg1 : (tensor<1x1xi64>) -> tensor<1x1xi32>
    %1 = tosa.reshape %arg0 {new_shape = array<i64: 1, 151936, 1536>} : (tensor<151936x1536xf32>) -> tensor<1x151936x1536xf32>
    %2 = tosa.gather %1, %0 : (tensor<1x151936x1536xf32>, tensor<1x1xi32>) -> tensor<1x1x1536xf32>
    // 2. POSITIONAL ENCODING/mask
    // unsqueeze -- expand_1
    %3 = tosa.reshape %arg3 {new_shape = array<i64: 1, 1>} : (tensor<1xi64>) -> tensor<1x1xi64>
    %4 = "tosa.const"() <{value = dense<"0x00000000000000000100000000000000020000000000000003000000000000000400000000000000050000000000000006000000000000000700000000000000080000000000000009000000000000000A000000000000000B000000000000000C000000000000000D000000000000000E000000000000000F0000000000000010000000000000001100000000000000120000000000000013000000000000001400000000000000150000000000000016000000000000001700000000000000180000000000000019000000000000001A000000000000001B000000000000001C000000000000001D000000000000001E000000000000001F0000000000000020000000000000002100000000000000220000000000000023000000000000002400000000000000250000000000000026000000000000002700000000000000280000000000000029000000000000002A000000000000002B000000000000002C000000000000002D000000000000002E000000000000002F0000000000000030000000000000003100000000000000320000000000000033000000000000003400000000000000350000000000000036000000000000003700000000000000380000000000000039000000000000003A000000000000003B000000000000003C000000000000003D000000000000003E000000000000003F0000000000000040000000000000004100000000000000420000000000000043000000000000004400000000000000450000000000000046000000000000004700000000000000480000000000000049000000000000004A000000000000004B000000000000004C000000000000004D000000000000004E000000000000004F0000000000000050000000000000005100000000000000520000000000000053000000000000005400000000000000550000000000000056000000000000005700000000000000580000000000000059000000000000005A000000000000005B000000000000005C000000000000005D000000000000005E000000000000005F0000000000000060000000000000006100000000000000620000000000000063000000000000006400000000000000650000000000000066000000000000006700000000000000680000000000000069000000000000006A000000000000006B000000000000006C000000000000006D000000000000006E000000000000006F0000000000000070000000000000007100000000000000720000000000000073000000000000007400000000000000750000000000000076000000000000007700000000000000780000000000000079000000000000007A000000000000007B000000000000007C000000000000007D000000000000007E000000000000007F0000000000000080000000000000008100000000000000820000000000000083000000000000008400000000000000850000000000000086000000000000008700000000000000880000000000000089000000000000008A000000000000008B000000000000008C000000000000008D000000000000008E000000000000008F0000000000000090000000000000009100000000000000920000000000000093000000000000009400000000000000950000000000000096000000000000009700000000000000980000000000000099000000000000009A000000000000009B000000000000009C000000000000009D000000000000009E000000000000009F00000000000000A000000000000000A100000000000000A200000000000000A300000000000000A400000000000000A500000000000000A600000000000000A700000000000000A800000000000000A900000000000000AA00000000000000AB00000000000000AC00000000000000AD00000000000000AE00000000000000AF00000000000000B000000000000000B100000000000000B200000000000000B300000000000000B400000000000000B500000000000000B600000000000000B700000000000000B800000000000000B900000000000000BA00000000000000BB00000000000000BC00000000000000BD00000000000000BE00000000000000BF00000000000000C000000000000000C100000000000000C200000000000000C300000000000000C400000000000000C500000000000000C600000000000000C700000000000000C800000000000000C900000000000000CA00000000000000CB00000000000000CC00000000000000CD00000000000000CE00000000000000CF00000000000000D000000000000000D100000000000000D200000000000000D300000000000000D400000000000000D500000000000000D600000000000000D700000000000000D800000000000000D900000000000000DA00000000000000DB00000000000000DC00000000000000DD00000000000000DE00000000000000DF00000000000000E000000000000000E100000000000000E200000000000000E300000000000000E400000000000000E500000000000000E600000000000000E700000000000000E800000000000000E900000000000000EA00000000000000EB00000000000000EC00000000000000ED00000000000000EE00000000000000EF00000000000000F000000000000000F100000000000000F200000000000000F300000000000000F400000000000000F500000000000000F600000000000000F700000000000000F800000000000000F900000000000000FA00000000000000FB00000000000000FC00000000000000FD00000000000000FE00000000000000FF0000000000000000010000000000000101000000000000020100000000000003010000000000000401000000000000050100000000000006010000000000000701000000000000080100000000000009010000000000000A010000000000000B010000000000000C010000000000000D010000000000000E010000000000000F0100000000000010010000000000001101000000000000120100000000000013010000000000001401000000000000150100000000000016010000000000001701000000000000180100000000000019010000000000001A010000000000001B010000000000001C010000000000001D010000000000001E010000000000001F0100000000000020010000000000002101000000000000220100000000000023010000000000002401000000000000250100000000000026010000000000002701000000000000280100000000000029010000000000002A010000000000002B010000000000002C010000000000002D010000000000002E010000000000002F0100000000000030010000000000003101000000000000320100000000000033010000000000003401000000000000350100000000000036010000000000003701000000000000380100000000000039010000000000003A010000000000003B010000000000003C010000000000003D010000000000003E010000000000003F0100000000000040010000000000004101000000000000420100000000000043010000000000004401000000000000450100000000000046010000000000004701000000000000480100000000000049010000000000004A010000000000004B010000000000004C010000000000004D010000000000004E010000000000004F0100000000000050010000000000005101000000000000520100000000000053010000000000005401000000000000550100000000000056010000000000005701000000000000580100000000000059010000000000005A010000000000005B010000000000005C010000000000005D010000000000005E010000000000005F0100000000000060010000000000006101000000000000620100000000000063010000000000006401000000000000650100000000000066010000000000006701000000000000680100000000000069010000000000006A010000000000006B010000000000006C010000000000006D010000000000006E010000000000006F0100000000000070010000000000007101000000000000720100000000000073010000000000007401000000000000750100000000000076010000000000007701000000000000780100000000000079010000000000007A010000000000007B010000000000007C010000000000007D010000000000007E010000000000007F0100000000000080010000000000008101000000000000820100000000000083010000000000008401000000000000850100000000000086010000000000008701000000000000880100000000000089010000000000008A010000000000008B010000000000008C010000000000008D010000000000008E010000000000008F0100000000000090010000000000009101000000000000920100000000000093010000000000009401000000000000950100000000000096010000000000009701000000000000980100000000000099010000000000009A010000000000009B010000000000009C010000000000009D010000000000009E010000000000009F01000000000000A001000000000000A101000000000000A201000000000000A301000000000000A401000000000000A501000000000000A601000000000000A701000000000000A801000000000000A901000000000000AA01000000000000AB01000000000000AC01000000000000AD01000000000000AE01000000000000AF01000000000000B001000000000000B101000000000000B201000000000000B301000000000000B401000000000000B501000000000000B601000000000000B701000000000000B801000000000000B901000000000000BA01000000000000BB01000000000000BC01000000000000BD01000000000000BE01000000000000BF01000000000000C001000000000000C101000000000000C201000000000000C301000000000000C401000000000000C501000000000000C601000000000000C701000000000000C801000000000000C901000000000000CA01000000000000CB01000000000000CC01000000000000CD01000000000000CE01000000000000CF01000000000000D001000000000000D101000000000000D201000000000000D301000000000000D401000000000000D501000000000000D601000000000000D701000000000000D801000000000000D901000000000000DA01000000000000DB01000000000000DC01000000000000DD01000000000000DE01000000000000DF01000000000000E001000000000000E101000000000000E201000000000000E301000000000000E401000000000000E501000000000000E601000000000000E701000000000000E801000000000000E901000000000000EA01000000000000EB01000000000000EC01000000000000ED01000000000000EE01000000000000EF01000000000000F001000000000000F101000000000000F201000000000000F301000000000000F401000000000000F501000000000000F601000000000000F701000000000000F801000000000000F901000000000000FA01000000000000FB01000000000000FC01000000000000FD01000000000000FE01000000000000FF0100000000000000020000000000000102000000000000020200000000000003020000000000000402000000000000050200000000000006020000000000000702000000000000080200000000000009020000000000000A020000000000000B020000000000000C020000000000000D020000000000000E020000000000000F0200000000000010020000000000001102000000000000120200000000000013020000000000001402000000000000150200000000000016020000000000001702000000000000180200000000000019020000000000001A020000000000001B020000000000001C020000000000001D020000000000001E020000000000001F0200000000000020020000000000002102000000000000220200000000000023020000000000002402000000000000250200000000000026020000000000002702000000000000280200000000000029020000000000002A020000000000002B020000000000002C020000000000002D020000000000002E020000000000002F0200000000000030020000000000003102000000000000320200000000000033020000000000003402000000000000350200000000000036020000000000003702000000000000380200000000000039020000000000003A020000000000003B020000000000003C020000000000003D020000000000003E020000000000003F0200000000000040020000000000004102000000000000420200000000000043020000000000004402000000000000450200000000000046020000000000004702000000000000480200000000000049020000000000004A020000000000004B020000000000004C020000000000004D020000000000004E020000000000004F0200000000000050020000000000005102000000000000520200000000000053020000000000005402000000000000550200000000000056020000000000005702000000000000580200000000000059020000000000005A020000000000005B020000000000005C020000000000005D020000000000005E020000000000005F0200000000000060020000000000006102000000000000620200000000000063020000000000006402000000000000650200000000000066020000000000006702000000000000680200000000000069020000000000006A020000000000006B020000000000006C020000000000006D020000000000006E020000000000006F0200000000000070020000000000007102000000000000720200000000000073020000000000007402000000000000750200000000000076020000000000007702000000000000780200000000000079020000000000007A020000000000007B020000000000007C020000000000007D020000000000007E020000000000007F0200000000000080020000000000008102000000000000820200000000000083020000000000008402000000000000850200000000000086020000000000008702000000000000880200000000000089020000000000008A020000000000008B020000000000008C020000000000008D020000000000008E020000000000008F0200000000000090020000000000009102000000000000920200000000000093020000000000009402000000000000950200000000000096020000000000009702000000000000980200000000000099020000000000009A020000000000009B020000000000009C020000000000009D020000000000009E020000000000009F02000000000000A002000000000000A102000000000000A202000000000000A302000000000000A402000000000000A502000000000000A602000000000000A702000000000000A802000000000000A902000000000000AA02000000000000AB02000000000000AC02000000000000AD02000000000000AE02000000000000AF02000000000000B002000000000000B102000000000000B202000000000000B302000000000000B402000000000000B502000000000000B602000000000000B702000000000000B802000000000000B902000000000000BA02000000000000BB02000000000000BC02000000000000BD02000000000000BE02000000000000BF02000000000000C002000000000000C102000000000000C202000000000000C302000000000000C402000000000000C502000000000000C602000000000000C702000000000000C802000000000000C902000000000000CA02000000000000CB02000000000000CC02000000000000CD02000000000000CE02000000000000CF02000000000000D002000000000000D102000000000000D202000000000000D302000000000000D402000000000000D502000000000000D602000000000000D702000000000000D802000000000000D902000000000000DA02000000000000DB02000000000000DC02000000000000DD02000000000000DE02000000000000DF02000000000000E002000000000000E102000000000000E202000000000000E302000000000000E402000000000000E502000000000000E602000000000000E702000000000000E802000000000000E902000000000000EA02000000000000EB02000000000000EC02000000000000ED02000000000000EE02000000000000EF02000000000000F002000000000000F102000000000000F202000000000000F302000000000000F402000000000000F502000000000000F602000000000000F702000000000000F802000000000000F902000000000000FA02000000000000FB02000000000000FC02000000000000FD02000000000000FE02000000000000FF0200000000000000030000000000000103000000000000020300000000000003030000000000000403000000000000050300000000000006030000000000000703000000000000080300000000000009030000000000000A030000000000000B030000000000000C030000000000000D030000000000000E030000000000000F0300000000000010030000000000001103000000000000120300000000000013030000000000001403000000000000150300000000000016030000000000001703000000000000180300000000000019030000000000001A030000000000001B030000000000001C030000000000001D030000000000001E030000000000001F0300000000000020030000000000002103000000000000220300000000000023030000000000002403000000000000250300000000000026030000000000002703000000000000280300000000000029030000000000002A030000000000002B030000000000002C030000000000002D030000000000002E030000000000002F0300000000000030030000000000003103000000000000320300000000000033030000000000003403000000000000350300000000000036030000000000003703000000000000380300000000000039030000000000003A030000000000003B030000000000003C030000000000003D030000000000003E030000000000003F0300000000000040030000000000004103000000000000420300000000000043030000000000004403000000000000450300000000000046030000000000004703000000000000480300000000000049030000000000004A030000000000004B030000000000004C030000000000004D030000000000004E030000000000004F0300000000000050030000000000005103000000000000520300000000000053030000000000005403000000000000550300000000000056030000000000005703000000000000580300000000000059030000000000005A030000000000005B030000000000005C030000000000005D030000000000005E030000000000005F0300000000000060030000000000006103000000000000620300000000000063030000000000006403000000000000650300000000000066030000000000006703000000000000680300000000000069030000000000006A030000000000006B030000000000006C030000000000006D030000000000006E030000000000006F0300000000000070030000000000007103000000000000720300000000000073030000000000007403000000000000750300000000000076030000000000007703000000000000780300000000000079030000000000007A030000000000007B030000000000007C030000000000007D030000000000007E030000000000007F0300000000000080030000000000008103000000000000820300000000000083030000000000008403000000000000850300000000000086030000000000008703000000000000880300000000000089030000000000008A030000000000008B030000000000008C030000000000008D030000000000008E030000000000008F0300000000000090030000000000009103000000000000920300000000000093030000000000009403000000000000950300000000000096030000000000009703000000000000980300000000000099030000000000009A030000000000009B030000000000009C030000000000009D030000000000009E030000000000009F03000000000000A003000000000000A103000000000000A203000000000000A303000000000000A403000000000000A503000000000000A603000000000000A703000000000000A803000000000000A903000000000000AA03000000000000AB03000000000000AC03000000000000AD03000000000000AE03000000000000AF03000000000000B003000000000000B103000000000000B203000000000000B303000000000000B403000000000000B503000000000000B603000000000000B703000000000000B803000000000000B903000000000000BA03000000000000BB03000000000000BC03000000000000BD03000000000000BE03000000000000BF03000000000000C003000000000000C103000000000000C203000000000000C303000000000000C403000000000000C503000000000000C603000000000000C703000000000000C803000000000000C903000000000000CA03000000000000CB03000000000000CC03000000000000CD03000000000000CE03000000000000CF03000000000000D003000000000000D103000000000000D203000000000000D303000000000000D403000000000000D503000000000000D603000000000000D703000000000000D803000000000000D903000000000000DA03000000000000DB03000000000000DC03000000000000DD03000000000000DE03000000000000DF03000000000000E003000000000000E103000000000000E203000000000000E303000000000000E403000000000000E503000000000000E603000000000000E703000000000000E803000000000000E903000000000000EA03000000000000EB03000000000000EC03000000000000ED03000000000000EE03000000000000EF03000000000000F003000000000000F103000000000000F203000000000000F303000000000000F403000000000000F503000000000000F603000000000000F703000000000000F803000000000000F903000000000000FA03000000000000FB03000000000000FC03000000000000FD03000000000000FE03000000000000FF03000000000000"> : tensor<1024xi64>}> : () -> tensor<1024xi64>
    %5 = "tosa.const"() <{value = dense<0> : tensor<1024xi64>}> : () -> tensor<1024xi64>
    %6 = tosa.add %4, %5 : (tensor<1024xi64>, tensor<1024xi64>) -> tensor<1024xi64>
    %7 = tosa.reshape %arg3 {new_shape = array<i64: 1, 1>} : (tensor<1xi64>) -> tensor<1x1xi64>
    %8 = "tosa.const"() <{value = dense<0> : tensor<1x1024xi64>}> : () -> tensor<1x1024xi64>
    %9 = tosa.reshape %6 {new_shape = array<i64: 1, 1024>} : (tensor<1024xi64>) -> tensor<1x1024xi64>
    %10 = tosa.add %9, %8 : (tensor<1x1024xi64>, tensor<1x1024xi64>) -> tensor<1x1024xi64>
    %11 = "tosa.const"() <{value = dense<0> : tensor<1x1024xi64>}> : () -> tensor<1x1024xi64>
    %12 = tosa.add %7, %11 : (tensor<1x1xi64>, tensor<1x1024xi64>) -> tensor<1x1024xi64>
    %13 = arith.cmpi ule, %10, %12 : tensor<1x1024xi64>
    %14 = "tosa.const"() <{value = dense<false> : tensor<1x1xi1>}> : () -> tensor<1x1xi1>
    %15 = tosa.add %13, %14 : (tensor<1x1024xi1>, tensor<1x1xi1>) -> tensor<1x1024xi1>
    %16 = "tosa.const"() <{value = dense<false> : tensor<1x1xi1>}> : () -> tensor<1x1xi1>
    %17 = tosa.add %15, %16 : (tensor<1x1024xi1>, tensor<1x1xi1>) -> tensor<1x1024xi1>
    
    // Generate Rotary Position Embedding (RoPE)
    // %arg3 contains the rotary embedding frequencies (64 dimensions)
    // unsqueeze_1 -- mul_1
    %18 = tosa.reshape %arg4 {new_shape = array<i64: 1, 64>} : (tensor<64xf32>) -> tensor<1x64xf32>
    %19 = tosa.reshape %18 {new_shape = array<i64: 1, 64, 1>} : (tensor<1x64xf32>) -> tensor<1x64x1xf32>
    %20 = tosa.reshape %3 {new_shape = array<i64: 1, 1, 1>} : (tensor<1x1xi64>) -> tensor<1x1x1xi64>
    %21 = tosa.cast %20 : (tensor<1x1x1xi64>) -> tensor<1x1x1xf32>
    %22 = tosa.matmul %19, %21 : (tensor<1x64x1xf32>, tensor<1x1x1xf32>) -> tensor<1x64x1xf32>
    %23 = "tosa.const"() <{value = dense<[0, 2, 1]> : tensor<3xi32>}> : () -> tensor<3xi32>
    %24 = tosa.transpose %22, %23 : (tensor<1x64x1xf32>, tensor<3xi32>) -> tensor<1x1x64xf32>
    %25 = tosa.reshape %24 {new_shape = array<i64: 1, 1, 1, 64>} : (tensor<1x1x64xf32>) -> tensor<1x1x1x64xf32>
    %26 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x1x2x64xf32>}> : () -> tensor<1x1x2x64xf32>
    %27 = tosa.add %25, %26 : (tensor<1x1x1x64xf32>, tensor<1x1x2x64xf32>) -> tensor<1x1x2x64xf32>
    %28 = tosa.reshape %27 {new_shape = array<i64: 1, 1, 128>} : (tensor<1x1x2x64xf32>) -> tensor<1x1x128xf32>
    %29 = math.cos %28 : tensor<1x1x128xf32>
    %cst = arith.constant dense<1.000000e+00> : tensor<1xf32>
    %30 = tosa.reshape %cst {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %31 = tosa.mul %29, %30 : (tensor<1x1x128xf32>, tensor<1x1x1xf32>) -> tensor<1x1x128xf32>
    %32 = math.sin %28 : tensor<1x1x128xf32>
    %cst_0 = arith.constant dense<1.000000e+00> : tensor<1xf32>
    %33 = tosa.reshape %cst_0 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %34 = tosa.mul %32, %33 : (tensor<1x1x128xf32>, tensor<1x1x1xf32>) -> tensor<1x1x128xf32>
    
    // ===========================================
    // 3. LAYER NORMALIZATION (Pre-Attention)
    // ===========================================
    // Apply layer normalization before attention mechanism
    // Weights: %arg4 (1536xf32) - layer norm scale
    // Bias: %arg6 (1536xf32) - layer norm bias
    // pow_1 -- mul_3 6个
    %35 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32 = arith.constant 2 : i32
    %36 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2 : tensor<1x1x1536xf32>) outs(%35 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %37 = tosa.reduce_sum %36 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %38 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %39 = tosa.reciprocal %38 : (tensor<1xf32>) -> tensor<1xf32>
    %40 = tosa.reshape %39 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %41 = tosa.mul %40, %37 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %42 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %43 = tosa.add %41, %42 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %44 = tosa.rsqrt %43 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %45 = tosa.mul %2, %44 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %46 = tosa.reshape %arg5 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %47 = tosa.mul %46, %45 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    
    // ===========================================
    // 4. MULTI-HEAD ATTENTION MECHANISM
    // ===========================================
    // Generate Query, Key, Value projections for attention
    // Model has 12 attention heads, 128 dimensions per head

    // Query Projection: %arg7 (256x1536) -> Q weights
    // view_5 -- permute_2 6个
    %48 = tosa.reshape %47 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %49 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %50 = tosa.transpose %arg6, %49 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %51 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%48, %50 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_1 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %52 = tosa.reshape %arg7 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %53 = tosa.add %52, %51 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %54 = tosa.reshape %53 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %55 = tosa.reshape %54 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %56 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %57 = tosa.transpose %55, %56 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    
    // Key Projection: %arg9 (256x1536) -> K weights
    // view_8 -- permute_4 6个
    %58 = tosa.reshape %47 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %59 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %60 = tosa.transpose %arg8, %59 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_2 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %61 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%58, %60 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_2 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %62 = tosa.reshape %arg9 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %63 = tosa.add %62, %61 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %64 = tosa.reshape %63 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %65 = tosa.reshape %64 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %66 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %67 = tosa.transpose %65, %66 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    
    //v %95 v cache
    // view_11 --- permute_6 6个
    %68 = tosa.reshape %47 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %69 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %70 = tosa.transpose %arg10, %69 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_3 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %71 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%68, %70 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_3 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %72 = tosa.reshape %arg11 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %73 = tosa.add %72, %71 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %74 = tosa.reshape %73 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %75 = tosa.reshape %74 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %76 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %77 = tosa.transpose %75, %76 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    
    // Apply RoPE (Rotary Position Embedding) to Q, K vectors
    //unsqueeze_5 -- unsqueeze_6 2
    %78 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %79 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    //Q
    // mul_4 -- add_2 7个 Children: attention
    %80 = tosa.mul %57, %78 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice = tensor.extract_slice %57[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_4 = tensor.extract_slice %57[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %81 = tensor.empty() : tensor<1x12x1x64xf32>
    %82 = linalg.negf ins(%extracted_slice_4 : tensor<1x12x1x64xf32>) outs(%81 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %83 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice = tensor.insert_slice %82 into %83[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_5 = tensor.insert_slice %extracted_slice into %inserted_slice[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %84 = tosa.mul %inserted_slice_5, %79 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %85 = tosa.add %80, %84 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    //K %99 k chache 
  // mul_6 -- add3 7个 Children: ['index_put']
    %86 = tosa.mul %67, %78 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_6 = tensor.extract_slice %67[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_7 = tensor.extract_slice %67[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %87 = tensor.empty() : tensor<1x2x1x64xf32>
    %88 = linalg.negf ins(%extracted_slice_7 : tensor<1x2x1x64xf32>) outs(%87 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %89 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_8 = tensor.insert_slice %88 into %89[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_9 = tensor.insert_slice %extracted_slice_6 into %inserted_slice_8[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %90 = tosa.mul %inserted_slice_9, %79 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %91 = tosa.add %86, %90 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    
    // index_put -- Children: ['slice_12', 'output'] 1
    //更新k cache : 把这一步生成的 K 向量，放入全局 K cache 的正确位置
    // %95 传到下一个的cache
    %92 = bufferization.to_memref %arg12 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %93 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %94 = bufferization.to_memref %91 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0 = arith.constant 0 : index
    %c1 = arith.constant 1 : index
    %c1_10 = arith.constant 1 : index
    %c2 = arith.constant 2 : index
    %c1_11 = arith.constant 1 : index
    %c128 = arith.constant 128 : index
    scf.for %arg399 = %c0 to %c1_10 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1_11 step %c1 {
          %3945 = memref.load %93[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %3947 = memref.load %94[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %92[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %95 = bufferization.to_tensor %92 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    
    //更新v cache
// index_put_1 -- Children: ['slice_20', 'output'] 1
    %96 = bufferization.to_memref %arg13 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %97 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %98 = bufferization.to_memref %77 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_12 = arith.constant 0 : index
    %c1_13 = arith.constant 1 : index
    %c1_14 = arith.constant 1 : index
    %c2_15 = arith.constant 2 : index
    %c1_16 = arith.constant 1 : index
    %c128_17 = arith.constant 128 : index
    scf.for %arg399 = %c0_12 to %c1_14 step %c1_13 {
      scf.for %arg400 = %c0_12 to %c2_15 step %c1_13 {
        scf.for %arg401 = %c0_12 to %c1_16 step %c1_13 {
          %3945 = memref.load %97[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_12 to %c128_17 step %c1_13 {
            %3947 = memref.load %98[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %96[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %99 = bufferization.to_tensor %96 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    //logits = (Q K^T) / sqrt(d_head) + mask%17
    // slice_12 -- view_15 Children: ['_scaled_dot_product_flash_attention_for_cpu'] 16
    %100 = tosa.reshape %95 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %101 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %102 = tosa.add %100, %101 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %103 = tosa.reshape %102 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %104 = tosa.reshape %99 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %105 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %106 = tosa.add %104, %105 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %107 = tosa.reshape %106 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    //生成 Mask
    // slice_24 -- where 6 
    %108 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_18 = arith.constant 0xFF800000 : f32
    %cst_19 = arith.constant 0.000000e+00 : f32
    %109 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat = tensor.splat %cst_19 : tensor<1x1x1x1024xf32>
    %splat_20 = tensor.splat %cst_18 : tensor<1x1x1x1024xf32>
    %110 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%108, %splat, %splat_20 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%109 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    
    // attention  一个算子
    %cst_21 = arith.constant 0.000000e+00 : f32
    %splat_22 = tensor.splat %cst_21 : tensor<1x1024xf32>
    %111 = tosa.reshape %110 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %112 = tosa.add %splat_22, %111 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    //Q·K^T
    %113 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %114 = tosa.transpose %103, %113 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %115 = tosa.reshape %85 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %116 = tosa.reshape %114 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %117 = tosa.matmul %115, %116 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_23 = arith.constant 0.0883883461 : f32
    %splat_24 = tensor.splat %cst_23 : tensor<12x1x1024xf32>
    %118 = tosa.mul %117, %splat_24 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %119 = tosa.reshape %112 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %120 = tosa.add %118, %119 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    
    // Apply softmax with numerical stability (log-sum-exp trick)
    %121 = tosa.reduce_max %120 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %122 = tosa.sub %120, %121 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %123 = math.exp %122 : tensor<12x1x1024xf32>
    %124 = tosa.reduce_sum %123 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %125 = tosa.log %124 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %126 = tosa.add %121, %125 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %127 = tosa.sub %120, %126 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %128 = math.exp %127 : tensor<12x1x1024xf32>
    %129 = tosa.reshape %126 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %130 = tosa.reshape %107 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %131 = tosa.matmul %128, %130 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %132 = tosa.reshape %131 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    
    
    // ===========================================
    // 6. OUTPUT PROJECTION & RESIDUAL CONNECTION
    // ===========================================
    // Project attention output back to hidden dimension
    // Add residual connection (attention output + input) 
    // getitem -- add_4 //6+2个
    %133 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %134 = tosa.transpose %132, %133 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %135 = tosa.reshape %134 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %136 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %137 = tosa.transpose %arg14, %136 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %138 = tosa.reshape %135 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_25 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %139 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%138, %137 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_25 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    
    // 残差连接 2
    %140 = tosa.reshape %139 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %141 = tosa.add %2, %140 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>

    // ===========================================
    // 7. LAYER NORMALIZATION (Pre-FFN)
    // ===========================================
    // Apply layer normalization before feed-forward network    
    // pow_2 -- mul_9 6
    %142 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_26 = arith.constant 2 : i32
    %143 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%141 : tensor<1x1x1536xf32>) outs(%142 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_26 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %144 = tosa.reduce_sum %143 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %145 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %146 = tosa.reciprocal %145 : (tensor<1xf32>) -> tensor<1xf32>
    %147 = tosa.reshape %146 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %148 = tosa.mul %147, %144 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %149 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %150 = tosa.add %148, %149 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %151 = tosa.rsqrt %150 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %152 = tosa.mul %141, %151 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %153 = tosa.reshape %arg15 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %154 = tosa.mul %153, %152 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    
    // ===========================================
    // 8. FEED-FORWARD NETWORK (FFN)
    // ===========================================
    // DeepSeek uses SwiGLU activation: x * sigmoid(x) * gate
    // FFN expansion ratio: 1536 -> 8960 -> 1536    
    // permute_9 -- mm_3 14
    %155 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %156 = tosa.transpose %arg16, %155 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %157 = tosa.reshape %154 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_27 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %158 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%157, %156 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_27 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %159 = tosa.reshape %158 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %160 = tosa.sigmoid %159 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %161 = tosa.mul %159, %160 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %162 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %163 = tosa.transpose %arg17, %162 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %164 = tosa.reshape %154 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_28 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %165 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%164, %163 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_28 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %166 = tosa.reshape %165 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %167 = tosa.mul %161, %166 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %168 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %169 = tosa.transpose %arg18, %168 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %170 = tosa.reshape %167 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_29 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %171 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%170, %169 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_29 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    // view_24 -- add_6 2
    %172 = tosa.reshape %171 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %173 = tosa.add %141, %172 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    
    
    
    %174 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_30 = arith.constant 2 : i32
    %175 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%173 : tensor<1x1x1536xf32>) outs(%174 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_30 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %176 = tosa.reduce_sum %175 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %177 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %178 = tosa.reciprocal %177 : (tensor<1xf32>) -> tensor<1xf32>
    %179 = tosa.reshape %178 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %180 = tosa.mul %179, %176 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %181 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %182 = tosa.add %180, %181 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %183 = tosa.rsqrt %182 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %184 = tosa.mul %173, %183 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %185 = tosa.reshape %arg19 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %186 = tosa.mul %185, %184 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %187 = tosa.reshape %186 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %188 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %189 = tosa.transpose %arg20, %188 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_31 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %190 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%187, %189 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_31 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %191 = tosa.reshape %arg21 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %192 = tosa.add %191, %190 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %193 = tosa.reshape %192 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %194 = tosa.reshape %193 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %195 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %196 = tosa.transpose %194, %195 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %197 = tosa.reshape %186 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %198 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %199 = tosa.transpose %arg22, %198 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_32 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %200 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%197, %199 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_32 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %201 = tosa.reshape %arg23 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %202 = tosa.add %201, %200 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %203 = tosa.reshape %202 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %204 = tosa.reshape %203 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %205 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %206 = tosa.transpose %204, %205 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %207 = tosa.reshape %186 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %208 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %209 = tosa.transpose %arg24, %208 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_33 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %210 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%207, %209 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_33 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %211 = tosa.reshape %arg25 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %212 = tosa.add %211, %210 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %213 = tosa.reshape %212 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %214 = tosa.reshape %213 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %215 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %216 = tosa.transpose %214, %215 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %217 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %218 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %219 = tosa.mul %196, %217 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_34 = tensor.extract_slice %196[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_35 = tensor.extract_slice %196[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %220 = tensor.empty() : tensor<1x12x1x64xf32>
    %221 = linalg.negf ins(%extracted_slice_35 : tensor<1x12x1x64xf32>) outs(%220 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %222 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_36 = tensor.insert_slice %221 into %222[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_37 = tensor.insert_slice %extracted_slice_34 into %inserted_slice_36[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %223 = tosa.mul %inserted_slice_37, %218 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %224 = tosa.add %219, %223 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %225 = tosa.mul %206, %217 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_38 = tensor.extract_slice %206[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_39 = tensor.extract_slice %206[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %226 = tensor.empty() : tensor<1x2x1x64xf32>
    %227 = linalg.negf ins(%extracted_slice_39 : tensor<1x2x1x64xf32>) outs(%226 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %228 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_40 = tensor.insert_slice %227 into %228[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_41 = tensor.insert_slice %extracted_slice_38 into %inserted_slice_40[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %229 = tosa.mul %inserted_slice_41, %218 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %230 = tosa.add %225, %229 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %231 = bufferization.to_memref %arg26 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %232 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %233 = bufferization.to_memref %230 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_42 = arith.constant 0 : index
    %c1_43 = arith.constant 1 : index
    %c1_44 = arith.constant 1 : index
    %c2_45 = arith.constant 2 : index
    %c1_46 = arith.constant 1 : index
    %c128_47 = arith.constant 128 : index
    scf.for %arg399 = %c0_42 to %c1_44 step %c1_43 {
      scf.for %arg400 = %c0_42 to %c2_45 step %c1_43 {
        scf.for %arg401 = %c0_42 to %c1_46 step %c1_43 {
          %3945 = memref.load %232[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_42 to %c128_47 step %c1_43 {
            %3947 = memref.load %233[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %231[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %234 = bufferization.to_tensor %231 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %235 = bufferization.to_memref %arg27 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %236 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %237 = bufferization.to_memref %216 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_48 = arith.constant 0 : index
    %c1_49 = arith.constant 1 : index
    %c1_50 = arith.constant 1 : index
    %c2_51 = arith.constant 2 : index
    %c1_52 = arith.constant 1 : index
    %c128_53 = arith.constant 128 : index
    scf.for %arg399 = %c0_48 to %c1_50 step %c1_49 {
      scf.for %arg400 = %c0_48 to %c2_51 step %c1_49 {
        scf.for %arg401 = %c0_48 to %c1_52 step %c1_49 {
          %3945 = memref.load %236[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_48 to %c128_53 step %c1_49 {
            %3947 = memref.load %237[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %235[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %238 = bufferization.to_tensor %235 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %239 = tosa.reshape %234 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %240 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %241 = tosa.add %239, %240 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %242 = tosa.reshape %241 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %243 = tosa.reshape %238 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %244 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %245 = tosa.add %243, %244 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %246 = tosa.reshape %245 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %247 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_54 = arith.constant 0xFF800000 : f32
    %cst_55 = arith.constant 0.000000e+00 : f32
    %248 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_56 = tensor.splat %cst_55 : tensor<1x1x1x1024xf32>
    %splat_57 = tensor.splat %cst_54 : tensor<1x1x1x1024xf32>
    %249 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%247, %splat_56, %splat_57 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%248 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_58 = arith.constant 0.000000e+00 : f32
    %splat_59 = tensor.splat %cst_58 : tensor<1x1024xf32>
    %250 = tosa.reshape %249 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %251 = tosa.add %splat_59, %250 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %252 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %253 = tosa.transpose %242, %252 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %254 = tosa.reshape %224 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %255 = tosa.reshape %253 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %256 = tosa.matmul %254, %255 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_60 = arith.constant 0.0883883461 : f32
    %splat_61 = tensor.splat %cst_60 : tensor<12x1x1024xf32>
    %257 = tosa.mul %256, %splat_61 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %258 = tosa.reshape %251 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %259 = tosa.add %257, %258 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %260 = tosa.reduce_max %259 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %261 = tosa.sub %259, %260 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %262 = math.exp %261 : tensor<12x1x1024xf32>
    %263 = tosa.reduce_sum %262 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %264 = tosa.log %263 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %265 = tosa.add %260, %264 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %266 = tosa.sub %259, %265 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %267 = math.exp %266 : tensor<12x1x1024xf32>
    %268 = tosa.reshape %265 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %269 = tosa.reshape %246 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %270 = tosa.matmul %267, %269 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %271 = tosa.reshape %270 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %272 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %273 = tosa.transpose %271, %272 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %274 = tosa.reshape %273 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %275 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %276 = tosa.transpose %arg28, %275 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %277 = tosa.reshape %274 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_62 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %278 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%277, %276 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_62 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %279 = tosa.reshape %278 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %280 = tosa.add %173, %279 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %281 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_63 = arith.constant 2 : i32
    %282 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%280 : tensor<1x1x1536xf32>) outs(%281 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_63 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %283 = tosa.reduce_sum %282 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %284 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %285 = tosa.reciprocal %284 : (tensor<1xf32>) -> tensor<1xf32>
    %286 = tosa.reshape %285 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %287 = tosa.mul %286, %283 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %288 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %289 = tosa.add %287, %288 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %290 = tosa.rsqrt %289 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %291 = tosa.mul %280, %290 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %292 = tosa.reshape %arg29 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %293 = tosa.mul %292, %291 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %294 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %295 = tosa.transpose %arg30, %294 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %296 = tosa.reshape %293 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_64 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %297 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%296, %295 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_64 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %298 = tosa.reshape %297 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %299 = tosa.sigmoid %298 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %300 = tosa.mul %298, %299 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %301 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %302 = tosa.transpose %arg31, %301 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %303 = tosa.reshape %293 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_65 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %304 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%303, %302 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_65 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %305 = tosa.reshape %304 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %306 = tosa.mul %300, %305 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %307 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %308 = tosa.transpose %arg32, %307 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %309 = tosa.reshape %306 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_66 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %310 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%309, %308 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_66 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %311 = tosa.reshape %310 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %312 = tosa.add %280, %311 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %313 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_67 = arith.constant 2 : i32
    %314 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%312 : tensor<1x1x1536xf32>) outs(%313 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_67 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %315 = tosa.reduce_sum %314 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %316 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %317 = tosa.reciprocal %316 : (tensor<1xf32>) -> tensor<1xf32>
    %318 = tosa.reshape %317 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %319 = tosa.mul %318, %315 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %320 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %321 = tosa.add %319, %320 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %322 = tosa.rsqrt %321 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %323 = tosa.mul %312, %322 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %324 = tosa.reshape %arg33 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %325 = tosa.mul %324, %323 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %326 = tosa.reshape %325 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %327 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %328 = tosa.transpose %arg34, %327 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_68 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %329 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%326, %328 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_68 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %330 = tosa.reshape %arg35 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %331 = tosa.add %330, %329 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %332 = tosa.reshape %331 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %333 = tosa.reshape %332 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %334 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %335 = tosa.transpose %333, %334 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %336 = tosa.reshape %325 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %337 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %338 = tosa.transpose %arg36, %337 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_69 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %339 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%336, %338 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_69 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %340 = tosa.reshape %arg37 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %341 = tosa.add %340, %339 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %342 = tosa.reshape %341 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %343 = tosa.reshape %342 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %344 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %345 = tosa.transpose %343, %344 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %346 = tosa.reshape %325 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %347 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %348 = tosa.transpose %arg38, %347 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_70 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %349 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%346, %348 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_70 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %350 = tosa.reshape %arg39 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %351 = tosa.add %350, %349 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %352 = tosa.reshape %351 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %353 = tosa.reshape %352 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %354 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %355 = tosa.transpose %353, %354 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %356 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %357 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %358 = tosa.mul %335, %356 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_71 = tensor.extract_slice %335[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_72 = tensor.extract_slice %335[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %359 = tensor.empty() : tensor<1x12x1x64xf32>
    %360 = linalg.negf ins(%extracted_slice_72 : tensor<1x12x1x64xf32>) outs(%359 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %361 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_73 = tensor.insert_slice %360 into %361[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_74 = tensor.insert_slice %extracted_slice_71 into %inserted_slice_73[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %362 = tosa.mul %inserted_slice_74, %357 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %363 = tosa.add %358, %362 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %364 = tosa.mul %345, %356 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_75 = tensor.extract_slice %345[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_76 = tensor.extract_slice %345[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %365 = tensor.empty() : tensor<1x2x1x64xf32>
    %366 = linalg.negf ins(%extracted_slice_76 : tensor<1x2x1x64xf32>) outs(%365 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %367 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_77 = tensor.insert_slice %366 into %367[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_78 = tensor.insert_slice %extracted_slice_75 into %inserted_slice_77[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %368 = tosa.mul %inserted_slice_78, %357 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %369 = tosa.add %364, %368 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %370 = bufferization.to_memref %arg40 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %371 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %372 = bufferization.to_memref %369 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_79 = arith.constant 0 : index
    %c1_80 = arith.constant 1 : index
    %c1_81 = arith.constant 1 : index
    %c2_82 = arith.constant 2 : index
    %c1_83 = arith.constant 1 : index
    %c128_84 = arith.constant 128 : index
    scf.for %arg399 = %c0_79 to %c1_81 step %c1_80 {
      scf.for %arg400 = %c0_79 to %c2_82 step %c1_80 {
        scf.for %arg401 = %c0_79 to %c1_83 step %c1_80 {
          %3945 = memref.load %371[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_79 to %c128_84 step %c1_80 {
            %3947 = memref.load %372[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %370[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %373 = bufferization.to_tensor %370 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %374 = bufferization.to_memref %arg41 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %375 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %376 = bufferization.to_memref %355 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_85 = arith.constant 0 : index
    %c1_86 = arith.constant 1 : index
    %c1_87 = arith.constant 1 : index
    %c2_88 = arith.constant 2 : index
    %c1_89 = arith.constant 1 : index
    %c128_90 = arith.constant 128 : index
    scf.for %arg399 = %c0_85 to %c1_87 step %c1_86 {
      scf.for %arg400 = %c0_85 to %c2_88 step %c1_86 {
        scf.for %arg401 = %c0_85 to %c1_89 step %c1_86 {
          %3945 = memref.load %375[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_85 to %c128_90 step %c1_86 {
            %3947 = memref.load %376[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %374[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %377 = bufferization.to_tensor %374 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %378 = tosa.reshape %373 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %379 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %380 = tosa.add %378, %379 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %381 = tosa.reshape %380 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %382 = tosa.reshape %377 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %383 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %384 = tosa.add %382, %383 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %385 = tosa.reshape %384 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %386 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_91 = arith.constant 0xFF800000 : f32
    %cst_92 = arith.constant 0.000000e+00 : f32
    %387 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_93 = tensor.splat %cst_92 : tensor<1x1x1x1024xf32>
    %splat_94 = tensor.splat %cst_91 : tensor<1x1x1x1024xf32>
    %388 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%386, %splat_93, %splat_94 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%387 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_95 = arith.constant 0.000000e+00 : f32
    %splat_96 = tensor.splat %cst_95 : tensor<1x1024xf32>
    %389 = tosa.reshape %388 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %390 = tosa.add %splat_96, %389 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %391 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %392 = tosa.transpose %381, %391 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %393 = tosa.reshape %363 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %394 = tosa.reshape %392 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %395 = tosa.matmul %393, %394 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_97 = arith.constant 0.0883883461 : f32
    %splat_98 = tensor.splat %cst_97 : tensor<12x1x1024xf32>
    %396 = tosa.mul %395, %splat_98 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %397 = tosa.reshape %390 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %398 = tosa.add %396, %397 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %399 = tosa.reduce_max %398 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %400 = tosa.sub %398, %399 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %401 = math.exp %400 : tensor<12x1x1024xf32>
    %402 = tosa.reduce_sum %401 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %403 = tosa.log %402 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %404 = tosa.add %399, %403 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %405 = tosa.sub %398, %404 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %406 = math.exp %405 : tensor<12x1x1024xf32>
    %407 = tosa.reshape %404 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %408 = tosa.reshape %385 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %409 = tosa.matmul %406, %408 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %410 = tosa.reshape %409 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %411 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %412 = tosa.transpose %410, %411 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %413 = tosa.reshape %412 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %414 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %415 = tosa.transpose %arg42, %414 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %416 = tosa.reshape %413 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_99 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %417 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%416, %415 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_99 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %418 = tosa.reshape %417 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %419 = tosa.add %312, %418 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %420 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_100 = arith.constant 2 : i32
    %421 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%419 : tensor<1x1x1536xf32>) outs(%420 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_100 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %422 = tosa.reduce_sum %421 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %423 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %424 = tosa.reciprocal %423 : (tensor<1xf32>) -> tensor<1xf32>
    %425 = tosa.reshape %424 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %426 = tosa.mul %425, %422 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %427 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %428 = tosa.add %426, %427 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %429 = tosa.rsqrt %428 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %430 = tosa.mul %419, %429 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %431 = tosa.reshape %arg43 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %432 = tosa.mul %431, %430 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %433 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %434 = tosa.transpose %arg44, %433 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %435 = tosa.reshape %432 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_101 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %436 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%435, %434 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_101 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %437 = tosa.reshape %436 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %438 = tosa.sigmoid %437 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %439 = tosa.mul %437, %438 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %440 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %441 = tosa.transpose %arg45, %440 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %442 = tosa.reshape %432 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_102 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %443 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%442, %441 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_102 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %444 = tosa.reshape %443 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %445 = tosa.mul %439, %444 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %446 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %447 = tosa.transpose %arg46, %446 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %448 = tosa.reshape %445 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_103 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %449 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%448, %447 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_103 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %450 = tosa.reshape %449 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %451 = tosa.add %419, %450 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %452 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_104 = arith.constant 2 : i32
    %453 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%451 : tensor<1x1x1536xf32>) outs(%452 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_104 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %454 = tosa.reduce_sum %453 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %455 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %456 = tosa.reciprocal %455 : (tensor<1xf32>) -> tensor<1xf32>
    %457 = tosa.reshape %456 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %458 = tosa.mul %457, %454 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %459 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %460 = tosa.add %458, %459 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %461 = tosa.rsqrt %460 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %462 = tosa.mul %451, %461 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %463 = tosa.reshape %arg47 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %464 = tosa.mul %463, %462 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %465 = tosa.reshape %464 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %466 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %467 = tosa.transpose %arg48, %466 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_105 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %468 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%465, %467 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_105 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %469 = tosa.reshape %arg49 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %470 = tosa.add %469, %468 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %471 = tosa.reshape %470 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %472 = tosa.reshape %471 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %473 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %474 = tosa.transpose %472, %473 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %475 = tosa.reshape %464 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %476 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %477 = tosa.transpose %arg50, %476 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_106 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %478 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%475, %477 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_106 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %479 = tosa.reshape %arg51 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %480 = tosa.add %479, %478 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %481 = tosa.reshape %480 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %482 = tosa.reshape %481 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %483 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %484 = tosa.transpose %482, %483 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %485 = tosa.reshape %464 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %486 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %487 = tosa.transpose %arg52, %486 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_107 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %488 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%485, %487 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_107 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %489 = tosa.reshape %arg53 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %490 = tosa.add %489, %488 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %491 = tosa.reshape %490 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %492 = tosa.reshape %491 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %493 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %494 = tosa.transpose %492, %493 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %495 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %496 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %497 = tosa.mul %474, %495 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_108 = tensor.extract_slice %474[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_109 = tensor.extract_slice %474[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %498 = tensor.empty() : tensor<1x12x1x64xf32>
    %499 = linalg.negf ins(%extracted_slice_109 : tensor<1x12x1x64xf32>) outs(%498 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %500 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_110 = tensor.insert_slice %499 into %500[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_111 = tensor.insert_slice %extracted_slice_108 into %inserted_slice_110[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %501 = tosa.mul %inserted_slice_111, %496 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %502 = tosa.add %497, %501 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %503 = tosa.mul %484, %495 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_112 = tensor.extract_slice %484[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_113 = tensor.extract_slice %484[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %504 = tensor.empty() : tensor<1x2x1x64xf32>
    %505 = linalg.negf ins(%extracted_slice_113 : tensor<1x2x1x64xf32>) outs(%504 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %506 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_114 = tensor.insert_slice %505 into %506[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_115 = tensor.insert_slice %extracted_slice_112 into %inserted_slice_114[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %507 = tosa.mul %inserted_slice_115, %496 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %508 = tosa.add %503, %507 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %509 = bufferization.to_memref %arg54 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %510 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %511 = bufferization.to_memref %508 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_116 = arith.constant 0 : index
    %c1_117 = arith.constant 1 : index
    %c1_118 = arith.constant 1 : index
    %c2_119 = arith.constant 2 : index
    %c1_120 = arith.constant 1 : index
    %c128_121 = arith.constant 128 : index
    scf.for %arg399 = %c0_116 to %c1_118 step %c1_117 {
      scf.for %arg400 = %c0_116 to %c2_119 step %c1_117 {
        scf.for %arg401 = %c0_116 to %c1_120 step %c1_117 {
          %3945 = memref.load %510[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_116 to %c128_121 step %c1_117 {
            %3947 = memref.load %511[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %509[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %512 = bufferization.to_tensor %509 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %513 = bufferization.to_memref %arg55 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %514 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %515 = bufferization.to_memref %494 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_122 = arith.constant 0 : index
    %c1_123 = arith.constant 1 : index
    %c1_124 = arith.constant 1 : index
    %c2_125 = arith.constant 2 : index
    %c1_126 = arith.constant 1 : index
    %c128_127 = arith.constant 128 : index
    scf.for %arg399 = %c0_122 to %c1_124 step %c1_123 {
      scf.for %arg400 = %c0_122 to %c2_125 step %c1_123 {
        scf.for %arg401 = %c0_122 to %c1_126 step %c1_123 {
          %3945 = memref.load %514[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_122 to %c128_127 step %c1_123 {
            %3947 = memref.load %515[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %513[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %516 = bufferization.to_tensor %513 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %517 = tosa.reshape %512 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %518 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %519 = tosa.add %517, %518 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %520 = tosa.reshape %519 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %521 = tosa.reshape %516 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %522 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %523 = tosa.add %521, %522 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %524 = tosa.reshape %523 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %525 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_128 = arith.constant 0xFF800000 : f32
    %cst_129 = arith.constant 0.000000e+00 : f32
    %526 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_130 = tensor.splat %cst_129 : tensor<1x1x1x1024xf32>
    %splat_131 = tensor.splat %cst_128 : tensor<1x1x1x1024xf32>
    %527 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%525, %splat_130, %splat_131 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%526 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_132 = arith.constant 0.000000e+00 : f32
    %splat_133 = tensor.splat %cst_132 : tensor<1x1024xf32>
    %528 = tosa.reshape %527 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %529 = tosa.add %splat_133, %528 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %530 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %531 = tosa.transpose %520, %530 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %532 = tosa.reshape %502 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %533 = tosa.reshape %531 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %534 = tosa.matmul %532, %533 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_134 = arith.constant 0.0883883461 : f32
    %splat_135 = tensor.splat %cst_134 : tensor<12x1x1024xf32>
    %535 = tosa.mul %534, %splat_135 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %536 = tosa.reshape %529 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %537 = tosa.add %535, %536 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %538 = tosa.reduce_max %537 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %539 = tosa.sub %537, %538 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %540 = math.exp %539 : tensor<12x1x1024xf32>
    %541 = tosa.reduce_sum %540 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %542 = tosa.log %541 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %543 = tosa.add %538, %542 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %544 = tosa.sub %537, %543 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %545 = math.exp %544 : tensor<12x1x1024xf32>
    %546 = tosa.reshape %543 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %547 = tosa.reshape %524 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %548 = tosa.matmul %545, %547 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %549 = tosa.reshape %548 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %550 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %551 = tosa.transpose %549, %550 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %552 = tosa.reshape %551 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %553 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %554 = tosa.transpose %arg56, %553 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %555 = tosa.reshape %552 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_136 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %556 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%555, %554 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_136 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %557 = tosa.reshape %556 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %558 = tosa.add %451, %557 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %559 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_137 = arith.constant 2 : i32
    %560 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%558 : tensor<1x1x1536xf32>) outs(%559 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_137 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %561 = tosa.reduce_sum %560 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %562 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %563 = tosa.reciprocal %562 : (tensor<1xf32>) -> tensor<1xf32>
    %564 = tosa.reshape %563 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %565 = tosa.mul %564, %561 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %566 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %567 = tosa.add %565, %566 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %568 = tosa.rsqrt %567 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %569 = tosa.mul %558, %568 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %570 = tosa.reshape %arg57 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %571 = tosa.mul %570, %569 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %572 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %573 = tosa.transpose %arg58, %572 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %574 = tosa.reshape %571 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_138 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %575 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%574, %573 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_138 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %576 = tosa.reshape %575 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %577 = tosa.sigmoid %576 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %578 = tosa.mul %576, %577 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %579 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %580 = tosa.transpose %arg59, %579 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %581 = tosa.reshape %571 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_139 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %582 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%581, %580 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_139 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %583 = tosa.reshape %582 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %584 = tosa.mul %578, %583 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %585 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %586 = tosa.transpose %arg60, %585 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %587 = tosa.reshape %584 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_140 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %588 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%587, %586 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_140 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %589 = tosa.reshape %588 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %590 = tosa.add %558, %589 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %591 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_141 = arith.constant 2 : i32
    %592 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%590 : tensor<1x1x1536xf32>) outs(%591 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_141 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %593 = tosa.reduce_sum %592 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %594 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %595 = tosa.reciprocal %594 : (tensor<1xf32>) -> tensor<1xf32>
    %596 = tosa.reshape %595 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %597 = tosa.mul %596, %593 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %598 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %599 = tosa.add %597, %598 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %600 = tosa.rsqrt %599 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %601 = tosa.mul %590, %600 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %602 = tosa.reshape %arg61 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %603 = tosa.mul %602, %601 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %604 = tosa.reshape %603 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %605 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %606 = tosa.transpose %arg62, %605 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_142 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %607 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%604, %606 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_142 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %608 = tosa.reshape %arg63 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %609 = tosa.add %608, %607 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %610 = tosa.reshape %609 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %611 = tosa.reshape %610 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %612 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %613 = tosa.transpose %611, %612 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %614 = tosa.reshape %603 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %615 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %616 = tosa.transpose %arg64, %615 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_143 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %617 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%614, %616 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_143 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %618 = tosa.reshape %arg65 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %619 = tosa.add %618, %617 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %620 = tosa.reshape %619 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %621 = tosa.reshape %620 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %622 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %623 = tosa.transpose %621, %622 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %624 = tosa.reshape %603 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %625 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %626 = tosa.transpose %arg66, %625 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_144 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %627 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%624, %626 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_144 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %628 = tosa.reshape %arg67 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %629 = tosa.add %628, %627 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %630 = tosa.reshape %629 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %631 = tosa.reshape %630 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %632 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %633 = tosa.transpose %631, %632 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %634 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %635 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %636 = tosa.mul %613, %634 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_145 = tensor.extract_slice %613[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_146 = tensor.extract_slice %613[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %637 = tensor.empty() : tensor<1x12x1x64xf32>
    %638 = linalg.negf ins(%extracted_slice_146 : tensor<1x12x1x64xf32>) outs(%637 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %639 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_147 = tensor.insert_slice %638 into %639[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_148 = tensor.insert_slice %extracted_slice_145 into %inserted_slice_147[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %640 = tosa.mul %inserted_slice_148, %635 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %641 = tosa.add %636, %640 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %642 = tosa.mul %623, %634 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_149 = tensor.extract_slice %623[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_150 = tensor.extract_slice %623[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %643 = tensor.empty() : tensor<1x2x1x64xf32>
    %644 = linalg.negf ins(%extracted_slice_150 : tensor<1x2x1x64xf32>) outs(%643 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %645 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_151 = tensor.insert_slice %644 into %645[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_152 = tensor.insert_slice %extracted_slice_149 into %inserted_slice_151[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %646 = tosa.mul %inserted_slice_152, %635 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %647 = tosa.add %642, %646 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %648 = bufferization.to_memref %arg68 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %649 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %650 = bufferization.to_memref %647 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_153 = arith.constant 0 : index
    %c1_154 = arith.constant 1 : index
    %c1_155 = arith.constant 1 : index
    %c2_156 = arith.constant 2 : index
    %c1_157 = arith.constant 1 : index
    %c128_158 = arith.constant 128 : index
    scf.for %arg399 = %c0_153 to %c1_155 step %c1_154 {
      scf.for %arg400 = %c0_153 to %c2_156 step %c1_154 {
        scf.for %arg401 = %c0_153 to %c1_157 step %c1_154 {
          %3945 = memref.load %649[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_153 to %c128_158 step %c1_154 {
            %3947 = memref.load %650[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %648[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %651 = bufferization.to_tensor %648 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %652 = bufferization.to_memref %arg69 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %653 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %654 = bufferization.to_memref %633 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_159 = arith.constant 0 : index
    %c1_160 = arith.constant 1 : index
    %c1_161 = arith.constant 1 : index
    %c2_162 = arith.constant 2 : index
    %c1_163 = arith.constant 1 : index
    %c128_164 = arith.constant 128 : index
    scf.for %arg399 = %c0_159 to %c1_161 step %c1_160 {
      scf.for %arg400 = %c0_159 to %c2_162 step %c1_160 {
        scf.for %arg401 = %c0_159 to %c1_163 step %c1_160 {
          %3945 = memref.load %653[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_159 to %c128_164 step %c1_160 {
            %3947 = memref.load %654[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %652[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %655 = bufferization.to_tensor %652 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %656 = tosa.reshape %651 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %657 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %658 = tosa.add %656, %657 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %659 = tosa.reshape %658 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %660 = tosa.reshape %655 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %661 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %662 = tosa.add %660, %661 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %663 = tosa.reshape %662 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %664 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_165 = arith.constant 0xFF800000 : f32
    %cst_166 = arith.constant 0.000000e+00 : f32
    %665 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_167 = tensor.splat %cst_166 : tensor<1x1x1x1024xf32>
    %splat_168 = tensor.splat %cst_165 : tensor<1x1x1x1024xf32>
    %666 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%664, %splat_167, %splat_168 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%665 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_169 = arith.constant 0.000000e+00 : f32
    %splat_170 = tensor.splat %cst_169 : tensor<1x1024xf32>
    %667 = tosa.reshape %666 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %668 = tosa.add %splat_170, %667 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %669 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %670 = tosa.transpose %659, %669 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %671 = tosa.reshape %641 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %672 = tosa.reshape %670 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %673 = tosa.matmul %671, %672 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_171 = arith.constant 0.0883883461 : f32
    %splat_172 = tensor.splat %cst_171 : tensor<12x1x1024xf32>
    %674 = tosa.mul %673, %splat_172 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %675 = tosa.reshape %668 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %676 = tosa.add %674, %675 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %677 = tosa.reduce_max %676 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %678 = tosa.sub %676, %677 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %679 = math.exp %678 : tensor<12x1x1024xf32>
    %680 = tosa.reduce_sum %679 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %681 = tosa.log %680 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %682 = tosa.add %677, %681 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %683 = tosa.sub %676, %682 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %684 = math.exp %683 : tensor<12x1x1024xf32>
    %685 = tosa.reshape %682 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %686 = tosa.reshape %663 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %687 = tosa.matmul %684, %686 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %688 = tosa.reshape %687 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %689 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %690 = tosa.transpose %688, %689 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %691 = tosa.reshape %690 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %692 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %693 = tosa.transpose %arg70, %692 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %694 = tosa.reshape %691 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_173 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %695 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%694, %693 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_173 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %696 = tosa.reshape %695 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %697 = tosa.add %590, %696 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %698 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_174 = arith.constant 2 : i32
    %699 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%697 : tensor<1x1x1536xf32>) outs(%698 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_174 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %700 = tosa.reduce_sum %699 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %701 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %702 = tosa.reciprocal %701 : (tensor<1xf32>) -> tensor<1xf32>
    %703 = tosa.reshape %702 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %704 = tosa.mul %703, %700 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %705 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %706 = tosa.add %704, %705 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %707 = tosa.rsqrt %706 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %708 = tosa.mul %697, %707 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %709 = tosa.reshape %arg71 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %710 = tosa.mul %709, %708 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %711 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %712 = tosa.transpose %arg72, %711 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %713 = tosa.reshape %710 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_175 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %714 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%713, %712 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_175 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %715 = tosa.reshape %714 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %716 = tosa.sigmoid %715 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %717 = tosa.mul %715, %716 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %718 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %719 = tosa.transpose %arg73, %718 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %720 = tosa.reshape %710 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_176 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %721 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%720, %719 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_176 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %722 = tosa.reshape %721 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %723 = tosa.mul %717, %722 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %724 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %725 = tosa.transpose %arg74, %724 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %726 = tosa.reshape %723 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_177 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %727 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%726, %725 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_177 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %728 = tosa.reshape %727 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %729 = tosa.add %697, %728 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %730 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_178 = arith.constant 2 : i32
    %731 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%729 : tensor<1x1x1536xf32>) outs(%730 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_178 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %732 = tosa.reduce_sum %731 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %733 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %734 = tosa.reciprocal %733 : (tensor<1xf32>) -> tensor<1xf32>
    %735 = tosa.reshape %734 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %736 = tosa.mul %735, %732 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %737 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %738 = tosa.add %736, %737 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %739 = tosa.rsqrt %738 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %740 = tosa.mul %729, %739 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %741 = tosa.reshape %arg75 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %742 = tosa.mul %741, %740 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %743 = tosa.reshape %742 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %744 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %745 = tosa.transpose %arg76, %744 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_179 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %746 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%743, %745 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_179 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %747 = tosa.reshape %arg77 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %748 = tosa.add %747, %746 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %749 = tosa.reshape %748 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %750 = tosa.reshape %749 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %751 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %752 = tosa.transpose %750, %751 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %753 = tosa.reshape %742 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %754 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %755 = tosa.transpose %arg78, %754 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_180 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %756 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%753, %755 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_180 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %757 = tosa.reshape %arg79 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %758 = tosa.add %757, %756 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %759 = tosa.reshape %758 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %760 = tosa.reshape %759 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %761 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %762 = tosa.transpose %760, %761 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %763 = tosa.reshape %742 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %764 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %765 = tosa.transpose %arg80, %764 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_181 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %766 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%763, %765 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_181 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %767 = tosa.reshape %arg81 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %768 = tosa.add %767, %766 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %769 = tosa.reshape %768 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %770 = tosa.reshape %769 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %771 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %772 = tosa.transpose %770, %771 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %773 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %774 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %775 = tosa.mul %752, %773 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_182 = tensor.extract_slice %752[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_183 = tensor.extract_slice %752[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %776 = tensor.empty() : tensor<1x12x1x64xf32>
    %777 = linalg.negf ins(%extracted_slice_183 : tensor<1x12x1x64xf32>) outs(%776 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %778 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_184 = tensor.insert_slice %777 into %778[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_185 = tensor.insert_slice %extracted_slice_182 into %inserted_slice_184[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %779 = tosa.mul %inserted_slice_185, %774 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %780 = tosa.add %775, %779 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %781 = tosa.mul %762, %773 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_186 = tensor.extract_slice %762[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_187 = tensor.extract_slice %762[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %782 = tensor.empty() : tensor<1x2x1x64xf32>
    %783 = linalg.negf ins(%extracted_slice_187 : tensor<1x2x1x64xf32>) outs(%782 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %784 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_188 = tensor.insert_slice %783 into %784[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_189 = tensor.insert_slice %extracted_slice_186 into %inserted_slice_188[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %785 = tosa.mul %inserted_slice_189, %774 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %786 = tosa.add %781, %785 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %787 = bufferization.to_memref %arg82 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %788 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %789 = bufferization.to_memref %786 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_190 = arith.constant 0 : index
    %c1_191 = arith.constant 1 : index
    %c1_192 = arith.constant 1 : index
    %c2_193 = arith.constant 2 : index
    %c1_194 = arith.constant 1 : index
    %c128_195 = arith.constant 128 : index
    scf.for %arg399 = %c0_190 to %c1_192 step %c1_191 {
      scf.for %arg400 = %c0_190 to %c2_193 step %c1_191 {
        scf.for %arg401 = %c0_190 to %c1_194 step %c1_191 {
          %3945 = memref.load %788[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_190 to %c128_195 step %c1_191 {
            %3947 = memref.load %789[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %787[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %790 = bufferization.to_tensor %787 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %791 = bufferization.to_memref %arg83 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %792 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %793 = bufferization.to_memref %772 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_196 = arith.constant 0 : index
    %c1_197 = arith.constant 1 : index
    %c1_198 = arith.constant 1 : index
    %c2_199 = arith.constant 2 : index
    %c1_200 = arith.constant 1 : index
    %c128_201 = arith.constant 128 : index
    scf.for %arg399 = %c0_196 to %c1_198 step %c1_197 {
      scf.for %arg400 = %c0_196 to %c2_199 step %c1_197 {
        scf.for %arg401 = %c0_196 to %c1_200 step %c1_197 {
          %3945 = memref.load %792[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_196 to %c128_201 step %c1_197 {
            %3947 = memref.load %793[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %791[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %794 = bufferization.to_tensor %791 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %795 = tosa.reshape %790 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %796 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %797 = tosa.add %795, %796 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %798 = tosa.reshape %797 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %799 = tosa.reshape %794 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %800 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %801 = tosa.add %799, %800 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %802 = tosa.reshape %801 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %803 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_202 = arith.constant 0xFF800000 : f32
    %cst_203 = arith.constant 0.000000e+00 : f32
    %804 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_204 = tensor.splat %cst_203 : tensor<1x1x1x1024xf32>
    %splat_205 = tensor.splat %cst_202 : tensor<1x1x1x1024xf32>
    %805 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%803, %splat_204, %splat_205 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%804 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_206 = arith.constant 0.000000e+00 : f32
    %splat_207 = tensor.splat %cst_206 : tensor<1x1024xf32>
    %806 = tosa.reshape %805 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %807 = tosa.add %splat_207, %806 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %808 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %809 = tosa.transpose %798, %808 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %810 = tosa.reshape %780 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %811 = tosa.reshape %809 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %812 = tosa.matmul %810, %811 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_208 = arith.constant 0.0883883461 : f32
    %splat_209 = tensor.splat %cst_208 : tensor<12x1x1024xf32>
    %813 = tosa.mul %812, %splat_209 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %814 = tosa.reshape %807 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %815 = tosa.add %813, %814 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %816 = tosa.reduce_max %815 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %817 = tosa.sub %815, %816 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %818 = math.exp %817 : tensor<12x1x1024xf32>
    %819 = tosa.reduce_sum %818 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %820 = tosa.log %819 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %821 = tosa.add %816, %820 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %822 = tosa.sub %815, %821 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %823 = math.exp %822 : tensor<12x1x1024xf32>
    %824 = tosa.reshape %821 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %825 = tosa.reshape %802 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %826 = tosa.matmul %823, %825 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %827 = tosa.reshape %826 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %828 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %829 = tosa.transpose %827, %828 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %830 = tosa.reshape %829 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %831 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %832 = tosa.transpose %arg84, %831 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %833 = tosa.reshape %830 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_210 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %834 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%833, %832 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_210 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %835 = tosa.reshape %834 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %836 = tosa.add %729, %835 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %837 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_211 = arith.constant 2 : i32
    %838 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%836 : tensor<1x1x1536xf32>) outs(%837 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_211 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %839 = tosa.reduce_sum %838 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %840 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %841 = tosa.reciprocal %840 : (tensor<1xf32>) -> tensor<1xf32>
    %842 = tosa.reshape %841 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %843 = tosa.mul %842, %839 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %844 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %845 = tosa.add %843, %844 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %846 = tosa.rsqrt %845 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %847 = tosa.mul %836, %846 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %848 = tosa.reshape %arg85 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %849 = tosa.mul %848, %847 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %850 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %851 = tosa.transpose %arg86, %850 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %852 = tosa.reshape %849 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_212 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %853 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%852, %851 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_212 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %854 = tosa.reshape %853 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %855 = tosa.sigmoid %854 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %856 = tosa.mul %854, %855 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %857 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %858 = tosa.transpose %arg87, %857 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %859 = tosa.reshape %849 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_213 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %860 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%859, %858 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_213 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %861 = tosa.reshape %860 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %862 = tosa.mul %856, %861 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %863 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %864 = tosa.transpose %arg88, %863 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %865 = tosa.reshape %862 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_214 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %866 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%865, %864 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_214 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %867 = tosa.reshape %866 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %868 = tosa.add %836, %867 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %869 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_215 = arith.constant 2 : i32
    %870 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%868 : tensor<1x1x1536xf32>) outs(%869 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_215 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %871 = tosa.reduce_sum %870 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %872 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %873 = tosa.reciprocal %872 : (tensor<1xf32>) -> tensor<1xf32>
    %874 = tosa.reshape %873 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %875 = tosa.mul %874, %871 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %876 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %877 = tosa.add %875, %876 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %878 = tosa.rsqrt %877 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %879 = tosa.mul %868, %878 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %880 = tosa.reshape %arg89 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %881 = tosa.mul %880, %879 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %882 = tosa.reshape %881 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %883 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %884 = tosa.transpose %arg90, %883 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_216 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %885 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%882, %884 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_216 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %886 = tosa.reshape %arg91 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %887 = tosa.add %886, %885 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %888 = tosa.reshape %887 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %889 = tosa.reshape %888 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %890 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %891 = tosa.transpose %889, %890 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %892 = tosa.reshape %881 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %893 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %894 = tosa.transpose %arg92, %893 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_217 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %895 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%892, %894 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_217 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %896 = tosa.reshape %arg93 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %897 = tosa.add %896, %895 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %898 = tosa.reshape %897 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %899 = tosa.reshape %898 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %900 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %901 = tosa.transpose %899, %900 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %902 = tosa.reshape %881 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %903 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %904 = tosa.transpose %arg94, %903 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_218 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %905 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%902, %904 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_218 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %906 = tosa.reshape %arg95 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %907 = tosa.add %906, %905 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %908 = tosa.reshape %907 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %909 = tosa.reshape %908 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %910 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %911 = tosa.transpose %909, %910 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %912 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %913 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %914 = tosa.mul %891, %912 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_219 = tensor.extract_slice %891[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_220 = tensor.extract_slice %891[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %915 = tensor.empty() : tensor<1x12x1x64xf32>
    %916 = linalg.negf ins(%extracted_slice_220 : tensor<1x12x1x64xf32>) outs(%915 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %917 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_221 = tensor.insert_slice %916 into %917[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_222 = tensor.insert_slice %extracted_slice_219 into %inserted_slice_221[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %918 = tosa.mul %inserted_slice_222, %913 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %919 = tosa.add %914, %918 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %920 = tosa.mul %901, %912 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_223 = tensor.extract_slice %901[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_224 = tensor.extract_slice %901[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %921 = tensor.empty() : tensor<1x2x1x64xf32>
    %922 = linalg.negf ins(%extracted_slice_224 : tensor<1x2x1x64xf32>) outs(%921 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %923 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_225 = tensor.insert_slice %922 into %923[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_226 = tensor.insert_slice %extracted_slice_223 into %inserted_slice_225[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %924 = tosa.mul %inserted_slice_226, %913 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %925 = tosa.add %920, %924 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %926 = bufferization.to_memref %arg96 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %927 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %928 = bufferization.to_memref %925 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_227 = arith.constant 0 : index
    %c1_228 = arith.constant 1 : index
    %c1_229 = arith.constant 1 : index
    %c2_230 = arith.constant 2 : index
    %c1_231 = arith.constant 1 : index
    %c128_232 = arith.constant 128 : index
    scf.for %arg399 = %c0_227 to %c1_229 step %c1_228 {
      scf.for %arg400 = %c0_227 to %c2_230 step %c1_228 {
        scf.for %arg401 = %c0_227 to %c1_231 step %c1_228 {
          %3945 = memref.load %927[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_227 to %c128_232 step %c1_228 {
            %3947 = memref.load %928[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %926[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %929 = bufferization.to_tensor %926 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %930 = bufferization.to_memref %arg97 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %931 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %932 = bufferization.to_memref %911 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_233 = arith.constant 0 : index
    %c1_234 = arith.constant 1 : index
    %c1_235 = arith.constant 1 : index
    %c2_236 = arith.constant 2 : index
    %c1_237 = arith.constant 1 : index
    %c128_238 = arith.constant 128 : index
    scf.for %arg399 = %c0_233 to %c1_235 step %c1_234 {
      scf.for %arg400 = %c0_233 to %c2_236 step %c1_234 {
        scf.for %arg401 = %c0_233 to %c1_237 step %c1_234 {
          %3945 = memref.load %931[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_233 to %c128_238 step %c1_234 {
            %3947 = memref.load %932[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %930[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %933 = bufferization.to_tensor %930 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %934 = tosa.reshape %929 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %935 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %936 = tosa.add %934, %935 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %937 = tosa.reshape %936 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %938 = tosa.reshape %933 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %939 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %940 = tosa.add %938, %939 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %941 = tosa.reshape %940 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %942 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_239 = arith.constant 0xFF800000 : f32
    %cst_240 = arith.constant 0.000000e+00 : f32
    %943 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_241 = tensor.splat %cst_240 : tensor<1x1x1x1024xf32>
    %splat_242 = tensor.splat %cst_239 : tensor<1x1x1x1024xf32>
    %944 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%942, %splat_241, %splat_242 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%943 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_243 = arith.constant 0.000000e+00 : f32
    %splat_244 = tensor.splat %cst_243 : tensor<1x1024xf32>
    %945 = tosa.reshape %944 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %946 = tosa.add %splat_244, %945 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %947 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %948 = tosa.transpose %937, %947 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %949 = tosa.reshape %919 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %950 = tosa.reshape %948 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %951 = tosa.matmul %949, %950 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_245 = arith.constant 0.0883883461 : f32
    %splat_246 = tensor.splat %cst_245 : tensor<12x1x1024xf32>
    %952 = tosa.mul %951, %splat_246 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %953 = tosa.reshape %946 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %954 = tosa.add %952, %953 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %955 = tosa.reduce_max %954 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %956 = tosa.sub %954, %955 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %957 = math.exp %956 : tensor<12x1x1024xf32>
    %958 = tosa.reduce_sum %957 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %959 = tosa.log %958 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %960 = tosa.add %955, %959 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %961 = tosa.sub %954, %960 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %962 = math.exp %961 : tensor<12x1x1024xf32>
    %963 = tosa.reshape %960 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %964 = tosa.reshape %941 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %965 = tosa.matmul %962, %964 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %966 = tosa.reshape %965 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %967 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %968 = tosa.transpose %966, %967 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %969 = tosa.reshape %968 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %970 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %971 = tosa.transpose %arg98, %970 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %972 = tosa.reshape %969 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_247 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %973 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%972, %971 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_247 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %974 = tosa.reshape %973 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %975 = tosa.add %868, %974 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %976 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_248 = arith.constant 2 : i32
    %977 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%975 : tensor<1x1x1536xf32>) outs(%976 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_248 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %978 = tosa.reduce_sum %977 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %979 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %980 = tosa.reciprocal %979 : (tensor<1xf32>) -> tensor<1xf32>
    %981 = tosa.reshape %980 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %982 = tosa.mul %981, %978 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %983 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %984 = tosa.add %982, %983 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %985 = tosa.rsqrt %984 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %986 = tosa.mul %975, %985 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %987 = tosa.reshape %arg99 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %988 = tosa.mul %987, %986 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %989 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %990 = tosa.transpose %arg100, %989 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %991 = tosa.reshape %988 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_249 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %992 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%991, %990 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_249 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %993 = tosa.reshape %992 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %994 = tosa.sigmoid %993 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %995 = tosa.mul %993, %994 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %996 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %997 = tosa.transpose %arg101, %996 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %998 = tosa.reshape %988 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_250 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %999 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%998, %997 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_250 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1000 = tosa.reshape %999 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1001 = tosa.mul %995, %1000 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1002 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1003 = tosa.transpose %arg102, %1002 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1004 = tosa.reshape %1001 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_251 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1005 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1004, %1003 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_251 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1006 = tosa.reshape %1005 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1007 = tosa.add %975, %1006 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1008 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_252 = arith.constant 2 : i32
    %1009 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1007 : tensor<1x1x1536xf32>) outs(%1008 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_252 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1010 = tosa.reduce_sum %1009 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1011 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1012 = tosa.reciprocal %1011 : (tensor<1xf32>) -> tensor<1xf32>
    %1013 = tosa.reshape %1012 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1014 = tosa.mul %1013, %1010 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1015 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1016 = tosa.add %1014, %1015 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1017 = tosa.rsqrt %1016 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1018 = tosa.mul %1007, %1017 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1019 = tosa.reshape %arg103 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1020 = tosa.mul %1019, %1018 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1021 = tosa.reshape %1020 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1022 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1023 = tosa.transpose %arg104, %1022 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_253 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1024 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1021, %1023 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_253 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1025 = tosa.reshape %arg105 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1026 = tosa.add %1025, %1024 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1027 = tosa.reshape %1026 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1028 = tosa.reshape %1027 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1029 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1030 = tosa.transpose %1028, %1029 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1031 = tosa.reshape %1020 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1032 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1033 = tosa.transpose %arg106, %1032 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_254 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1034 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1031, %1033 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_254 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1035 = tosa.reshape %arg107 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1036 = tosa.add %1035, %1034 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1037 = tosa.reshape %1036 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1038 = tosa.reshape %1037 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1039 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1040 = tosa.transpose %1038, %1039 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1041 = tosa.reshape %1020 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1042 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1043 = tosa.transpose %arg108, %1042 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_255 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1044 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1041, %1043 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_255 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1045 = tosa.reshape %arg109 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1046 = tosa.add %1045, %1044 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1047 = tosa.reshape %1046 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1048 = tosa.reshape %1047 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1049 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1050 = tosa.transpose %1048, %1049 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1051 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1052 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1053 = tosa.mul %1030, %1051 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_256 = tensor.extract_slice %1030[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_257 = tensor.extract_slice %1030[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1054 = tensor.empty() : tensor<1x12x1x64xf32>
    %1055 = linalg.negf ins(%extracted_slice_257 : tensor<1x12x1x64xf32>) outs(%1054 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1056 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_258 = tensor.insert_slice %1055 into %1056[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_259 = tensor.insert_slice %extracted_slice_256 into %inserted_slice_258[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1057 = tosa.mul %inserted_slice_259, %1052 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1058 = tosa.add %1053, %1057 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1059 = tosa.mul %1040, %1051 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_260 = tensor.extract_slice %1040[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_261 = tensor.extract_slice %1040[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1060 = tensor.empty() : tensor<1x2x1x64xf32>
    %1061 = linalg.negf ins(%extracted_slice_261 : tensor<1x2x1x64xf32>) outs(%1060 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1062 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_262 = tensor.insert_slice %1061 into %1062[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_263 = tensor.insert_slice %extracted_slice_260 into %inserted_slice_262[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1063 = tosa.mul %inserted_slice_263, %1052 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1064 = tosa.add %1059, %1063 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1065 = bufferization.to_memref %arg110 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1066 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1067 = bufferization.to_memref %1064 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_264 = arith.constant 0 : index
    %c1_265 = arith.constant 1 : index
    %c1_266 = arith.constant 1 : index
    %c2_267 = arith.constant 2 : index
    %c1_268 = arith.constant 1 : index
    %c128_269 = arith.constant 128 : index
    scf.for %arg399 = %c0_264 to %c1_266 step %c1_265 {
      scf.for %arg400 = %c0_264 to %c2_267 step %c1_265 {
        scf.for %arg401 = %c0_264 to %c1_268 step %c1_265 {
          %3945 = memref.load %1066[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_264 to %c128_269 step %c1_265 {
            %3947 = memref.load %1067[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1065[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1068 = bufferization.to_tensor %1065 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1069 = bufferization.to_memref %arg111 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1070 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1071 = bufferization.to_memref %1050 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_270 = arith.constant 0 : index
    %c1_271 = arith.constant 1 : index
    %c1_272 = arith.constant 1 : index
    %c2_273 = arith.constant 2 : index
    %c1_274 = arith.constant 1 : index
    %c128_275 = arith.constant 128 : index
    scf.for %arg399 = %c0_270 to %c1_272 step %c1_271 {
      scf.for %arg400 = %c0_270 to %c2_273 step %c1_271 {
        scf.for %arg401 = %c0_270 to %c1_274 step %c1_271 {
          %3945 = memref.load %1070[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_270 to %c128_275 step %c1_271 {
            %3947 = memref.load %1071[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1069[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1072 = bufferization.to_tensor %1069 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1073 = tosa.reshape %1068 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1074 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1075 = tosa.add %1073, %1074 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1076 = tosa.reshape %1075 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1077 = tosa.reshape %1072 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1078 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1079 = tosa.add %1077, %1078 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1080 = tosa.reshape %1079 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1081 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_276 = arith.constant 0xFF800000 : f32
    %cst_277 = arith.constant 0.000000e+00 : f32
    %1082 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_278 = tensor.splat %cst_277 : tensor<1x1x1x1024xf32>
    %splat_279 = tensor.splat %cst_276 : tensor<1x1x1x1024xf32>
    %1083 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1081, %splat_278, %splat_279 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1082 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_280 = arith.constant 0.000000e+00 : f32
    %splat_281 = tensor.splat %cst_280 : tensor<1x1024xf32>
    %1084 = tosa.reshape %1083 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1085 = tosa.add %splat_281, %1084 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1086 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1087 = tosa.transpose %1076, %1086 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1088 = tosa.reshape %1058 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1089 = tosa.reshape %1087 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1090 = tosa.matmul %1088, %1089 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_282 = arith.constant 0.0883883461 : f32
    %splat_283 = tensor.splat %cst_282 : tensor<12x1x1024xf32>
    %1091 = tosa.mul %1090, %splat_283 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1092 = tosa.reshape %1085 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1093 = tosa.add %1091, %1092 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1094 = tosa.reduce_max %1093 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1095 = tosa.sub %1093, %1094 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1096 = math.exp %1095 : tensor<12x1x1024xf32>
    %1097 = tosa.reduce_sum %1096 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1098 = tosa.log %1097 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1099 = tosa.add %1094, %1098 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1100 = tosa.sub %1093, %1099 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1101 = math.exp %1100 : tensor<12x1x1024xf32>
    %1102 = tosa.reshape %1099 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1103 = tosa.reshape %1080 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1104 = tosa.matmul %1101, %1103 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1105 = tosa.reshape %1104 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1106 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1107 = tosa.transpose %1105, %1106 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1108 = tosa.reshape %1107 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1109 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1110 = tosa.transpose %arg112, %1109 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1111 = tosa.reshape %1108 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_284 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1112 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1111, %1110 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_284 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1113 = tosa.reshape %1112 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1114 = tosa.add %1007, %1113 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1115 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_285 = arith.constant 2 : i32
    %1116 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1114 : tensor<1x1x1536xf32>) outs(%1115 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_285 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1117 = tosa.reduce_sum %1116 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1118 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1119 = tosa.reciprocal %1118 : (tensor<1xf32>) -> tensor<1xf32>
    %1120 = tosa.reshape %1119 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1121 = tosa.mul %1120, %1117 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1122 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1123 = tosa.add %1121, %1122 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1124 = tosa.rsqrt %1123 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1125 = tosa.mul %1114, %1124 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1126 = tosa.reshape %arg113 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1127 = tosa.mul %1126, %1125 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1128 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1129 = tosa.transpose %arg114, %1128 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1130 = tosa.reshape %1127 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_286 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1131 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1130, %1129 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_286 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1132 = tosa.reshape %1131 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1133 = tosa.sigmoid %1132 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1134 = tosa.mul %1132, %1133 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1135 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1136 = tosa.transpose %arg115, %1135 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1137 = tosa.reshape %1127 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_287 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1138 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1137, %1136 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_287 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1139 = tosa.reshape %1138 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1140 = tosa.mul %1134, %1139 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1141 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1142 = tosa.transpose %arg116, %1141 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1143 = tosa.reshape %1140 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_288 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1144 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1143, %1142 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_288 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1145 = tosa.reshape %1144 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1146 = tosa.add %1114, %1145 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1147 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_289 = arith.constant 2 : i32
    %1148 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1146 : tensor<1x1x1536xf32>) outs(%1147 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_289 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1149 = tosa.reduce_sum %1148 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1150 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1151 = tosa.reciprocal %1150 : (tensor<1xf32>) -> tensor<1xf32>
    %1152 = tosa.reshape %1151 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1153 = tosa.mul %1152, %1149 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1154 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1155 = tosa.add %1153, %1154 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1156 = tosa.rsqrt %1155 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1157 = tosa.mul %1146, %1156 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1158 = tosa.reshape %arg117 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1159 = tosa.mul %1158, %1157 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1160 = tosa.reshape %1159 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1161 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1162 = tosa.transpose %arg118, %1161 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_290 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1163 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1160, %1162 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_290 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1164 = tosa.reshape %arg119 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1165 = tosa.add %1164, %1163 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1166 = tosa.reshape %1165 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1167 = tosa.reshape %1166 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1168 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1169 = tosa.transpose %1167, %1168 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1170 = tosa.reshape %1159 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1171 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1172 = tosa.transpose %arg120, %1171 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_291 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1173 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1170, %1172 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_291 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1174 = tosa.reshape %arg121 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1175 = tosa.add %1174, %1173 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1176 = tosa.reshape %1175 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1177 = tosa.reshape %1176 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1178 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1179 = tosa.transpose %1177, %1178 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1180 = tosa.reshape %1159 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1181 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1182 = tosa.transpose %arg122, %1181 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_292 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1183 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1180, %1182 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_292 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1184 = tosa.reshape %arg123 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1185 = tosa.add %1184, %1183 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1186 = tosa.reshape %1185 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1187 = tosa.reshape %1186 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1188 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1189 = tosa.transpose %1187, %1188 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1190 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1191 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1192 = tosa.mul %1169, %1190 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_293 = tensor.extract_slice %1169[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_294 = tensor.extract_slice %1169[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1193 = tensor.empty() : tensor<1x12x1x64xf32>
    %1194 = linalg.negf ins(%extracted_slice_294 : tensor<1x12x1x64xf32>) outs(%1193 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1195 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_295 = tensor.insert_slice %1194 into %1195[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_296 = tensor.insert_slice %extracted_slice_293 into %inserted_slice_295[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1196 = tosa.mul %inserted_slice_296, %1191 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1197 = tosa.add %1192, %1196 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1198 = tosa.mul %1179, %1190 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_297 = tensor.extract_slice %1179[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_298 = tensor.extract_slice %1179[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1199 = tensor.empty() : tensor<1x2x1x64xf32>
    %1200 = linalg.negf ins(%extracted_slice_298 : tensor<1x2x1x64xf32>) outs(%1199 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1201 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_299 = tensor.insert_slice %1200 into %1201[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_300 = tensor.insert_slice %extracted_slice_297 into %inserted_slice_299[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1202 = tosa.mul %inserted_slice_300, %1191 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1203 = tosa.add %1198, %1202 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1204 = bufferization.to_memref %arg124 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1205 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1206 = bufferization.to_memref %1203 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_301 = arith.constant 0 : index
    %c1_302 = arith.constant 1 : index
    %c1_303 = arith.constant 1 : index
    %c2_304 = arith.constant 2 : index
    %c1_305 = arith.constant 1 : index
    %c128_306 = arith.constant 128 : index
    scf.for %arg399 = %c0_301 to %c1_303 step %c1_302 {
      scf.for %arg400 = %c0_301 to %c2_304 step %c1_302 {
        scf.for %arg401 = %c0_301 to %c1_305 step %c1_302 {
          %3945 = memref.load %1205[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_301 to %c128_306 step %c1_302 {
            %3947 = memref.load %1206[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1204[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1207 = bufferization.to_tensor %1204 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1208 = bufferization.to_memref %arg125 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1209 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1210 = bufferization.to_memref %1189 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_307 = arith.constant 0 : index
    %c1_308 = arith.constant 1 : index
    %c1_309 = arith.constant 1 : index
    %c2_310 = arith.constant 2 : index
    %c1_311 = arith.constant 1 : index
    %c128_312 = arith.constant 128 : index
    scf.for %arg399 = %c0_307 to %c1_309 step %c1_308 {
      scf.for %arg400 = %c0_307 to %c2_310 step %c1_308 {
        scf.for %arg401 = %c0_307 to %c1_311 step %c1_308 {
          %3945 = memref.load %1209[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_307 to %c128_312 step %c1_308 {
            %3947 = memref.load %1210[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1208[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1211 = bufferization.to_tensor %1208 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1212 = tosa.reshape %1207 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1213 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1214 = tosa.add %1212, %1213 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1215 = tosa.reshape %1214 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1216 = tosa.reshape %1211 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1217 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1218 = tosa.add %1216, %1217 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1219 = tosa.reshape %1218 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1220 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_313 = arith.constant 0xFF800000 : f32
    %cst_314 = arith.constant 0.000000e+00 : f32
    %1221 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_315 = tensor.splat %cst_314 : tensor<1x1x1x1024xf32>
    %splat_316 = tensor.splat %cst_313 : tensor<1x1x1x1024xf32>
    %1222 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1220, %splat_315, %splat_316 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1221 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_317 = arith.constant 0.000000e+00 : f32
    %splat_318 = tensor.splat %cst_317 : tensor<1x1024xf32>
    %1223 = tosa.reshape %1222 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1224 = tosa.add %splat_318, %1223 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1225 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1226 = tosa.transpose %1215, %1225 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1227 = tosa.reshape %1197 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1228 = tosa.reshape %1226 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1229 = tosa.matmul %1227, %1228 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_319 = arith.constant 0.0883883461 : f32
    %splat_320 = tensor.splat %cst_319 : tensor<12x1x1024xf32>
    %1230 = tosa.mul %1229, %splat_320 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1231 = tosa.reshape %1224 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1232 = tosa.add %1230, %1231 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1233 = tosa.reduce_max %1232 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1234 = tosa.sub %1232, %1233 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1235 = math.exp %1234 : tensor<12x1x1024xf32>
    %1236 = tosa.reduce_sum %1235 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1237 = tosa.log %1236 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1238 = tosa.add %1233, %1237 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1239 = tosa.sub %1232, %1238 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1240 = math.exp %1239 : tensor<12x1x1024xf32>
    %1241 = tosa.reshape %1238 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1242 = tosa.reshape %1219 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1243 = tosa.matmul %1240, %1242 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1244 = tosa.reshape %1243 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1245 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1246 = tosa.transpose %1244, %1245 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1247 = tosa.reshape %1246 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1248 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1249 = tosa.transpose %arg126, %1248 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1250 = tosa.reshape %1247 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_321 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1251 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1250, %1249 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_321 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1252 = tosa.reshape %1251 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1253 = tosa.add %1146, %1252 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1254 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_322 = arith.constant 2 : i32
    %1255 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1253 : tensor<1x1x1536xf32>) outs(%1254 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_322 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1256 = tosa.reduce_sum %1255 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1257 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1258 = tosa.reciprocal %1257 : (tensor<1xf32>) -> tensor<1xf32>
    %1259 = tosa.reshape %1258 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1260 = tosa.mul %1259, %1256 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1261 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1262 = tosa.add %1260, %1261 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1263 = tosa.rsqrt %1262 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1264 = tosa.mul %1253, %1263 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1265 = tosa.reshape %arg127 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1266 = tosa.mul %1265, %1264 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1267 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1268 = tosa.transpose %arg128, %1267 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1269 = tosa.reshape %1266 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_323 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1270 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1269, %1268 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_323 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1271 = tosa.reshape %1270 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1272 = tosa.sigmoid %1271 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1273 = tosa.mul %1271, %1272 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1274 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1275 = tosa.transpose %arg129, %1274 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1276 = tosa.reshape %1266 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_324 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1277 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1276, %1275 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_324 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1278 = tosa.reshape %1277 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1279 = tosa.mul %1273, %1278 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1280 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1281 = tosa.transpose %arg130, %1280 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1282 = tosa.reshape %1279 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_325 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1283 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1282, %1281 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_325 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1284 = tosa.reshape %1283 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1285 = tosa.add %1253, %1284 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1286 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_326 = arith.constant 2 : i32
    %1287 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1285 : tensor<1x1x1536xf32>) outs(%1286 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_326 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1288 = tosa.reduce_sum %1287 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1289 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1290 = tosa.reciprocal %1289 : (tensor<1xf32>) -> tensor<1xf32>
    %1291 = tosa.reshape %1290 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1292 = tosa.mul %1291, %1288 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1293 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1294 = tosa.add %1292, %1293 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1295 = tosa.rsqrt %1294 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1296 = tosa.mul %1285, %1295 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1297 = tosa.reshape %arg131 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1298 = tosa.mul %1297, %1296 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1299 = tosa.reshape %1298 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1300 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1301 = tosa.transpose %arg132, %1300 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_327 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1302 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1299, %1301 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_327 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1303 = tosa.reshape %arg133 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1304 = tosa.add %1303, %1302 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1305 = tosa.reshape %1304 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1306 = tosa.reshape %1305 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1307 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1308 = tosa.transpose %1306, %1307 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1309 = tosa.reshape %1298 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1310 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1311 = tosa.transpose %arg134, %1310 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_328 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1312 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1309, %1311 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_328 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1313 = tosa.reshape %arg135 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1314 = tosa.add %1313, %1312 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1315 = tosa.reshape %1314 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1316 = tosa.reshape %1315 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1317 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1318 = tosa.transpose %1316, %1317 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1319 = tosa.reshape %1298 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1320 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1321 = tosa.transpose %arg136, %1320 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_329 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1322 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1319, %1321 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_329 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1323 = tosa.reshape %arg137 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1324 = tosa.add %1323, %1322 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1325 = tosa.reshape %1324 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1326 = tosa.reshape %1325 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1327 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1328 = tosa.transpose %1326, %1327 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1329 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1330 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1331 = tosa.mul %1308, %1329 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_330 = tensor.extract_slice %1308[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_331 = tensor.extract_slice %1308[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1332 = tensor.empty() : tensor<1x12x1x64xf32>
    %1333 = linalg.negf ins(%extracted_slice_331 : tensor<1x12x1x64xf32>) outs(%1332 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1334 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_332 = tensor.insert_slice %1333 into %1334[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_333 = tensor.insert_slice %extracted_slice_330 into %inserted_slice_332[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1335 = tosa.mul %inserted_slice_333, %1330 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1336 = tosa.add %1331, %1335 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1337 = tosa.mul %1318, %1329 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_334 = tensor.extract_slice %1318[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_335 = tensor.extract_slice %1318[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1338 = tensor.empty() : tensor<1x2x1x64xf32>
    %1339 = linalg.negf ins(%extracted_slice_335 : tensor<1x2x1x64xf32>) outs(%1338 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1340 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_336 = tensor.insert_slice %1339 into %1340[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_337 = tensor.insert_slice %extracted_slice_334 into %inserted_slice_336[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1341 = tosa.mul %inserted_slice_337, %1330 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1342 = tosa.add %1337, %1341 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1343 = bufferization.to_memref %arg138 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1344 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1345 = bufferization.to_memref %1342 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_338 = arith.constant 0 : index
    %c1_339 = arith.constant 1 : index
    %c1_340 = arith.constant 1 : index
    %c2_341 = arith.constant 2 : index
    %c1_342 = arith.constant 1 : index
    %c128_343 = arith.constant 128 : index
    scf.for %arg399 = %c0_338 to %c1_340 step %c1_339 {
      scf.for %arg400 = %c0_338 to %c2_341 step %c1_339 {
        scf.for %arg401 = %c0_338 to %c1_342 step %c1_339 {
          %3945 = memref.load %1344[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_338 to %c128_343 step %c1_339 {
            %3947 = memref.load %1345[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1343[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1346 = bufferization.to_tensor %1343 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1347 = bufferization.to_memref %arg139 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1348 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1349 = bufferization.to_memref %1328 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_344 = arith.constant 0 : index
    %c1_345 = arith.constant 1 : index
    %c1_346 = arith.constant 1 : index
    %c2_347 = arith.constant 2 : index
    %c1_348 = arith.constant 1 : index
    %c128_349 = arith.constant 128 : index
    scf.for %arg399 = %c0_344 to %c1_346 step %c1_345 {
      scf.for %arg400 = %c0_344 to %c2_347 step %c1_345 {
        scf.for %arg401 = %c0_344 to %c1_348 step %c1_345 {
          %3945 = memref.load %1348[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_344 to %c128_349 step %c1_345 {
            %3947 = memref.load %1349[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1347[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1350 = bufferization.to_tensor %1347 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1351 = tosa.reshape %1346 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1352 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1353 = tosa.add %1351, %1352 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1354 = tosa.reshape %1353 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1355 = tosa.reshape %1350 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1356 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1357 = tosa.add %1355, %1356 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1358 = tosa.reshape %1357 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1359 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_350 = arith.constant 0xFF800000 : f32
    %cst_351 = arith.constant 0.000000e+00 : f32
    %1360 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_352 = tensor.splat %cst_351 : tensor<1x1x1x1024xf32>
    %splat_353 = tensor.splat %cst_350 : tensor<1x1x1x1024xf32>
    %1361 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1359, %splat_352, %splat_353 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1360 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_354 = arith.constant 0.000000e+00 : f32
    %splat_355 = tensor.splat %cst_354 : tensor<1x1024xf32>
    %1362 = tosa.reshape %1361 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1363 = tosa.add %splat_355, %1362 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1364 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1365 = tosa.transpose %1354, %1364 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1366 = tosa.reshape %1336 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1367 = tosa.reshape %1365 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1368 = tosa.matmul %1366, %1367 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_356 = arith.constant 0.0883883461 : f32
    %splat_357 = tensor.splat %cst_356 : tensor<12x1x1024xf32>
    %1369 = tosa.mul %1368, %splat_357 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1370 = tosa.reshape %1363 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1371 = tosa.add %1369, %1370 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1372 = tosa.reduce_max %1371 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1373 = tosa.sub %1371, %1372 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1374 = math.exp %1373 : tensor<12x1x1024xf32>
    %1375 = tosa.reduce_sum %1374 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1376 = tosa.log %1375 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1377 = tosa.add %1372, %1376 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1378 = tosa.sub %1371, %1377 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1379 = math.exp %1378 : tensor<12x1x1024xf32>
    %1380 = tosa.reshape %1377 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1381 = tosa.reshape %1358 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1382 = tosa.matmul %1379, %1381 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1383 = tosa.reshape %1382 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1384 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1385 = tosa.transpose %1383, %1384 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1386 = tosa.reshape %1385 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1387 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1388 = tosa.transpose %arg140, %1387 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1389 = tosa.reshape %1386 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_358 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1390 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1389, %1388 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_358 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1391 = tosa.reshape %1390 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1392 = tosa.add %1285, %1391 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1393 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_359 = arith.constant 2 : i32
    %1394 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1392 : tensor<1x1x1536xf32>) outs(%1393 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_359 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1395 = tosa.reduce_sum %1394 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1396 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1397 = tosa.reciprocal %1396 : (tensor<1xf32>) -> tensor<1xf32>
    %1398 = tosa.reshape %1397 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1399 = tosa.mul %1398, %1395 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1400 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1401 = tosa.add %1399, %1400 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1402 = tosa.rsqrt %1401 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1403 = tosa.mul %1392, %1402 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1404 = tosa.reshape %arg141 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1405 = tosa.mul %1404, %1403 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1406 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1407 = tosa.transpose %arg142, %1406 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1408 = tosa.reshape %1405 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_360 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1409 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1408, %1407 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_360 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1410 = tosa.reshape %1409 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1411 = tosa.sigmoid %1410 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1412 = tosa.mul %1410, %1411 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1413 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1414 = tosa.transpose %arg143, %1413 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1415 = tosa.reshape %1405 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_361 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1416 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1415, %1414 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_361 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1417 = tosa.reshape %1416 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1418 = tosa.mul %1412, %1417 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1419 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1420 = tosa.transpose %arg144, %1419 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1421 = tosa.reshape %1418 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_362 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1422 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1421, %1420 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_362 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1423 = tosa.reshape %1422 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1424 = tosa.add %1392, %1423 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1425 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_363 = arith.constant 2 : i32
    %1426 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1424 : tensor<1x1x1536xf32>) outs(%1425 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_363 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1427 = tosa.reduce_sum %1426 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1428 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1429 = tosa.reciprocal %1428 : (tensor<1xf32>) -> tensor<1xf32>
    %1430 = tosa.reshape %1429 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1431 = tosa.mul %1430, %1427 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1432 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1433 = tosa.add %1431, %1432 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1434 = tosa.rsqrt %1433 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1435 = tosa.mul %1424, %1434 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1436 = tosa.reshape %arg145 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1437 = tosa.mul %1436, %1435 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1438 = tosa.reshape %1437 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1439 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1440 = tosa.transpose %arg146, %1439 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_364 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1441 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1438, %1440 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_364 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1442 = tosa.reshape %arg147 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1443 = tosa.add %1442, %1441 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1444 = tosa.reshape %1443 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1445 = tosa.reshape %1444 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1446 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1447 = tosa.transpose %1445, %1446 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1448 = tosa.reshape %1437 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1449 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1450 = tosa.transpose %arg148, %1449 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_365 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1451 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1448, %1450 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_365 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1452 = tosa.reshape %arg149 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1453 = tosa.add %1452, %1451 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1454 = tosa.reshape %1453 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1455 = tosa.reshape %1454 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1456 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1457 = tosa.transpose %1455, %1456 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1458 = tosa.reshape %1437 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1459 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1460 = tosa.transpose %arg150, %1459 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_366 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1461 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1458, %1460 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_366 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1462 = tosa.reshape %arg151 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1463 = tosa.add %1462, %1461 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1464 = tosa.reshape %1463 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1465 = tosa.reshape %1464 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1466 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1467 = tosa.transpose %1465, %1466 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1468 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1469 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1470 = tosa.mul %1447, %1468 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_367 = tensor.extract_slice %1447[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_368 = tensor.extract_slice %1447[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1471 = tensor.empty() : tensor<1x12x1x64xf32>
    %1472 = linalg.negf ins(%extracted_slice_368 : tensor<1x12x1x64xf32>) outs(%1471 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1473 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_369 = tensor.insert_slice %1472 into %1473[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_370 = tensor.insert_slice %extracted_slice_367 into %inserted_slice_369[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1474 = tosa.mul %inserted_slice_370, %1469 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1475 = tosa.add %1470, %1474 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1476 = tosa.mul %1457, %1468 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_371 = tensor.extract_slice %1457[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_372 = tensor.extract_slice %1457[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1477 = tensor.empty() : tensor<1x2x1x64xf32>
    %1478 = linalg.negf ins(%extracted_slice_372 : tensor<1x2x1x64xf32>) outs(%1477 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1479 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_373 = tensor.insert_slice %1478 into %1479[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_374 = tensor.insert_slice %extracted_slice_371 into %inserted_slice_373[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1480 = tosa.mul %inserted_slice_374, %1469 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1481 = tosa.add %1476, %1480 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1482 = bufferization.to_memref %arg152 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1483 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1484 = bufferization.to_memref %1481 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_375 = arith.constant 0 : index
    %c1_376 = arith.constant 1 : index
    %c1_377 = arith.constant 1 : index
    %c2_378 = arith.constant 2 : index
    %c1_379 = arith.constant 1 : index
    %c128_380 = arith.constant 128 : index
    scf.for %arg399 = %c0_375 to %c1_377 step %c1_376 {
      scf.for %arg400 = %c0_375 to %c2_378 step %c1_376 {
        scf.for %arg401 = %c0_375 to %c1_379 step %c1_376 {
          %3945 = memref.load %1483[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_375 to %c128_380 step %c1_376 {
            %3947 = memref.load %1484[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1482[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1485 = bufferization.to_tensor %1482 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1486 = bufferization.to_memref %arg153 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1487 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1488 = bufferization.to_memref %1467 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_381 = arith.constant 0 : index
    %c1_382 = arith.constant 1 : index
    %c1_383 = arith.constant 1 : index
    %c2_384 = arith.constant 2 : index
    %c1_385 = arith.constant 1 : index
    %c128_386 = arith.constant 128 : index
    scf.for %arg399 = %c0_381 to %c1_383 step %c1_382 {
      scf.for %arg400 = %c0_381 to %c2_384 step %c1_382 {
        scf.for %arg401 = %c0_381 to %c1_385 step %c1_382 {
          %3945 = memref.load %1487[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_381 to %c128_386 step %c1_382 {
            %3947 = memref.load %1488[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1486[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1489 = bufferization.to_tensor %1486 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1490 = tosa.reshape %1485 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1491 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1492 = tosa.add %1490, %1491 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1493 = tosa.reshape %1492 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1494 = tosa.reshape %1489 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1495 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1496 = tosa.add %1494, %1495 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1497 = tosa.reshape %1496 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1498 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_387 = arith.constant 0xFF800000 : f32
    %cst_388 = arith.constant 0.000000e+00 : f32
    %1499 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_389 = tensor.splat %cst_388 : tensor<1x1x1x1024xf32>
    %splat_390 = tensor.splat %cst_387 : tensor<1x1x1x1024xf32>
    %1500 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1498, %splat_389, %splat_390 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1499 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_391 = arith.constant 0.000000e+00 : f32
    %splat_392 = tensor.splat %cst_391 : tensor<1x1024xf32>
    %1501 = tosa.reshape %1500 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1502 = tosa.add %splat_392, %1501 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1503 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1504 = tosa.transpose %1493, %1503 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1505 = tosa.reshape %1475 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1506 = tosa.reshape %1504 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1507 = tosa.matmul %1505, %1506 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_393 = arith.constant 0.0883883461 : f32
    %splat_394 = tensor.splat %cst_393 : tensor<12x1x1024xf32>
    %1508 = tosa.mul %1507, %splat_394 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1509 = tosa.reshape %1502 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1510 = tosa.add %1508, %1509 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1511 = tosa.reduce_max %1510 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1512 = tosa.sub %1510, %1511 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1513 = math.exp %1512 : tensor<12x1x1024xf32>
    %1514 = tosa.reduce_sum %1513 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1515 = tosa.log %1514 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1516 = tosa.add %1511, %1515 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1517 = tosa.sub %1510, %1516 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1518 = math.exp %1517 : tensor<12x1x1024xf32>
    %1519 = tosa.reshape %1516 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1520 = tosa.reshape %1497 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1521 = tosa.matmul %1518, %1520 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1522 = tosa.reshape %1521 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1523 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1524 = tosa.transpose %1522, %1523 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1525 = tosa.reshape %1524 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1526 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1527 = tosa.transpose %arg154, %1526 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1528 = tosa.reshape %1525 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_395 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1529 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1528, %1527 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_395 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1530 = tosa.reshape %1529 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1531 = tosa.add %1424, %1530 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1532 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_396 = arith.constant 2 : i32
    %1533 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1531 : tensor<1x1x1536xf32>) outs(%1532 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_396 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1534 = tosa.reduce_sum %1533 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1535 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1536 = tosa.reciprocal %1535 : (tensor<1xf32>) -> tensor<1xf32>
    %1537 = tosa.reshape %1536 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1538 = tosa.mul %1537, %1534 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1539 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1540 = tosa.add %1538, %1539 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1541 = tosa.rsqrt %1540 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1542 = tosa.mul %1531, %1541 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1543 = tosa.reshape %arg155 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1544 = tosa.mul %1543, %1542 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1545 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1546 = tosa.transpose %arg156, %1545 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1547 = tosa.reshape %1544 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_397 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1548 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1547, %1546 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_397 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1549 = tosa.reshape %1548 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1550 = tosa.sigmoid %1549 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1551 = tosa.mul %1549, %1550 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1552 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1553 = tosa.transpose %arg157, %1552 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1554 = tosa.reshape %1544 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_398 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1555 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1554, %1553 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_398 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1556 = tosa.reshape %1555 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1557 = tosa.mul %1551, %1556 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1558 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1559 = tosa.transpose %arg158, %1558 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1560 = tosa.reshape %1557 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_399 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1561 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1560, %1559 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_399 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1562 = tosa.reshape %1561 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1563 = tosa.add %1531, %1562 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1564 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_400 = arith.constant 2 : i32
    %1565 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1563 : tensor<1x1x1536xf32>) outs(%1564 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_400 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1566 = tosa.reduce_sum %1565 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1567 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1568 = tosa.reciprocal %1567 : (tensor<1xf32>) -> tensor<1xf32>
    %1569 = tosa.reshape %1568 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1570 = tosa.mul %1569, %1566 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1571 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1572 = tosa.add %1570, %1571 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1573 = tosa.rsqrt %1572 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1574 = tosa.mul %1563, %1573 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1575 = tosa.reshape %arg159 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1576 = tosa.mul %1575, %1574 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1577 = tosa.reshape %1576 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1578 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1579 = tosa.transpose %arg160, %1578 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_401 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1580 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1577, %1579 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_401 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1581 = tosa.reshape %arg161 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1582 = tosa.add %1581, %1580 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1583 = tosa.reshape %1582 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1584 = tosa.reshape %1583 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1585 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1586 = tosa.transpose %1584, %1585 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1587 = tosa.reshape %1576 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1588 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1589 = tosa.transpose %arg162, %1588 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_402 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1590 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1587, %1589 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_402 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1591 = tosa.reshape %arg163 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1592 = tosa.add %1591, %1590 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1593 = tosa.reshape %1592 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1594 = tosa.reshape %1593 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1595 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1596 = tosa.transpose %1594, %1595 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1597 = tosa.reshape %1576 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1598 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1599 = tosa.transpose %arg164, %1598 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_403 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1600 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1597, %1599 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_403 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1601 = tosa.reshape %arg165 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1602 = tosa.add %1601, %1600 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1603 = tosa.reshape %1602 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1604 = tosa.reshape %1603 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1605 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1606 = tosa.transpose %1604, %1605 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1607 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1608 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1609 = tosa.mul %1586, %1607 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_404 = tensor.extract_slice %1586[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_405 = tensor.extract_slice %1586[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1610 = tensor.empty() : tensor<1x12x1x64xf32>
    %1611 = linalg.negf ins(%extracted_slice_405 : tensor<1x12x1x64xf32>) outs(%1610 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1612 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_406 = tensor.insert_slice %1611 into %1612[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_407 = tensor.insert_slice %extracted_slice_404 into %inserted_slice_406[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1613 = tosa.mul %inserted_slice_407, %1608 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1614 = tosa.add %1609, %1613 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1615 = tosa.mul %1596, %1607 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_408 = tensor.extract_slice %1596[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_409 = tensor.extract_slice %1596[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1616 = tensor.empty() : tensor<1x2x1x64xf32>
    %1617 = linalg.negf ins(%extracted_slice_409 : tensor<1x2x1x64xf32>) outs(%1616 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1618 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_410 = tensor.insert_slice %1617 into %1618[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_411 = tensor.insert_slice %extracted_slice_408 into %inserted_slice_410[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1619 = tosa.mul %inserted_slice_411, %1608 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1620 = tosa.add %1615, %1619 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1621 = bufferization.to_memref %arg166 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1622 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1623 = bufferization.to_memref %1620 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_412 = arith.constant 0 : index
    %c1_413 = arith.constant 1 : index
    %c1_414 = arith.constant 1 : index
    %c2_415 = arith.constant 2 : index
    %c1_416 = arith.constant 1 : index
    %c128_417 = arith.constant 128 : index
    scf.for %arg399 = %c0_412 to %c1_414 step %c1_413 {
      scf.for %arg400 = %c0_412 to %c2_415 step %c1_413 {
        scf.for %arg401 = %c0_412 to %c1_416 step %c1_413 {
          %3945 = memref.load %1622[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_412 to %c128_417 step %c1_413 {
            %3947 = memref.load %1623[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1621[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1624 = bufferization.to_tensor %1621 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1625 = bufferization.to_memref %arg167 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1626 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1627 = bufferization.to_memref %1606 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_418 = arith.constant 0 : index
    %c1_419 = arith.constant 1 : index
    %c1_420 = arith.constant 1 : index
    %c2_421 = arith.constant 2 : index
    %c1_422 = arith.constant 1 : index
    %c128_423 = arith.constant 128 : index
    scf.for %arg399 = %c0_418 to %c1_420 step %c1_419 {
      scf.for %arg400 = %c0_418 to %c2_421 step %c1_419 {
        scf.for %arg401 = %c0_418 to %c1_422 step %c1_419 {
          %3945 = memref.load %1626[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_418 to %c128_423 step %c1_419 {
            %3947 = memref.load %1627[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1625[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1628 = bufferization.to_tensor %1625 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1629 = tosa.reshape %1624 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1630 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1631 = tosa.add %1629, %1630 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1632 = tosa.reshape %1631 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1633 = tosa.reshape %1628 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1634 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1635 = tosa.add %1633, %1634 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1636 = tosa.reshape %1635 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1637 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_424 = arith.constant 0xFF800000 : f32
    %cst_425 = arith.constant 0.000000e+00 : f32
    %1638 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_426 = tensor.splat %cst_425 : tensor<1x1x1x1024xf32>
    %splat_427 = tensor.splat %cst_424 : tensor<1x1x1x1024xf32>
    %1639 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1637, %splat_426, %splat_427 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1638 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_428 = arith.constant 0.000000e+00 : f32
    %splat_429 = tensor.splat %cst_428 : tensor<1x1024xf32>
    %1640 = tosa.reshape %1639 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1641 = tosa.add %splat_429, %1640 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1642 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1643 = tosa.transpose %1632, %1642 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1644 = tosa.reshape %1614 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1645 = tosa.reshape %1643 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1646 = tosa.matmul %1644, %1645 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_430 = arith.constant 0.0883883461 : f32
    %splat_431 = tensor.splat %cst_430 : tensor<12x1x1024xf32>
    %1647 = tosa.mul %1646, %splat_431 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1648 = tosa.reshape %1641 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1649 = tosa.add %1647, %1648 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1650 = tosa.reduce_max %1649 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1651 = tosa.sub %1649, %1650 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1652 = math.exp %1651 : tensor<12x1x1024xf32>
    %1653 = tosa.reduce_sum %1652 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1654 = tosa.log %1653 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1655 = tosa.add %1650, %1654 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1656 = tosa.sub %1649, %1655 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1657 = math.exp %1656 : tensor<12x1x1024xf32>
    %1658 = tosa.reshape %1655 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1659 = tosa.reshape %1636 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1660 = tosa.matmul %1657, %1659 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1661 = tosa.reshape %1660 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1662 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1663 = tosa.transpose %1661, %1662 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1664 = tosa.reshape %1663 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1665 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1666 = tosa.transpose %arg168, %1665 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1667 = tosa.reshape %1664 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_432 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1668 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1667, %1666 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_432 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1669 = tosa.reshape %1668 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1670 = tosa.add %1563, %1669 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1671 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_433 = arith.constant 2 : i32
    %1672 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1670 : tensor<1x1x1536xf32>) outs(%1671 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_433 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1673 = tosa.reduce_sum %1672 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1674 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1675 = tosa.reciprocal %1674 : (tensor<1xf32>) -> tensor<1xf32>
    %1676 = tosa.reshape %1675 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1677 = tosa.mul %1676, %1673 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1678 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1679 = tosa.add %1677, %1678 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1680 = tosa.rsqrt %1679 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1681 = tosa.mul %1670, %1680 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1682 = tosa.reshape %arg169 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1683 = tosa.mul %1682, %1681 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1684 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1685 = tosa.transpose %arg170, %1684 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1686 = tosa.reshape %1683 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_434 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1687 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1686, %1685 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_434 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1688 = tosa.reshape %1687 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1689 = tosa.sigmoid %1688 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1690 = tosa.mul %1688, %1689 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1691 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1692 = tosa.transpose %arg171, %1691 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1693 = tosa.reshape %1683 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_435 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1694 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1693, %1692 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_435 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1695 = tosa.reshape %1694 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1696 = tosa.mul %1690, %1695 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1697 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1698 = tosa.transpose %arg172, %1697 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1699 = tosa.reshape %1696 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_436 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1700 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1699, %1698 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_436 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1701 = tosa.reshape %1700 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1702 = tosa.add %1670, %1701 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1703 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_437 = arith.constant 2 : i32
    %1704 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1702 : tensor<1x1x1536xf32>) outs(%1703 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_437 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1705 = tosa.reduce_sum %1704 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1706 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1707 = tosa.reciprocal %1706 : (tensor<1xf32>) -> tensor<1xf32>
    %1708 = tosa.reshape %1707 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1709 = tosa.mul %1708, %1705 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1710 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1711 = tosa.add %1709, %1710 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1712 = tosa.rsqrt %1711 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1713 = tosa.mul %1702, %1712 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1714 = tosa.reshape %arg173 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1715 = tosa.mul %1714, %1713 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1716 = tosa.reshape %1715 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1717 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1718 = tosa.transpose %arg174, %1717 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_438 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1719 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1716, %1718 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_438 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1720 = tosa.reshape %arg175 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1721 = tosa.add %1720, %1719 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1722 = tosa.reshape %1721 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1723 = tosa.reshape %1722 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1724 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1725 = tosa.transpose %1723, %1724 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1726 = tosa.reshape %1715 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1727 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1728 = tosa.transpose %arg176, %1727 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_439 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1729 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1726, %1728 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_439 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1730 = tosa.reshape %arg177 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1731 = tosa.add %1730, %1729 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1732 = tosa.reshape %1731 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1733 = tosa.reshape %1732 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1734 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1735 = tosa.transpose %1733, %1734 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1736 = tosa.reshape %1715 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1737 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1738 = tosa.transpose %arg178, %1737 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_440 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1739 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1736, %1738 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_440 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1740 = tosa.reshape %arg179 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1741 = tosa.add %1740, %1739 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1742 = tosa.reshape %1741 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1743 = tosa.reshape %1742 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1744 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1745 = tosa.transpose %1743, %1744 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1746 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1747 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1748 = tosa.mul %1725, %1746 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_441 = tensor.extract_slice %1725[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_442 = tensor.extract_slice %1725[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1749 = tensor.empty() : tensor<1x12x1x64xf32>
    %1750 = linalg.negf ins(%extracted_slice_442 : tensor<1x12x1x64xf32>) outs(%1749 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1751 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_443 = tensor.insert_slice %1750 into %1751[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_444 = tensor.insert_slice %extracted_slice_441 into %inserted_slice_443[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1752 = tosa.mul %inserted_slice_444, %1747 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1753 = tosa.add %1748, %1752 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1754 = tosa.mul %1735, %1746 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_445 = tensor.extract_slice %1735[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_446 = tensor.extract_slice %1735[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1755 = tensor.empty() : tensor<1x2x1x64xf32>
    %1756 = linalg.negf ins(%extracted_slice_446 : tensor<1x2x1x64xf32>) outs(%1755 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1757 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_447 = tensor.insert_slice %1756 into %1757[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_448 = tensor.insert_slice %extracted_slice_445 into %inserted_slice_447[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1758 = tosa.mul %inserted_slice_448, %1747 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1759 = tosa.add %1754, %1758 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1760 = bufferization.to_memref %arg180 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1761 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1762 = bufferization.to_memref %1759 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_449 = arith.constant 0 : index
    %c1_450 = arith.constant 1 : index
    %c1_451 = arith.constant 1 : index
    %c2_452 = arith.constant 2 : index
    %c1_453 = arith.constant 1 : index
    %c128_454 = arith.constant 128 : index
    scf.for %arg399 = %c0_449 to %c1_451 step %c1_450 {
      scf.for %arg400 = %c0_449 to %c2_452 step %c1_450 {
        scf.for %arg401 = %c0_449 to %c1_453 step %c1_450 {
          %3945 = memref.load %1761[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_449 to %c128_454 step %c1_450 {
            %3947 = memref.load %1762[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1760[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1763 = bufferization.to_tensor %1760 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1764 = bufferization.to_memref %arg181 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1765 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1766 = bufferization.to_memref %1745 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_455 = arith.constant 0 : index
    %c1_456 = arith.constant 1 : index
    %c1_457 = arith.constant 1 : index
    %c2_458 = arith.constant 2 : index
    %c1_459 = arith.constant 1 : index
    %c128_460 = arith.constant 128 : index
    scf.for %arg399 = %c0_455 to %c1_457 step %c1_456 {
      scf.for %arg400 = %c0_455 to %c2_458 step %c1_456 {
        scf.for %arg401 = %c0_455 to %c1_459 step %c1_456 {
          %3945 = memref.load %1765[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_455 to %c128_460 step %c1_456 {
            %3947 = memref.load %1766[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1764[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1767 = bufferization.to_tensor %1764 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1768 = tosa.reshape %1763 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1769 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1770 = tosa.add %1768, %1769 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1771 = tosa.reshape %1770 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1772 = tosa.reshape %1767 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1773 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1774 = tosa.add %1772, %1773 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1775 = tosa.reshape %1774 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1776 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_461 = arith.constant 0xFF800000 : f32
    %cst_462 = arith.constant 0.000000e+00 : f32
    %1777 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_463 = tensor.splat %cst_462 : tensor<1x1x1x1024xf32>
    %splat_464 = tensor.splat %cst_461 : tensor<1x1x1x1024xf32>
    %1778 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1776, %splat_463, %splat_464 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1777 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_465 = arith.constant 0.000000e+00 : f32
    %splat_466 = tensor.splat %cst_465 : tensor<1x1024xf32>
    %1779 = tosa.reshape %1778 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1780 = tosa.add %splat_466, %1779 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1781 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1782 = tosa.transpose %1771, %1781 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1783 = tosa.reshape %1753 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1784 = tosa.reshape %1782 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1785 = tosa.matmul %1783, %1784 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_467 = arith.constant 0.0883883461 : f32
    %splat_468 = tensor.splat %cst_467 : tensor<12x1x1024xf32>
    %1786 = tosa.mul %1785, %splat_468 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1787 = tosa.reshape %1780 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1788 = tosa.add %1786, %1787 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1789 = tosa.reduce_max %1788 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1790 = tosa.sub %1788, %1789 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1791 = math.exp %1790 : tensor<12x1x1024xf32>
    %1792 = tosa.reduce_sum %1791 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1793 = tosa.log %1792 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1794 = tosa.add %1789, %1793 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1795 = tosa.sub %1788, %1794 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1796 = math.exp %1795 : tensor<12x1x1024xf32>
    %1797 = tosa.reshape %1794 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1798 = tosa.reshape %1775 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1799 = tosa.matmul %1796, %1798 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1800 = tosa.reshape %1799 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1801 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1802 = tosa.transpose %1800, %1801 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1803 = tosa.reshape %1802 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1804 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1805 = tosa.transpose %arg182, %1804 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1806 = tosa.reshape %1803 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_469 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1807 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1806, %1805 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_469 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1808 = tosa.reshape %1807 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1809 = tosa.add %1702, %1808 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1810 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_470 = arith.constant 2 : i32
    %1811 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1809 : tensor<1x1x1536xf32>) outs(%1810 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_470 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1812 = tosa.reduce_sum %1811 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1813 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1814 = tosa.reciprocal %1813 : (tensor<1xf32>) -> tensor<1xf32>
    %1815 = tosa.reshape %1814 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1816 = tosa.mul %1815, %1812 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1817 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1818 = tosa.add %1816, %1817 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1819 = tosa.rsqrt %1818 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1820 = tosa.mul %1809, %1819 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1821 = tosa.reshape %arg183 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1822 = tosa.mul %1821, %1820 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1823 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1824 = tosa.transpose %arg184, %1823 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1825 = tosa.reshape %1822 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_471 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1826 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1825, %1824 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_471 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1827 = tosa.reshape %1826 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1828 = tosa.sigmoid %1827 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1829 = tosa.mul %1827, %1828 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1830 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1831 = tosa.transpose %arg185, %1830 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1832 = tosa.reshape %1822 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_472 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1833 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1832, %1831 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_472 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1834 = tosa.reshape %1833 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1835 = tosa.mul %1829, %1834 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1836 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1837 = tosa.transpose %arg186, %1836 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1838 = tosa.reshape %1835 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_473 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1839 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1838, %1837 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_473 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1840 = tosa.reshape %1839 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1841 = tosa.add %1809, %1840 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1842 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_474 = arith.constant 2 : i32
    %1843 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1841 : tensor<1x1x1536xf32>) outs(%1842 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_474 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1844 = tosa.reduce_sum %1843 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1845 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1846 = tosa.reciprocal %1845 : (tensor<1xf32>) -> tensor<1xf32>
    %1847 = tosa.reshape %1846 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1848 = tosa.mul %1847, %1844 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1849 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1850 = tosa.add %1848, %1849 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1851 = tosa.rsqrt %1850 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1852 = tosa.mul %1841, %1851 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1853 = tosa.reshape %arg187 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1854 = tosa.mul %1853, %1852 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1855 = tosa.reshape %1854 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1856 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1857 = tosa.transpose %arg188, %1856 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_475 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1858 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1855, %1857 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_475 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1859 = tosa.reshape %arg189 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1860 = tosa.add %1859, %1858 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1861 = tosa.reshape %1860 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1862 = tosa.reshape %1861 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %1863 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1864 = tosa.transpose %1862, %1863 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %1865 = tosa.reshape %1854 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1866 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1867 = tosa.transpose %arg190, %1866 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_476 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1868 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1865, %1867 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_476 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1869 = tosa.reshape %arg191 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1870 = tosa.add %1869, %1868 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1871 = tosa.reshape %1870 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1872 = tosa.reshape %1871 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1873 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1874 = tosa.transpose %1872, %1873 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1875 = tosa.reshape %1854 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1876 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1877 = tosa.transpose %arg192, %1876 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_477 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %1878 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1875, %1877 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_477 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1879 = tosa.reshape %arg193 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %1880 = tosa.add %1879, %1878 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1881 = tosa.reshape %1880 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %1882 = tosa.reshape %1881 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %1883 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1884 = tosa.transpose %1882, %1883 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %1885 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1886 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %1887 = tosa.mul %1864, %1885 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_478 = tensor.extract_slice %1864[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_479 = tensor.extract_slice %1864[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1888 = tensor.empty() : tensor<1x12x1x64xf32>
    %1889 = linalg.negf ins(%extracted_slice_479 : tensor<1x12x1x64xf32>) outs(%1888 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %1890 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_480 = tensor.insert_slice %1889 into %1890[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_481 = tensor.insert_slice %extracted_slice_478 into %inserted_slice_480[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1891 = tosa.mul %inserted_slice_481, %1886 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1892 = tosa.add %1887, %1891 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1893 = tosa.mul %1874, %1885 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_482 = tensor.extract_slice %1874[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_483 = tensor.extract_slice %1874[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1894 = tensor.empty() : tensor<1x2x1x64xf32>
    %1895 = linalg.negf ins(%extracted_slice_483 : tensor<1x2x1x64xf32>) outs(%1894 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %1896 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_484 = tensor.insert_slice %1895 into %1896[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_485 = tensor.insert_slice %extracted_slice_482 into %inserted_slice_484[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1897 = tosa.mul %inserted_slice_485, %1886 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1898 = tosa.add %1893, %1897 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1899 = bufferization.to_memref %arg194 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1900 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1901 = bufferization.to_memref %1898 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_486 = arith.constant 0 : index
    %c1_487 = arith.constant 1 : index
    %c1_488 = arith.constant 1 : index
    %c2_489 = arith.constant 2 : index
    %c1_490 = arith.constant 1 : index
    %c128_491 = arith.constant 128 : index
    scf.for %arg399 = %c0_486 to %c1_488 step %c1_487 {
      scf.for %arg400 = %c0_486 to %c2_489 step %c1_487 {
        scf.for %arg401 = %c0_486 to %c1_490 step %c1_487 {
          %3945 = memref.load %1900[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_486 to %c128_491 step %c1_487 {
            %3947 = memref.load %1901[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1899[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1902 = bufferization.to_tensor %1899 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1903 = bufferization.to_memref %arg195 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1904 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %1905 = bufferization.to_memref %1884 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_492 = arith.constant 0 : index
    %c1_493 = arith.constant 1 : index
    %c1_494 = arith.constant 1 : index
    %c2_495 = arith.constant 2 : index
    %c1_496 = arith.constant 1 : index
    %c128_497 = arith.constant 128 : index
    scf.for %arg399 = %c0_492 to %c1_494 step %c1_493 {
      scf.for %arg400 = %c0_492 to %c2_495 step %c1_493 {
        scf.for %arg401 = %c0_492 to %c1_496 step %c1_493 {
          %3945 = memref.load %1904[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_492 to %c128_497 step %c1_493 {
            %3947 = memref.load %1905[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %1903[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1906 = bufferization.to_tensor %1903 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1907 = tosa.reshape %1902 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1908 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1909 = tosa.add %1907, %1908 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1910 = tosa.reshape %1909 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1911 = tosa.reshape %1906 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %1912 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %1913 = tosa.add %1911, %1912 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %1914 = tosa.reshape %1913 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %1915 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_498 = arith.constant 0xFF800000 : f32
    %cst_499 = arith.constant 0.000000e+00 : f32
    %1916 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_500 = tensor.splat %cst_499 : tensor<1x1x1x1024xf32>
    %splat_501 = tensor.splat %cst_498 : tensor<1x1x1x1024xf32>
    %1917 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1915, %splat_500, %splat_501 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1916 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_502 = arith.constant 0.000000e+00 : f32
    %splat_503 = tensor.splat %cst_502 : tensor<1x1024xf32>
    %1918 = tosa.reshape %1917 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %1919 = tosa.add %splat_503, %1918 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %1920 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1921 = tosa.transpose %1910, %1920 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %1922 = tosa.reshape %1892 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %1923 = tosa.reshape %1921 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %1924 = tosa.matmul %1922, %1923 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_504 = arith.constant 0.0883883461 : f32
    %splat_505 = tensor.splat %cst_504 : tensor<12x1x1024xf32>
    %1925 = tosa.mul %1924, %splat_505 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1926 = tosa.reshape %1919 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %1927 = tosa.add %1925, %1926 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %1928 = tosa.reduce_max %1927 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1929 = tosa.sub %1927, %1928 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1930 = math.exp %1929 : tensor<12x1x1024xf32>
    %1931 = tosa.reduce_sum %1930 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %1932 = tosa.log %1931 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1933 = tosa.add %1928, %1932 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %1934 = tosa.sub %1927, %1933 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %1935 = math.exp %1934 : tensor<12x1x1024xf32>
    %1936 = tosa.reshape %1933 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %1937 = tosa.reshape %1914 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %1938 = tosa.matmul %1935, %1937 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %1939 = tosa.reshape %1938 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1940 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %1941 = tosa.transpose %1939, %1940 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %1942 = tosa.reshape %1941 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %1943 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1944 = tosa.transpose %arg196, %1943 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %1945 = tosa.reshape %1942 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_506 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1946 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1945, %1944 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_506 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1947 = tosa.reshape %1946 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1948 = tosa.add %1841, %1947 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1949 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_507 = arith.constant 2 : i32
    %1950 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1948 : tensor<1x1x1536xf32>) outs(%1949 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_507 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1951 = tosa.reduce_sum %1950 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1952 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1953 = tosa.reciprocal %1952 : (tensor<1xf32>) -> tensor<1xf32>
    %1954 = tosa.reshape %1953 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1955 = tosa.mul %1954, %1951 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1956 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1957 = tosa.add %1955, %1956 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1958 = tosa.rsqrt %1957 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1959 = tosa.mul %1948, %1958 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1960 = tosa.reshape %arg197 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1961 = tosa.mul %1960, %1959 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1962 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1963 = tosa.transpose %arg198, %1962 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1964 = tosa.reshape %1961 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_508 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1965 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1964, %1963 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_508 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1966 = tosa.reshape %1965 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1967 = tosa.sigmoid %1966 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1968 = tosa.mul %1966, %1967 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1969 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1970 = tosa.transpose %arg199, %1969 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %1971 = tosa.reshape %1961 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_509 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %1972 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1971, %1970 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_509 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1973 = tosa.reshape %1972 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %1974 = tosa.mul %1968, %1973 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1975 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1976 = tosa.transpose %arg200, %1975 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %1977 = tosa.reshape %1974 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_510 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1978 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1977, %1976 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_510 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1979 = tosa.reshape %1978 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %1980 = tosa.add %1948, %1979 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1981 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_511 = arith.constant 2 : i32
    %1982 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1980 : tensor<1x1x1536xf32>) outs(%1981 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_511 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %1983 = tosa.reduce_sum %1982 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1984 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %1985 = tosa.reciprocal %1984 : (tensor<1xf32>) -> tensor<1xf32>
    %1986 = tosa.reshape %1985 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %1987 = tosa.mul %1986, %1983 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1988 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1989 = tosa.add %1987, %1988 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1990 = tosa.rsqrt %1989 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1991 = tosa.mul %1980, %1990 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %1992 = tosa.reshape %arg201 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %1993 = tosa.mul %1992, %1991 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1994 = tosa.reshape %1993 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %1995 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %1996 = tosa.transpose %arg202, %1995 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_512 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %1997 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1994, %1996 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_512 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1998 = tosa.reshape %arg203 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %1999 = tosa.add %1998, %1997 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2000 = tosa.reshape %1999 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2001 = tosa.reshape %2000 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2002 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2003 = tosa.transpose %2001, %2002 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2004 = tosa.reshape %1993 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2005 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2006 = tosa.transpose %arg204, %2005 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_513 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2007 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2004, %2006 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_513 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2008 = tosa.reshape %arg205 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2009 = tosa.add %2008, %2007 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2010 = tosa.reshape %2009 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2011 = tosa.reshape %2010 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2012 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2013 = tosa.transpose %2011, %2012 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2014 = tosa.reshape %1993 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2015 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2016 = tosa.transpose %arg206, %2015 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_514 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2017 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2014, %2016 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_514 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2018 = tosa.reshape %arg207 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2019 = tosa.add %2018, %2017 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2020 = tosa.reshape %2019 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2021 = tosa.reshape %2020 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2022 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2023 = tosa.transpose %2021, %2022 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2024 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2025 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2026 = tosa.mul %2003, %2024 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_515 = tensor.extract_slice %2003[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_516 = tensor.extract_slice %2003[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2027 = tensor.empty() : tensor<1x12x1x64xf32>
    %2028 = linalg.negf ins(%extracted_slice_516 : tensor<1x12x1x64xf32>) outs(%2027 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2029 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_517 = tensor.insert_slice %2028 into %2029[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_518 = tensor.insert_slice %extracted_slice_515 into %inserted_slice_517[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2030 = tosa.mul %inserted_slice_518, %2025 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2031 = tosa.add %2026, %2030 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2032 = tosa.mul %2013, %2024 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_519 = tensor.extract_slice %2013[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_520 = tensor.extract_slice %2013[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2033 = tensor.empty() : tensor<1x2x1x64xf32>
    %2034 = linalg.negf ins(%extracted_slice_520 : tensor<1x2x1x64xf32>) outs(%2033 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2035 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_521 = tensor.insert_slice %2034 into %2035[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_522 = tensor.insert_slice %extracted_slice_519 into %inserted_slice_521[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2036 = tosa.mul %inserted_slice_522, %2025 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2037 = tosa.add %2032, %2036 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2038 = bufferization.to_memref %arg208 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2039 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2040 = bufferization.to_memref %2037 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_523 = arith.constant 0 : index
    %c1_524 = arith.constant 1 : index
    %c1_525 = arith.constant 1 : index
    %c2_526 = arith.constant 2 : index
    %c1_527 = arith.constant 1 : index
    %c128_528 = arith.constant 128 : index
    scf.for %arg399 = %c0_523 to %c1_525 step %c1_524 {
      scf.for %arg400 = %c0_523 to %c2_526 step %c1_524 {
        scf.for %arg401 = %c0_523 to %c1_527 step %c1_524 {
          %3945 = memref.load %2039[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_523 to %c128_528 step %c1_524 {
            %3947 = memref.load %2040[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2038[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2041 = bufferization.to_tensor %2038 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2042 = bufferization.to_memref %arg209 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2043 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2044 = bufferization.to_memref %2023 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_529 = arith.constant 0 : index
    %c1_530 = arith.constant 1 : index
    %c1_531 = arith.constant 1 : index
    %c2_532 = arith.constant 2 : index
    %c1_533 = arith.constant 1 : index
    %c128_534 = arith.constant 128 : index
    scf.for %arg399 = %c0_529 to %c1_531 step %c1_530 {
      scf.for %arg400 = %c0_529 to %c2_532 step %c1_530 {
        scf.for %arg401 = %c0_529 to %c1_533 step %c1_530 {
          %3945 = memref.load %2043[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_529 to %c128_534 step %c1_530 {
            %3947 = memref.load %2044[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2042[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2045 = bufferization.to_tensor %2042 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2046 = tosa.reshape %2041 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2047 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2048 = tosa.add %2046, %2047 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2049 = tosa.reshape %2048 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2050 = tosa.reshape %2045 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2051 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2052 = tosa.add %2050, %2051 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2053 = tosa.reshape %2052 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2054 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_535 = arith.constant 0xFF800000 : f32
    %cst_536 = arith.constant 0.000000e+00 : f32
    %2055 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_537 = tensor.splat %cst_536 : tensor<1x1x1x1024xf32>
    %splat_538 = tensor.splat %cst_535 : tensor<1x1x1x1024xf32>
    %2056 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2054, %splat_537, %splat_538 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2055 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_539 = arith.constant 0.000000e+00 : f32
    %splat_540 = tensor.splat %cst_539 : tensor<1x1024xf32>
    %2057 = tosa.reshape %2056 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2058 = tosa.add %splat_540, %2057 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2059 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2060 = tosa.transpose %2049, %2059 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2061 = tosa.reshape %2031 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2062 = tosa.reshape %2060 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2063 = tosa.matmul %2061, %2062 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_541 = arith.constant 0.0883883461 : f32
    %splat_542 = tensor.splat %cst_541 : tensor<12x1x1024xf32>
    %2064 = tosa.mul %2063, %splat_542 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2065 = tosa.reshape %2058 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2066 = tosa.add %2064, %2065 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2067 = tosa.reduce_max %2066 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2068 = tosa.sub %2066, %2067 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2069 = math.exp %2068 : tensor<12x1x1024xf32>
    %2070 = tosa.reduce_sum %2069 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2071 = tosa.log %2070 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2072 = tosa.add %2067, %2071 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2073 = tosa.sub %2066, %2072 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2074 = math.exp %2073 : tensor<12x1x1024xf32>
    %2075 = tosa.reshape %2072 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2076 = tosa.reshape %2053 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2077 = tosa.matmul %2074, %2076 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2078 = tosa.reshape %2077 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2079 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2080 = tosa.transpose %2078, %2079 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2081 = tosa.reshape %2080 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2082 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2083 = tosa.transpose %arg210, %2082 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2084 = tosa.reshape %2081 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_543 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2085 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2084, %2083 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_543 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2086 = tosa.reshape %2085 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2087 = tosa.add %1980, %2086 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2088 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_544 = arith.constant 2 : i32
    %2089 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2087 : tensor<1x1x1536xf32>) outs(%2088 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_544 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2090 = tosa.reduce_sum %2089 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2091 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2092 = tosa.reciprocal %2091 : (tensor<1xf32>) -> tensor<1xf32>
    %2093 = tosa.reshape %2092 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2094 = tosa.mul %2093, %2090 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2095 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2096 = tosa.add %2094, %2095 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2097 = tosa.rsqrt %2096 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2098 = tosa.mul %2087, %2097 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2099 = tosa.reshape %arg211 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2100 = tosa.mul %2099, %2098 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2101 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2102 = tosa.transpose %arg212, %2101 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2103 = tosa.reshape %2100 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_545 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2104 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2103, %2102 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_545 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2105 = tosa.reshape %2104 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2106 = tosa.sigmoid %2105 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2107 = tosa.mul %2105, %2106 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2108 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2109 = tosa.transpose %arg213, %2108 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2110 = tosa.reshape %2100 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_546 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2111 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2110, %2109 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_546 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2112 = tosa.reshape %2111 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2113 = tosa.mul %2107, %2112 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2114 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2115 = tosa.transpose %arg214, %2114 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2116 = tosa.reshape %2113 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_547 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2117 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2116, %2115 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_547 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2118 = tosa.reshape %2117 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2119 = tosa.add %2087, %2118 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2120 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_548 = arith.constant 2 : i32
    %2121 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2119 : tensor<1x1x1536xf32>) outs(%2120 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_548 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2122 = tosa.reduce_sum %2121 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2123 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2124 = tosa.reciprocal %2123 : (tensor<1xf32>) -> tensor<1xf32>
    %2125 = tosa.reshape %2124 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2126 = tosa.mul %2125, %2122 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2127 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2128 = tosa.add %2126, %2127 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2129 = tosa.rsqrt %2128 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2130 = tosa.mul %2119, %2129 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2131 = tosa.reshape %arg215 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2132 = tosa.mul %2131, %2130 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2133 = tosa.reshape %2132 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2134 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2135 = tosa.transpose %arg216, %2134 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_549 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2136 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2133, %2135 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_549 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2137 = tosa.reshape %arg217 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2138 = tosa.add %2137, %2136 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2139 = tosa.reshape %2138 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2140 = tosa.reshape %2139 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2141 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2142 = tosa.transpose %2140, %2141 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2143 = tosa.reshape %2132 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2144 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2145 = tosa.transpose %arg218, %2144 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_550 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2146 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2143, %2145 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_550 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2147 = tosa.reshape %arg219 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2148 = tosa.add %2147, %2146 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2149 = tosa.reshape %2148 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2150 = tosa.reshape %2149 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2151 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2152 = tosa.transpose %2150, %2151 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2153 = tosa.reshape %2132 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2154 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2155 = tosa.transpose %arg220, %2154 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_551 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2156 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2153, %2155 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_551 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2157 = tosa.reshape %arg221 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2158 = tosa.add %2157, %2156 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2159 = tosa.reshape %2158 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2160 = tosa.reshape %2159 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2161 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2162 = tosa.transpose %2160, %2161 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2163 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2164 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2165 = tosa.mul %2142, %2163 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_552 = tensor.extract_slice %2142[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_553 = tensor.extract_slice %2142[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2166 = tensor.empty() : tensor<1x12x1x64xf32>
    %2167 = linalg.negf ins(%extracted_slice_553 : tensor<1x12x1x64xf32>) outs(%2166 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2168 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_554 = tensor.insert_slice %2167 into %2168[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_555 = tensor.insert_slice %extracted_slice_552 into %inserted_slice_554[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2169 = tosa.mul %inserted_slice_555, %2164 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2170 = tosa.add %2165, %2169 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2171 = tosa.mul %2152, %2163 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_556 = tensor.extract_slice %2152[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_557 = tensor.extract_slice %2152[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2172 = tensor.empty() : tensor<1x2x1x64xf32>
    %2173 = linalg.negf ins(%extracted_slice_557 : tensor<1x2x1x64xf32>) outs(%2172 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2174 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_558 = tensor.insert_slice %2173 into %2174[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_559 = tensor.insert_slice %extracted_slice_556 into %inserted_slice_558[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2175 = tosa.mul %inserted_slice_559, %2164 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2176 = tosa.add %2171, %2175 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2177 = bufferization.to_memref %arg222 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2178 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2179 = bufferization.to_memref %2176 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_560 = arith.constant 0 : index
    %c1_561 = arith.constant 1 : index
    %c1_562 = arith.constant 1 : index
    %c2_563 = arith.constant 2 : index
    %c1_564 = arith.constant 1 : index
    %c128_565 = arith.constant 128 : index
    scf.for %arg399 = %c0_560 to %c1_562 step %c1_561 {
      scf.for %arg400 = %c0_560 to %c2_563 step %c1_561 {
        scf.for %arg401 = %c0_560 to %c1_564 step %c1_561 {
          %3945 = memref.load %2178[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_560 to %c128_565 step %c1_561 {
            %3947 = memref.load %2179[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2177[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2180 = bufferization.to_tensor %2177 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2181 = bufferization.to_memref %arg223 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2182 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2183 = bufferization.to_memref %2162 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_566 = arith.constant 0 : index
    %c1_567 = arith.constant 1 : index
    %c1_568 = arith.constant 1 : index
    %c2_569 = arith.constant 2 : index
    %c1_570 = arith.constant 1 : index
    %c128_571 = arith.constant 128 : index
    scf.for %arg399 = %c0_566 to %c1_568 step %c1_567 {
      scf.for %arg400 = %c0_566 to %c2_569 step %c1_567 {
        scf.for %arg401 = %c0_566 to %c1_570 step %c1_567 {
          %3945 = memref.load %2182[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_566 to %c128_571 step %c1_567 {
            %3947 = memref.load %2183[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2181[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2184 = bufferization.to_tensor %2181 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2185 = tosa.reshape %2180 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2186 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2187 = tosa.add %2185, %2186 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2188 = tosa.reshape %2187 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2189 = tosa.reshape %2184 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2190 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2191 = tosa.add %2189, %2190 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2192 = tosa.reshape %2191 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2193 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_572 = arith.constant 0xFF800000 : f32
    %cst_573 = arith.constant 0.000000e+00 : f32
    %2194 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_574 = tensor.splat %cst_573 : tensor<1x1x1x1024xf32>
    %splat_575 = tensor.splat %cst_572 : tensor<1x1x1x1024xf32>
    %2195 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2193, %splat_574, %splat_575 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2194 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_576 = arith.constant 0.000000e+00 : f32
    %splat_577 = tensor.splat %cst_576 : tensor<1x1024xf32>
    %2196 = tosa.reshape %2195 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2197 = tosa.add %splat_577, %2196 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2198 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2199 = tosa.transpose %2188, %2198 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2200 = tosa.reshape %2170 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2201 = tosa.reshape %2199 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2202 = tosa.matmul %2200, %2201 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_578 = arith.constant 0.0883883461 : f32
    %splat_579 = tensor.splat %cst_578 : tensor<12x1x1024xf32>
    %2203 = tosa.mul %2202, %splat_579 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2204 = tosa.reshape %2197 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2205 = tosa.add %2203, %2204 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2206 = tosa.reduce_max %2205 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2207 = tosa.sub %2205, %2206 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2208 = math.exp %2207 : tensor<12x1x1024xf32>
    %2209 = tosa.reduce_sum %2208 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2210 = tosa.log %2209 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2211 = tosa.add %2206, %2210 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2212 = tosa.sub %2205, %2211 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2213 = math.exp %2212 : tensor<12x1x1024xf32>
    %2214 = tosa.reshape %2211 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2215 = tosa.reshape %2192 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2216 = tosa.matmul %2213, %2215 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2217 = tosa.reshape %2216 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2218 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2219 = tosa.transpose %2217, %2218 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2220 = tosa.reshape %2219 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2221 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2222 = tosa.transpose %arg224, %2221 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2223 = tosa.reshape %2220 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_580 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2224 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2223, %2222 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_580 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2225 = tosa.reshape %2224 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2226 = tosa.add %2119, %2225 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2227 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_581 = arith.constant 2 : i32
    %2228 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2226 : tensor<1x1x1536xf32>) outs(%2227 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_581 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2229 = tosa.reduce_sum %2228 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2230 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2231 = tosa.reciprocal %2230 : (tensor<1xf32>) -> tensor<1xf32>
    %2232 = tosa.reshape %2231 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2233 = tosa.mul %2232, %2229 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2234 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2235 = tosa.add %2233, %2234 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2236 = tosa.rsqrt %2235 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2237 = tosa.mul %2226, %2236 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2238 = tosa.reshape %arg225 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2239 = tosa.mul %2238, %2237 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2240 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2241 = tosa.transpose %arg226, %2240 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2242 = tosa.reshape %2239 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_582 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2243 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2242, %2241 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_582 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2244 = tosa.reshape %2243 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2245 = tosa.sigmoid %2244 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2246 = tosa.mul %2244, %2245 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2247 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2248 = tosa.transpose %arg227, %2247 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2249 = tosa.reshape %2239 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_583 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2250 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2249, %2248 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_583 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2251 = tosa.reshape %2250 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2252 = tosa.mul %2246, %2251 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2253 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2254 = tosa.transpose %arg228, %2253 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2255 = tosa.reshape %2252 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_584 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2256 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2255, %2254 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_584 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2257 = tosa.reshape %2256 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2258 = tosa.add %2226, %2257 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2259 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_585 = arith.constant 2 : i32
    %2260 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2258 : tensor<1x1x1536xf32>) outs(%2259 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_585 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2261 = tosa.reduce_sum %2260 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2262 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2263 = tosa.reciprocal %2262 : (tensor<1xf32>) -> tensor<1xf32>
    %2264 = tosa.reshape %2263 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2265 = tosa.mul %2264, %2261 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2266 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2267 = tosa.add %2265, %2266 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2268 = tosa.rsqrt %2267 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2269 = tosa.mul %2258, %2268 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2270 = tosa.reshape %arg229 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2271 = tosa.mul %2270, %2269 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2272 = tosa.reshape %2271 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2273 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2274 = tosa.transpose %arg230, %2273 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_586 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2275 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2272, %2274 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_586 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2276 = tosa.reshape %arg231 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2277 = tosa.add %2276, %2275 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2278 = tosa.reshape %2277 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2279 = tosa.reshape %2278 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2280 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2281 = tosa.transpose %2279, %2280 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2282 = tosa.reshape %2271 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2283 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2284 = tosa.transpose %arg232, %2283 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_587 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2285 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2282, %2284 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_587 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2286 = tosa.reshape %arg233 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2287 = tosa.add %2286, %2285 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2288 = tosa.reshape %2287 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2289 = tosa.reshape %2288 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2290 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2291 = tosa.transpose %2289, %2290 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2292 = tosa.reshape %2271 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2293 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2294 = tosa.transpose %arg234, %2293 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_588 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2295 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2292, %2294 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_588 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2296 = tosa.reshape %arg235 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2297 = tosa.add %2296, %2295 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2298 = tosa.reshape %2297 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2299 = tosa.reshape %2298 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2300 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2301 = tosa.transpose %2299, %2300 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2302 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2303 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2304 = tosa.mul %2281, %2302 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_589 = tensor.extract_slice %2281[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_590 = tensor.extract_slice %2281[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2305 = tensor.empty() : tensor<1x12x1x64xf32>
    %2306 = linalg.negf ins(%extracted_slice_590 : tensor<1x12x1x64xf32>) outs(%2305 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2307 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_591 = tensor.insert_slice %2306 into %2307[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_592 = tensor.insert_slice %extracted_slice_589 into %inserted_slice_591[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2308 = tosa.mul %inserted_slice_592, %2303 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2309 = tosa.add %2304, %2308 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2310 = tosa.mul %2291, %2302 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_593 = tensor.extract_slice %2291[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_594 = tensor.extract_slice %2291[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2311 = tensor.empty() : tensor<1x2x1x64xf32>
    %2312 = linalg.negf ins(%extracted_slice_594 : tensor<1x2x1x64xf32>) outs(%2311 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2313 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_595 = tensor.insert_slice %2312 into %2313[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_596 = tensor.insert_slice %extracted_slice_593 into %inserted_slice_595[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2314 = tosa.mul %inserted_slice_596, %2303 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2315 = tosa.add %2310, %2314 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2316 = bufferization.to_memref %arg236 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2317 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2318 = bufferization.to_memref %2315 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_597 = arith.constant 0 : index
    %c1_598 = arith.constant 1 : index
    %c1_599 = arith.constant 1 : index
    %c2_600 = arith.constant 2 : index
    %c1_601 = arith.constant 1 : index
    %c128_602 = arith.constant 128 : index
    scf.for %arg399 = %c0_597 to %c1_599 step %c1_598 {
      scf.for %arg400 = %c0_597 to %c2_600 step %c1_598 {
        scf.for %arg401 = %c0_597 to %c1_601 step %c1_598 {
          %3945 = memref.load %2317[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_597 to %c128_602 step %c1_598 {
            %3947 = memref.load %2318[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2316[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2319 = bufferization.to_tensor %2316 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2320 = bufferization.to_memref %arg237 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2321 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2322 = bufferization.to_memref %2301 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_603 = arith.constant 0 : index
    %c1_604 = arith.constant 1 : index
    %c1_605 = arith.constant 1 : index
    %c2_606 = arith.constant 2 : index
    %c1_607 = arith.constant 1 : index
    %c128_608 = arith.constant 128 : index
    scf.for %arg399 = %c0_603 to %c1_605 step %c1_604 {
      scf.for %arg400 = %c0_603 to %c2_606 step %c1_604 {
        scf.for %arg401 = %c0_603 to %c1_607 step %c1_604 {
          %3945 = memref.load %2321[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_603 to %c128_608 step %c1_604 {
            %3947 = memref.load %2322[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2320[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2323 = bufferization.to_tensor %2320 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2324 = tosa.reshape %2319 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2325 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2326 = tosa.add %2324, %2325 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2327 = tosa.reshape %2326 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2328 = tosa.reshape %2323 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2329 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2330 = tosa.add %2328, %2329 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2331 = tosa.reshape %2330 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2332 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_609 = arith.constant 0xFF800000 : f32
    %cst_610 = arith.constant 0.000000e+00 : f32
    %2333 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_611 = tensor.splat %cst_610 : tensor<1x1x1x1024xf32>
    %splat_612 = tensor.splat %cst_609 : tensor<1x1x1x1024xf32>
    %2334 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2332, %splat_611, %splat_612 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2333 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_613 = arith.constant 0.000000e+00 : f32
    %splat_614 = tensor.splat %cst_613 : tensor<1x1024xf32>
    %2335 = tosa.reshape %2334 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2336 = tosa.add %splat_614, %2335 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2337 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2338 = tosa.transpose %2327, %2337 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2339 = tosa.reshape %2309 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2340 = tosa.reshape %2338 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2341 = tosa.matmul %2339, %2340 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_615 = arith.constant 0.0883883461 : f32
    %splat_616 = tensor.splat %cst_615 : tensor<12x1x1024xf32>
    %2342 = tosa.mul %2341, %splat_616 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2343 = tosa.reshape %2336 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2344 = tosa.add %2342, %2343 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2345 = tosa.reduce_max %2344 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2346 = tosa.sub %2344, %2345 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2347 = math.exp %2346 : tensor<12x1x1024xf32>
    %2348 = tosa.reduce_sum %2347 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2349 = tosa.log %2348 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2350 = tosa.add %2345, %2349 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2351 = tosa.sub %2344, %2350 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2352 = math.exp %2351 : tensor<12x1x1024xf32>
    %2353 = tosa.reshape %2350 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2354 = tosa.reshape %2331 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2355 = tosa.matmul %2352, %2354 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2356 = tosa.reshape %2355 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2357 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2358 = tosa.transpose %2356, %2357 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2359 = tosa.reshape %2358 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2360 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2361 = tosa.transpose %arg238, %2360 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2362 = tosa.reshape %2359 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_617 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2363 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2362, %2361 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_617 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2364 = tosa.reshape %2363 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2365 = tosa.add %2258, %2364 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2366 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_618 = arith.constant 2 : i32
    %2367 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2365 : tensor<1x1x1536xf32>) outs(%2366 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_618 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2368 = tosa.reduce_sum %2367 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2369 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2370 = tosa.reciprocal %2369 : (tensor<1xf32>) -> tensor<1xf32>
    %2371 = tosa.reshape %2370 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2372 = tosa.mul %2371, %2368 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2373 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2374 = tosa.add %2372, %2373 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2375 = tosa.rsqrt %2374 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2376 = tosa.mul %2365, %2375 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2377 = tosa.reshape %arg239 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2378 = tosa.mul %2377, %2376 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2379 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2380 = tosa.transpose %arg240, %2379 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2381 = tosa.reshape %2378 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_619 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2382 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2381, %2380 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_619 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2383 = tosa.reshape %2382 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2384 = tosa.sigmoid %2383 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2385 = tosa.mul %2383, %2384 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2386 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2387 = tosa.transpose %arg241, %2386 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2388 = tosa.reshape %2378 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_620 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2389 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2388, %2387 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_620 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2390 = tosa.reshape %2389 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2391 = tosa.mul %2385, %2390 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2392 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2393 = tosa.transpose %arg242, %2392 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2394 = tosa.reshape %2391 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_621 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2395 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2394, %2393 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_621 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2396 = tosa.reshape %2395 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2397 = tosa.add %2365, %2396 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2398 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_622 = arith.constant 2 : i32
    %2399 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2397 : tensor<1x1x1536xf32>) outs(%2398 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_622 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2400 = tosa.reduce_sum %2399 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2401 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2402 = tosa.reciprocal %2401 : (tensor<1xf32>) -> tensor<1xf32>
    %2403 = tosa.reshape %2402 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2404 = tosa.mul %2403, %2400 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2405 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2406 = tosa.add %2404, %2405 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2407 = tosa.rsqrt %2406 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2408 = tosa.mul %2397, %2407 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2409 = tosa.reshape %arg243 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2410 = tosa.mul %2409, %2408 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2411 = tosa.reshape %2410 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2412 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2413 = tosa.transpose %arg244, %2412 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_623 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2414 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2411, %2413 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_623 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2415 = tosa.reshape %arg245 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2416 = tosa.add %2415, %2414 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2417 = tosa.reshape %2416 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2418 = tosa.reshape %2417 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2419 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2420 = tosa.transpose %2418, %2419 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2421 = tosa.reshape %2410 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2422 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2423 = tosa.transpose %arg246, %2422 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_624 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2424 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2421, %2423 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_624 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2425 = tosa.reshape %arg247 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2426 = tosa.add %2425, %2424 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2427 = tosa.reshape %2426 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2428 = tosa.reshape %2427 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2429 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2430 = tosa.transpose %2428, %2429 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2431 = tosa.reshape %2410 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2432 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2433 = tosa.transpose %arg248, %2432 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_625 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2434 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2431, %2433 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_625 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2435 = tosa.reshape %arg249 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2436 = tosa.add %2435, %2434 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2437 = tosa.reshape %2436 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2438 = tosa.reshape %2437 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2439 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2440 = tosa.transpose %2438, %2439 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2441 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2442 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2443 = tosa.mul %2420, %2441 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_626 = tensor.extract_slice %2420[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_627 = tensor.extract_slice %2420[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2444 = tensor.empty() : tensor<1x12x1x64xf32>
    %2445 = linalg.negf ins(%extracted_slice_627 : tensor<1x12x1x64xf32>) outs(%2444 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2446 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_628 = tensor.insert_slice %2445 into %2446[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_629 = tensor.insert_slice %extracted_slice_626 into %inserted_slice_628[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2447 = tosa.mul %inserted_slice_629, %2442 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2448 = tosa.add %2443, %2447 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2449 = tosa.mul %2430, %2441 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_630 = tensor.extract_slice %2430[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_631 = tensor.extract_slice %2430[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2450 = tensor.empty() : tensor<1x2x1x64xf32>
    %2451 = linalg.negf ins(%extracted_slice_631 : tensor<1x2x1x64xf32>) outs(%2450 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2452 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_632 = tensor.insert_slice %2451 into %2452[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_633 = tensor.insert_slice %extracted_slice_630 into %inserted_slice_632[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2453 = tosa.mul %inserted_slice_633, %2442 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2454 = tosa.add %2449, %2453 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2455 = bufferization.to_memref %arg250 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2456 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2457 = bufferization.to_memref %2454 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_634 = arith.constant 0 : index
    %c1_635 = arith.constant 1 : index
    %c1_636 = arith.constant 1 : index
    %c2_637 = arith.constant 2 : index
    %c1_638 = arith.constant 1 : index
    %c128_639 = arith.constant 128 : index
    scf.for %arg399 = %c0_634 to %c1_636 step %c1_635 {
      scf.for %arg400 = %c0_634 to %c2_637 step %c1_635 {
        scf.for %arg401 = %c0_634 to %c1_638 step %c1_635 {
          %3945 = memref.load %2456[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_634 to %c128_639 step %c1_635 {
            %3947 = memref.load %2457[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2455[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2458 = bufferization.to_tensor %2455 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2459 = bufferization.to_memref %arg251 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2460 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2461 = bufferization.to_memref %2440 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_640 = arith.constant 0 : index
    %c1_641 = arith.constant 1 : index
    %c1_642 = arith.constant 1 : index
    %c2_643 = arith.constant 2 : index
    %c1_644 = arith.constant 1 : index
    %c128_645 = arith.constant 128 : index
    scf.for %arg399 = %c0_640 to %c1_642 step %c1_641 {
      scf.for %arg400 = %c0_640 to %c2_643 step %c1_641 {
        scf.for %arg401 = %c0_640 to %c1_644 step %c1_641 {
          %3945 = memref.load %2460[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_640 to %c128_645 step %c1_641 {
            %3947 = memref.load %2461[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2459[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2462 = bufferization.to_tensor %2459 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2463 = tosa.reshape %2458 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2464 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2465 = tosa.add %2463, %2464 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2466 = tosa.reshape %2465 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2467 = tosa.reshape %2462 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2468 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2469 = tosa.add %2467, %2468 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2470 = tosa.reshape %2469 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2471 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_646 = arith.constant 0xFF800000 : f32
    %cst_647 = arith.constant 0.000000e+00 : f32
    %2472 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_648 = tensor.splat %cst_647 : tensor<1x1x1x1024xf32>
    %splat_649 = tensor.splat %cst_646 : tensor<1x1x1x1024xf32>
    %2473 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2471, %splat_648, %splat_649 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2472 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_650 = arith.constant 0.000000e+00 : f32
    %splat_651 = tensor.splat %cst_650 : tensor<1x1024xf32>
    %2474 = tosa.reshape %2473 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2475 = tosa.add %splat_651, %2474 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2476 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2477 = tosa.transpose %2466, %2476 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2478 = tosa.reshape %2448 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2479 = tosa.reshape %2477 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2480 = tosa.matmul %2478, %2479 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_652 = arith.constant 0.0883883461 : f32
    %splat_653 = tensor.splat %cst_652 : tensor<12x1x1024xf32>
    %2481 = tosa.mul %2480, %splat_653 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2482 = tosa.reshape %2475 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2483 = tosa.add %2481, %2482 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2484 = tosa.reduce_max %2483 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2485 = tosa.sub %2483, %2484 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2486 = math.exp %2485 : tensor<12x1x1024xf32>
    %2487 = tosa.reduce_sum %2486 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2488 = tosa.log %2487 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2489 = tosa.add %2484, %2488 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2490 = tosa.sub %2483, %2489 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2491 = math.exp %2490 : tensor<12x1x1024xf32>
    %2492 = tosa.reshape %2489 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2493 = tosa.reshape %2470 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2494 = tosa.matmul %2491, %2493 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2495 = tosa.reshape %2494 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2496 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2497 = tosa.transpose %2495, %2496 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2498 = tosa.reshape %2497 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2499 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2500 = tosa.transpose %arg252, %2499 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2501 = tosa.reshape %2498 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_654 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2502 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2501, %2500 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_654 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2503 = tosa.reshape %2502 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2504 = tosa.add %2397, %2503 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2505 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_655 = arith.constant 2 : i32
    %2506 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2504 : tensor<1x1x1536xf32>) outs(%2505 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_655 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2507 = tosa.reduce_sum %2506 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2508 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2509 = tosa.reciprocal %2508 : (tensor<1xf32>) -> tensor<1xf32>
    %2510 = tosa.reshape %2509 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2511 = tosa.mul %2510, %2507 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2512 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2513 = tosa.add %2511, %2512 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2514 = tosa.rsqrt %2513 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2515 = tosa.mul %2504, %2514 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2516 = tosa.reshape %arg253 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2517 = tosa.mul %2516, %2515 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2518 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2519 = tosa.transpose %arg254, %2518 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2520 = tosa.reshape %2517 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_656 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2521 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2520, %2519 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_656 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2522 = tosa.reshape %2521 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2523 = tosa.sigmoid %2522 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2524 = tosa.mul %2522, %2523 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2525 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2526 = tosa.transpose %arg255, %2525 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2527 = tosa.reshape %2517 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_657 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2528 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2527, %2526 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_657 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2529 = tosa.reshape %2528 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2530 = tosa.mul %2524, %2529 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2531 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2532 = tosa.transpose %arg256, %2531 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2533 = tosa.reshape %2530 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_658 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2534 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2533, %2532 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_658 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2535 = tosa.reshape %2534 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2536 = tosa.add %2504, %2535 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2537 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_659 = arith.constant 2 : i32
    %2538 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2536 : tensor<1x1x1536xf32>) outs(%2537 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_659 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2539 = tosa.reduce_sum %2538 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2540 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2541 = tosa.reciprocal %2540 : (tensor<1xf32>) -> tensor<1xf32>
    %2542 = tosa.reshape %2541 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2543 = tosa.mul %2542, %2539 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2544 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2545 = tosa.add %2543, %2544 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2546 = tosa.rsqrt %2545 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2547 = tosa.mul %2536, %2546 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2548 = tosa.reshape %arg257 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2549 = tosa.mul %2548, %2547 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2550 = tosa.reshape %2549 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2551 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2552 = tosa.transpose %arg258, %2551 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_660 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2553 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2550, %2552 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_660 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2554 = tosa.reshape %arg259 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2555 = tosa.add %2554, %2553 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2556 = tosa.reshape %2555 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2557 = tosa.reshape %2556 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2558 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2559 = tosa.transpose %2557, %2558 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2560 = tosa.reshape %2549 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2561 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2562 = tosa.transpose %arg260, %2561 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_661 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2563 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2560, %2562 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_661 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2564 = tosa.reshape %arg261 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2565 = tosa.add %2564, %2563 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2566 = tosa.reshape %2565 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2567 = tosa.reshape %2566 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2568 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2569 = tosa.transpose %2567, %2568 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2570 = tosa.reshape %2549 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2571 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2572 = tosa.transpose %arg262, %2571 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_662 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2573 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2570, %2572 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_662 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2574 = tosa.reshape %arg263 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2575 = tosa.add %2574, %2573 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2576 = tosa.reshape %2575 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2577 = tosa.reshape %2576 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2578 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2579 = tosa.transpose %2577, %2578 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2580 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2581 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2582 = tosa.mul %2559, %2580 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_663 = tensor.extract_slice %2559[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_664 = tensor.extract_slice %2559[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2583 = tensor.empty() : tensor<1x12x1x64xf32>
    %2584 = linalg.negf ins(%extracted_slice_664 : tensor<1x12x1x64xf32>) outs(%2583 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2585 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_665 = tensor.insert_slice %2584 into %2585[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_666 = tensor.insert_slice %extracted_slice_663 into %inserted_slice_665[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2586 = tosa.mul %inserted_slice_666, %2581 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2587 = tosa.add %2582, %2586 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2588 = tosa.mul %2569, %2580 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_667 = tensor.extract_slice %2569[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_668 = tensor.extract_slice %2569[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2589 = tensor.empty() : tensor<1x2x1x64xf32>
    %2590 = linalg.negf ins(%extracted_slice_668 : tensor<1x2x1x64xf32>) outs(%2589 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2591 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_669 = tensor.insert_slice %2590 into %2591[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_670 = tensor.insert_slice %extracted_slice_667 into %inserted_slice_669[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2592 = tosa.mul %inserted_slice_670, %2581 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2593 = tosa.add %2588, %2592 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2594 = bufferization.to_memref %arg264 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2595 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2596 = bufferization.to_memref %2593 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_671 = arith.constant 0 : index
    %c1_672 = arith.constant 1 : index
    %c1_673 = arith.constant 1 : index
    %c2_674 = arith.constant 2 : index
    %c1_675 = arith.constant 1 : index
    %c128_676 = arith.constant 128 : index
    scf.for %arg399 = %c0_671 to %c1_673 step %c1_672 {
      scf.for %arg400 = %c0_671 to %c2_674 step %c1_672 {
        scf.for %arg401 = %c0_671 to %c1_675 step %c1_672 {
          %3945 = memref.load %2595[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_671 to %c128_676 step %c1_672 {
            %3947 = memref.load %2596[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2594[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2597 = bufferization.to_tensor %2594 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2598 = bufferization.to_memref %arg265 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2599 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2600 = bufferization.to_memref %2579 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_677 = arith.constant 0 : index
    %c1_678 = arith.constant 1 : index
    %c1_679 = arith.constant 1 : index
    %c2_680 = arith.constant 2 : index
    %c1_681 = arith.constant 1 : index
    %c128_682 = arith.constant 128 : index
    scf.for %arg399 = %c0_677 to %c1_679 step %c1_678 {
      scf.for %arg400 = %c0_677 to %c2_680 step %c1_678 {
        scf.for %arg401 = %c0_677 to %c1_681 step %c1_678 {
          %3945 = memref.load %2599[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_677 to %c128_682 step %c1_678 {
            %3947 = memref.load %2600[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2598[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2601 = bufferization.to_tensor %2598 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2602 = tosa.reshape %2597 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2603 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2604 = tosa.add %2602, %2603 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2605 = tosa.reshape %2604 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2606 = tosa.reshape %2601 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2607 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2608 = tosa.add %2606, %2607 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2609 = tosa.reshape %2608 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2610 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_683 = arith.constant 0xFF800000 : f32
    %cst_684 = arith.constant 0.000000e+00 : f32
    %2611 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_685 = tensor.splat %cst_684 : tensor<1x1x1x1024xf32>
    %splat_686 = tensor.splat %cst_683 : tensor<1x1x1x1024xf32>
    %2612 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2610, %splat_685, %splat_686 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2611 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_687 = arith.constant 0.000000e+00 : f32
    %splat_688 = tensor.splat %cst_687 : tensor<1x1024xf32>
    %2613 = tosa.reshape %2612 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2614 = tosa.add %splat_688, %2613 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2615 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2616 = tosa.transpose %2605, %2615 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2617 = tosa.reshape %2587 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2618 = tosa.reshape %2616 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2619 = tosa.matmul %2617, %2618 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_689 = arith.constant 0.0883883461 : f32
    %splat_690 = tensor.splat %cst_689 : tensor<12x1x1024xf32>
    %2620 = tosa.mul %2619, %splat_690 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2621 = tosa.reshape %2614 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2622 = tosa.add %2620, %2621 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2623 = tosa.reduce_max %2622 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2624 = tosa.sub %2622, %2623 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2625 = math.exp %2624 : tensor<12x1x1024xf32>
    %2626 = tosa.reduce_sum %2625 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2627 = tosa.log %2626 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2628 = tosa.add %2623, %2627 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2629 = tosa.sub %2622, %2628 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2630 = math.exp %2629 : tensor<12x1x1024xf32>
    %2631 = tosa.reshape %2628 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2632 = tosa.reshape %2609 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2633 = tosa.matmul %2630, %2632 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2634 = tosa.reshape %2633 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2635 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2636 = tosa.transpose %2634, %2635 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2637 = tosa.reshape %2636 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2638 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2639 = tosa.transpose %arg266, %2638 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2640 = tosa.reshape %2637 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_691 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2641 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2640, %2639 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_691 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2642 = tosa.reshape %2641 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2643 = tosa.add %2536, %2642 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2644 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_692 = arith.constant 2 : i32
    %2645 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2643 : tensor<1x1x1536xf32>) outs(%2644 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_692 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2646 = tosa.reduce_sum %2645 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2647 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2648 = tosa.reciprocal %2647 : (tensor<1xf32>) -> tensor<1xf32>
    %2649 = tosa.reshape %2648 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2650 = tosa.mul %2649, %2646 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2651 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2652 = tosa.add %2650, %2651 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2653 = tosa.rsqrt %2652 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2654 = tosa.mul %2643, %2653 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2655 = tosa.reshape %arg267 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2656 = tosa.mul %2655, %2654 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2657 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2658 = tosa.transpose %arg268, %2657 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2659 = tosa.reshape %2656 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_693 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2660 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2659, %2658 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_693 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2661 = tosa.reshape %2660 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2662 = tosa.sigmoid %2661 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2663 = tosa.mul %2661, %2662 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2664 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2665 = tosa.transpose %arg269, %2664 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2666 = tosa.reshape %2656 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_694 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2667 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2666, %2665 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_694 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2668 = tosa.reshape %2667 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2669 = tosa.mul %2663, %2668 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2670 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2671 = tosa.transpose %arg270, %2670 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2672 = tosa.reshape %2669 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_695 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2673 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2672, %2671 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_695 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2674 = tosa.reshape %2673 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2675 = tosa.add %2643, %2674 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2676 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_696 = arith.constant 2 : i32
    %2677 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2675 : tensor<1x1x1536xf32>) outs(%2676 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_696 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2678 = tosa.reduce_sum %2677 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2679 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2680 = tosa.reciprocal %2679 : (tensor<1xf32>) -> tensor<1xf32>
    %2681 = tosa.reshape %2680 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2682 = tosa.mul %2681, %2678 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2683 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2684 = tosa.add %2682, %2683 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2685 = tosa.rsqrt %2684 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2686 = tosa.mul %2675, %2685 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2687 = tosa.reshape %arg271 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2688 = tosa.mul %2687, %2686 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2689 = tosa.reshape %2688 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2690 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2691 = tosa.transpose %arg272, %2690 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_697 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2692 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2689, %2691 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_697 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2693 = tosa.reshape %arg273 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2694 = tosa.add %2693, %2692 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2695 = tosa.reshape %2694 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2696 = tosa.reshape %2695 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2697 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2698 = tosa.transpose %2696, %2697 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2699 = tosa.reshape %2688 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2700 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2701 = tosa.transpose %arg274, %2700 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_698 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2702 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2699, %2701 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_698 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2703 = tosa.reshape %arg275 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2704 = tosa.add %2703, %2702 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2705 = tosa.reshape %2704 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2706 = tosa.reshape %2705 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2707 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2708 = tosa.transpose %2706, %2707 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2709 = tosa.reshape %2688 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2710 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2711 = tosa.transpose %arg276, %2710 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_699 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2712 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2709, %2711 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_699 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2713 = tosa.reshape %arg277 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2714 = tosa.add %2713, %2712 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2715 = tosa.reshape %2714 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2716 = tosa.reshape %2715 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2717 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2718 = tosa.transpose %2716, %2717 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2719 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2720 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2721 = tosa.mul %2698, %2719 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_700 = tensor.extract_slice %2698[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_701 = tensor.extract_slice %2698[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2722 = tensor.empty() : tensor<1x12x1x64xf32>
    %2723 = linalg.negf ins(%extracted_slice_701 : tensor<1x12x1x64xf32>) outs(%2722 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2724 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_702 = tensor.insert_slice %2723 into %2724[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_703 = tensor.insert_slice %extracted_slice_700 into %inserted_slice_702[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2725 = tosa.mul %inserted_slice_703, %2720 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2726 = tosa.add %2721, %2725 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2727 = tosa.mul %2708, %2719 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_704 = tensor.extract_slice %2708[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_705 = tensor.extract_slice %2708[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2728 = tensor.empty() : tensor<1x2x1x64xf32>
    %2729 = linalg.negf ins(%extracted_slice_705 : tensor<1x2x1x64xf32>) outs(%2728 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2730 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_706 = tensor.insert_slice %2729 into %2730[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_707 = tensor.insert_slice %extracted_slice_704 into %inserted_slice_706[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2731 = tosa.mul %inserted_slice_707, %2720 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2732 = tosa.add %2727, %2731 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2733 = bufferization.to_memref %arg278 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2734 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2735 = bufferization.to_memref %2732 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_708 = arith.constant 0 : index
    %c1_709 = arith.constant 1 : index
    %c1_710 = arith.constant 1 : index
    %c2_711 = arith.constant 2 : index
    %c1_712 = arith.constant 1 : index
    %c128_713 = arith.constant 128 : index
    scf.for %arg399 = %c0_708 to %c1_710 step %c1_709 {
      scf.for %arg400 = %c0_708 to %c2_711 step %c1_709 {
        scf.for %arg401 = %c0_708 to %c1_712 step %c1_709 {
          %3945 = memref.load %2734[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_708 to %c128_713 step %c1_709 {
            %3947 = memref.load %2735[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2733[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2736 = bufferization.to_tensor %2733 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2737 = bufferization.to_memref %arg279 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2738 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2739 = bufferization.to_memref %2718 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_714 = arith.constant 0 : index
    %c1_715 = arith.constant 1 : index
    %c1_716 = arith.constant 1 : index
    %c2_717 = arith.constant 2 : index
    %c1_718 = arith.constant 1 : index
    %c128_719 = arith.constant 128 : index
    scf.for %arg399 = %c0_714 to %c1_716 step %c1_715 {
      scf.for %arg400 = %c0_714 to %c2_717 step %c1_715 {
        scf.for %arg401 = %c0_714 to %c1_718 step %c1_715 {
          %3945 = memref.load %2738[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_714 to %c128_719 step %c1_715 {
            %3947 = memref.load %2739[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2737[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2740 = bufferization.to_tensor %2737 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2741 = tosa.reshape %2736 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2742 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2743 = tosa.add %2741, %2742 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2744 = tosa.reshape %2743 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2745 = tosa.reshape %2740 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2746 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2747 = tosa.add %2745, %2746 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2748 = tosa.reshape %2747 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2749 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_720 = arith.constant 0xFF800000 : f32
    %cst_721 = arith.constant 0.000000e+00 : f32
    %2750 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_722 = tensor.splat %cst_721 : tensor<1x1x1x1024xf32>
    %splat_723 = tensor.splat %cst_720 : tensor<1x1x1x1024xf32>
    %2751 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2749, %splat_722, %splat_723 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2750 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_724 = arith.constant 0.000000e+00 : f32
    %splat_725 = tensor.splat %cst_724 : tensor<1x1024xf32>
    %2752 = tosa.reshape %2751 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2753 = tosa.add %splat_725, %2752 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2754 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2755 = tosa.transpose %2744, %2754 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2756 = tosa.reshape %2726 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2757 = tosa.reshape %2755 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2758 = tosa.matmul %2756, %2757 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_726 = arith.constant 0.0883883461 : f32
    %splat_727 = tensor.splat %cst_726 : tensor<12x1x1024xf32>
    %2759 = tosa.mul %2758, %splat_727 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2760 = tosa.reshape %2753 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2761 = tosa.add %2759, %2760 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2762 = tosa.reduce_max %2761 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2763 = tosa.sub %2761, %2762 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2764 = math.exp %2763 : tensor<12x1x1024xf32>
    %2765 = tosa.reduce_sum %2764 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2766 = tosa.log %2765 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2767 = tosa.add %2762, %2766 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2768 = tosa.sub %2761, %2767 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2769 = math.exp %2768 : tensor<12x1x1024xf32>
    %2770 = tosa.reshape %2767 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2771 = tosa.reshape %2748 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2772 = tosa.matmul %2769, %2771 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2773 = tosa.reshape %2772 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2774 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2775 = tosa.transpose %2773, %2774 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2776 = tosa.reshape %2775 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2777 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2778 = tosa.transpose %arg280, %2777 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2779 = tosa.reshape %2776 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_728 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2780 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2779, %2778 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_728 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2781 = tosa.reshape %2780 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2782 = tosa.add %2675, %2781 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2783 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_729 = arith.constant 2 : i32
    %2784 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2782 : tensor<1x1x1536xf32>) outs(%2783 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_729 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2785 = tosa.reduce_sum %2784 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2786 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2787 = tosa.reciprocal %2786 : (tensor<1xf32>) -> tensor<1xf32>
    %2788 = tosa.reshape %2787 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2789 = tosa.mul %2788, %2785 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2790 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2791 = tosa.add %2789, %2790 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2792 = tosa.rsqrt %2791 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2793 = tosa.mul %2782, %2792 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2794 = tosa.reshape %arg281 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2795 = tosa.mul %2794, %2793 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2796 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2797 = tosa.transpose %arg282, %2796 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2798 = tosa.reshape %2795 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_730 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2799 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2798, %2797 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_730 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2800 = tosa.reshape %2799 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2801 = tosa.sigmoid %2800 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2802 = tosa.mul %2800, %2801 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2803 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2804 = tosa.transpose %arg283, %2803 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2805 = tosa.reshape %2795 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_731 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2806 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2805, %2804 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_731 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2807 = tosa.reshape %2806 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2808 = tosa.mul %2802, %2807 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2809 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2810 = tosa.transpose %arg284, %2809 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2811 = tosa.reshape %2808 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_732 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2812 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2811, %2810 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_732 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2813 = tosa.reshape %2812 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2814 = tosa.add %2782, %2813 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2815 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_733 = arith.constant 2 : i32
    %2816 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2814 : tensor<1x1x1536xf32>) outs(%2815 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_733 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2817 = tosa.reduce_sum %2816 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2818 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2819 = tosa.reciprocal %2818 : (tensor<1xf32>) -> tensor<1xf32>
    %2820 = tosa.reshape %2819 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2821 = tosa.mul %2820, %2817 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2822 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2823 = tosa.add %2821, %2822 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2824 = tosa.rsqrt %2823 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2825 = tosa.mul %2814, %2824 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2826 = tosa.reshape %arg285 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2827 = tosa.mul %2826, %2825 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2828 = tosa.reshape %2827 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2829 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2830 = tosa.transpose %arg286, %2829 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_734 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2831 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2828, %2830 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_734 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2832 = tosa.reshape %arg287 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2833 = tosa.add %2832, %2831 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2834 = tosa.reshape %2833 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2835 = tosa.reshape %2834 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2836 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2837 = tosa.transpose %2835, %2836 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2838 = tosa.reshape %2827 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2839 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2840 = tosa.transpose %arg288, %2839 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_735 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2841 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2838, %2840 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_735 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2842 = tosa.reshape %arg289 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2843 = tosa.add %2842, %2841 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2844 = tosa.reshape %2843 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2845 = tosa.reshape %2844 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2846 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2847 = tosa.transpose %2845, %2846 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2848 = tosa.reshape %2827 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2849 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2850 = tosa.transpose %arg290, %2849 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_736 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2851 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2848, %2850 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_736 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2852 = tosa.reshape %arg291 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2853 = tosa.add %2852, %2851 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2854 = tosa.reshape %2853 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2855 = tosa.reshape %2854 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2856 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2857 = tosa.transpose %2855, %2856 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2858 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2859 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2860 = tosa.mul %2837, %2858 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_737 = tensor.extract_slice %2837[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_738 = tensor.extract_slice %2837[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2861 = tensor.empty() : tensor<1x12x1x64xf32>
    %2862 = linalg.negf ins(%extracted_slice_738 : tensor<1x12x1x64xf32>) outs(%2861 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %2863 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_739 = tensor.insert_slice %2862 into %2863[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_740 = tensor.insert_slice %extracted_slice_737 into %inserted_slice_739[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2864 = tosa.mul %inserted_slice_740, %2859 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2865 = tosa.add %2860, %2864 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2866 = tosa.mul %2847, %2858 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_741 = tensor.extract_slice %2847[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_742 = tensor.extract_slice %2847[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2867 = tensor.empty() : tensor<1x2x1x64xf32>
    %2868 = linalg.negf ins(%extracted_slice_742 : tensor<1x2x1x64xf32>) outs(%2867 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %2869 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_743 = tensor.insert_slice %2868 into %2869[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_744 = tensor.insert_slice %extracted_slice_741 into %inserted_slice_743[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2870 = tosa.mul %inserted_slice_744, %2859 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2871 = tosa.add %2866, %2870 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2872 = bufferization.to_memref %arg292 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2873 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2874 = bufferization.to_memref %2871 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_745 = arith.constant 0 : index
    %c1_746 = arith.constant 1 : index
    %c1_747 = arith.constant 1 : index
    %c2_748 = arith.constant 2 : index
    %c1_749 = arith.constant 1 : index
    %c128_750 = arith.constant 128 : index
    scf.for %arg399 = %c0_745 to %c1_747 step %c1_746 {
      scf.for %arg400 = %c0_745 to %c2_748 step %c1_746 {
        scf.for %arg401 = %c0_745 to %c1_749 step %c1_746 {
          %3945 = memref.load %2873[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_745 to %c128_750 step %c1_746 {
            %3947 = memref.load %2874[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2872[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2875 = bufferization.to_tensor %2872 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2876 = bufferization.to_memref %arg293 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2877 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %2878 = bufferization.to_memref %2857 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_751 = arith.constant 0 : index
    %c1_752 = arith.constant 1 : index
    %c1_753 = arith.constant 1 : index
    %c2_754 = arith.constant 2 : index
    %c1_755 = arith.constant 1 : index
    %c128_756 = arith.constant 128 : index
    scf.for %arg399 = %c0_751 to %c1_753 step %c1_752 {
      scf.for %arg400 = %c0_751 to %c2_754 step %c1_752 {
        scf.for %arg401 = %c0_751 to %c1_755 step %c1_752 {
          %3945 = memref.load %2877[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_751 to %c128_756 step %c1_752 {
            %3947 = memref.load %2878[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %2876[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2879 = bufferization.to_tensor %2876 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2880 = tosa.reshape %2875 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2881 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2882 = tosa.add %2880, %2881 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2883 = tosa.reshape %2882 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2884 = tosa.reshape %2879 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %2885 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %2886 = tosa.add %2884, %2885 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %2887 = tosa.reshape %2886 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %2888 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_757 = arith.constant 0xFF800000 : f32
    %cst_758 = arith.constant 0.000000e+00 : f32
    %2889 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_759 = tensor.splat %cst_758 : tensor<1x1x1x1024xf32>
    %splat_760 = tensor.splat %cst_757 : tensor<1x1x1x1024xf32>
    %2890 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2888, %splat_759, %splat_760 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2889 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_761 = arith.constant 0.000000e+00 : f32
    %splat_762 = tensor.splat %cst_761 : tensor<1x1024xf32>
    %2891 = tosa.reshape %2890 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %2892 = tosa.add %splat_762, %2891 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %2893 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2894 = tosa.transpose %2883, %2893 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %2895 = tosa.reshape %2865 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %2896 = tosa.reshape %2894 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %2897 = tosa.matmul %2895, %2896 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_763 = arith.constant 0.0883883461 : f32
    %splat_764 = tensor.splat %cst_763 : tensor<12x1x1024xf32>
    %2898 = tosa.mul %2897, %splat_764 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2899 = tosa.reshape %2892 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %2900 = tosa.add %2898, %2899 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %2901 = tosa.reduce_max %2900 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2902 = tosa.sub %2900, %2901 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2903 = math.exp %2902 : tensor<12x1x1024xf32>
    %2904 = tosa.reduce_sum %2903 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %2905 = tosa.log %2904 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2906 = tosa.add %2901, %2905 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %2907 = tosa.sub %2900, %2906 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %2908 = math.exp %2907 : tensor<12x1x1024xf32>
    %2909 = tosa.reshape %2906 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %2910 = tosa.reshape %2887 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %2911 = tosa.matmul %2908, %2910 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %2912 = tosa.reshape %2911 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2913 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2914 = tosa.transpose %2912, %2913 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %2915 = tosa.reshape %2914 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %2916 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2917 = tosa.transpose %arg294, %2916 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %2918 = tosa.reshape %2915 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_765 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2919 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2918, %2917 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_765 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2920 = tosa.reshape %2919 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2921 = tosa.add %2814, %2920 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2922 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_766 = arith.constant 2 : i32
    %2923 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2921 : tensor<1x1x1536xf32>) outs(%2922 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_766 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2924 = tosa.reduce_sum %2923 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2925 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2926 = tosa.reciprocal %2925 : (tensor<1xf32>) -> tensor<1xf32>
    %2927 = tosa.reshape %2926 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2928 = tosa.mul %2927, %2924 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2929 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2930 = tosa.add %2928, %2929 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2931 = tosa.rsqrt %2930 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2932 = tosa.mul %2921, %2931 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2933 = tosa.reshape %arg295 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2934 = tosa.mul %2933, %2932 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2935 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2936 = tosa.transpose %arg296, %2935 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2937 = tosa.reshape %2934 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_767 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2938 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2937, %2936 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_767 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2939 = tosa.reshape %2938 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2940 = tosa.sigmoid %2939 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2941 = tosa.mul %2939, %2940 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2942 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2943 = tosa.transpose %arg297, %2942 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %2944 = tosa.reshape %2934 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_768 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %2945 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2944, %2943 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_768 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2946 = tosa.reshape %2945 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %2947 = tosa.mul %2941, %2946 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2948 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2949 = tosa.transpose %arg298, %2948 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %2950 = tosa.reshape %2947 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_769 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2951 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2950, %2949 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_769 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2952 = tosa.reshape %2951 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2953 = tosa.add %2921, %2952 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2954 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_770 = arith.constant 2 : i32
    %2955 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2953 : tensor<1x1x1536xf32>) outs(%2954 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_770 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %2956 = tosa.reduce_sum %2955 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2957 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %2958 = tosa.reciprocal %2957 : (tensor<1xf32>) -> tensor<1xf32>
    %2959 = tosa.reshape %2958 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %2960 = tosa.mul %2959, %2956 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2961 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %2962 = tosa.add %2960, %2961 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2963 = tosa.rsqrt %2962 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2964 = tosa.mul %2953, %2963 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %2965 = tosa.reshape %arg299 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %2966 = tosa.mul %2965, %2964 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2967 = tosa.reshape %2966 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2968 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2969 = tosa.transpose %arg300, %2968 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_771 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %2970 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2967, %2969 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_771 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2971 = tosa.reshape %arg301 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %2972 = tosa.add %2971, %2970 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2973 = tosa.reshape %2972 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %2974 = tosa.reshape %2973 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %2975 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2976 = tosa.transpose %2974, %2975 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %2977 = tosa.reshape %2966 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2978 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2979 = tosa.transpose %arg302, %2978 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_772 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2980 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2977, %2979 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_772 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2981 = tosa.reshape %arg303 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2982 = tosa.add %2981, %2980 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2983 = tosa.reshape %2982 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2984 = tosa.reshape %2983 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2985 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2986 = tosa.transpose %2984, %2985 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2987 = tosa.reshape %2966 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %2988 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %2989 = tosa.transpose %arg304, %2988 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_773 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %2990 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2987, %2989 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_773 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2991 = tosa.reshape %arg305 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %2992 = tosa.add %2991, %2990 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2993 = tosa.reshape %2992 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %2994 = tosa.reshape %2993 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %2995 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %2996 = tosa.transpose %2994, %2995 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %2997 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2998 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %2999 = tosa.mul %2976, %2997 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_774 = tensor.extract_slice %2976[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_775 = tensor.extract_slice %2976[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3000 = tensor.empty() : tensor<1x12x1x64xf32>
    %3001 = linalg.negf ins(%extracted_slice_775 : tensor<1x12x1x64xf32>) outs(%3000 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3002 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_776 = tensor.insert_slice %3001 into %3002[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_777 = tensor.insert_slice %extracted_slice_774 into %inserted_slice_776[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3003 = tosa.mul %inserted_slice_777, %2998 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3004 = tosa.add %2999, %3003 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3005 = tosa.mul %2986, %2997 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_778 = tensor.extract_slice %2986[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_779 = tensor.extract_slice %2986[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3006 = tensor.empty() : tensor<1x2x1x64xf32>
    %3007 = linalg.negf ins(%extracted_slice_779 : tensor<1x2x1x64xf32>) outs(%3006 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3008 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_780 = tensor.insert_slice %3007 into %3008[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_781 = tensor.insert_slice %extracted_slice_778 into %inserted_slice_780[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3009 = tosa.mul %inserted_slice_781, %2998 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3010 = tosa.add %3005, %3009 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3011 = bufferization.to_memref %arg306 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3012 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3013 = bufferization.to_memref %3010 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_782 = arith.constant 0 : index
    %c1_783 = arith.constant 1 : index
    %c1_784 = arith.constant 1 : index
    %c2_785 = arith.constant 2 : index
    %c1_786 = arith.constant 1 : index
    %c128_787 = arith.constant 128 : index
    scf.for %arg399 = %c0_782 to %c1_784 step %c1_783 {
      scf.for %arg400 = %c0_782 to %c2_785 step %c1_783 {
        scf.for %arg401 = %c0_782 to %c1_786 step %c1_783 {
          %3945 = memref.load %3012[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_782 to %c128_787 step %c1_783 {
            %3947 = memref.load %3013[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3011[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3014 = bufferization.to_tensor %3011 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3015 = bufferization.to_memref %arg307 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3016 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3017 = bufferization.to_memref %2996 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_788 = arith.constant 0 : index
    %c1_789 = arith.constant 1 : index
    %c1_790 = arith.constant 1 : index
    %c2_791 = arith.constant 2 : index
    %c1_792 = arith.constant 1 : index
    %c128_793 = arith.constant 128 : index
    scf.for %arg399 = %c0_788 to %c1_790 step %c1_789 {
      scf.for %arg400 = %c0_788 to %c2_791 step %c1_789 {
        scf.for %arg401 = %c0_788 to %c1_792 step %c1_789 {
          %3945 = memref.load %3016[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_788 to %c128_793 step %c1_789 {
            %3947 = memref.load %3017[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3015[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3018 = bufferization.to_tensor %3015 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3019 = tosa.reshape %3014 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3020 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3021 = tosa.add %3019, %3020 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3022 = tosa.reshape %3021 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3023 = tosa.reshape %3018 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3024 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3025 = tosa.add %3023, %3024 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3026 = tosa.reshape %3025 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3027 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_794 = arith.constant 0xFF800000 : f32
    %cst_795 = arith.constant 0.000000e+00 : f32
    %3028 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_796 = tensor.splat %cst_795 : tensor<1x1x1x1024xf32>
    %splat_797 = tensor.splat %cst_794 : tensor<1x1x1x1024xf32>
    %3029 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3027, %splat_796, %splat_797 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3028 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_798 = arith.constant 0.000000e+00 : f32
    %splat_799 = tensor.splat %cst_798 : tensor<1x1024xf32>
    %3030 = tosa.reshape %3029 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3031 = tosa.add %splat_799, %3030 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3032 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3033 = tosa.transpose %3022, %3032 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3034 = tosa.reshape %3004 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3035 = tosa.reshape %3033 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3036 = tosa.matmul %3034, %3035 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_800 = arith.constant 0.0883883461 : f32
    %splat_801 = tensor.splat %cst_800 : tensor<12x1x1024xf32>
    %3037 = tosa.mul %3036, %splat_801 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3038 = tosa.reshape %3031 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3039 = tosa.add %3037, %3038 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3040 = tosa.reduce_max %3039 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3041 = tosa.sub %3039, %3040 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3042 = math.exp %3041 : tensor<12x1x1024xf32>
    %3043 = tosa.reduce_sum %3042 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3044 = tosa.log %3043 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3045 = tosa.add %3040, %3044 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3046 = tosa.sub %3039, %3045 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3047 = math.exp %3046 : tensor<12x1x1024xf32>
    %3048 = tosa.reshape %3045 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3049 = tosa.reshape %3026 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3050 = tosa.matmul %3047, %3049 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3051 = tosa.reshape %3050 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3052 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3053 = tosa.transpose %3051, %3052 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3054 = tosa.reshape %3053 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3055 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3056 = tosa.transpose %arg308, %3055 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3057 = tosa.reshape %3054 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_802 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3058 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3057, %3056 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_802 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3059 = tosa.reshape %3058 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3060 = tosa.add %2953, %3059 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3061 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_803 = arith.constant 2 : i32
    %3062 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3060 : tensor<1x1x1536xf32>) outs(%3061 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_803 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3063 = tosa.reduce_sum %3062 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3064 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3065 = tosa.reciprocal %3064 : (tensor<1xf32>) -> tensor<1xf32>
    %3066 = tosa.reshape %3065 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3067 = tosa.mul %3066, %3063 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3068 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3069 = tosa.add %3067, %3068 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3070 = tosa.rsqrt %3069 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3071 = tosa.mul %3060, %3070 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3072 = tosa.reshape %arg309 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3073 = tosa.mul %3072, %3071 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3074 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3075 = tosa.transpose %arg310, %3074 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3076 = tosa.reshape %3073 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_804 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3077 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3076, %3075 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_804 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3078 = tosa.reshape %3077 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3079 = tosa.sigmoid %3078 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3080 = tosa.mul %3078, %3079 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3081 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3082 = tosa.transpose %arg311, %3081 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3083 = tosa.reshape %3073 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_805 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3084 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3083, %3082 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_805 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3085 = tosa.reshape %3084 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3086 = tosa.mul %3080, %3085 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3087 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3088 = tosa.transpose %arg312, %3087 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3089 = tosa.reshape %3086 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_806 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3090 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3089, %3088 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_806 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3091 = tosa.reshape %3090 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3092 = tosa.add %3060, %3091 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3093 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_807 = arith.constant 2 : i32
    %3094 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3092 : tensor<1x1x1536xf32>) outs(%3093 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_807 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3095 = tosa.reduce_sum %3094 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3096 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3097 = tosa.reciprocal %3096 : (tensor<1xf32>) -> tensor<1xf32>
    %3098 = tosa.reshape %3097 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3099 = tosa.mul %3098, %3095 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3100 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3101 = tosa.add %3099, %3100 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3102 = tosa.rsqrt %3101 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3103 = tosa.mul %3092, %3102 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3104 = tosa.reshape %arg313 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3105 = tosa.mul %3104, %3103 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3106 = tosa.reshape %3105 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3107 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3108 = tosa.transpose %arg314, %3107 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_808 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3109 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3106, %3108 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_808 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3110 = tosa.reshape %arg315 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %3111 = tosa.add %3110, %3109 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3112 = tosa.reshape %3111 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3113 = tosa.reshape %3112 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %3114 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3115 = tosa.transpose %3113, %3114 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %3116 = tosa.reshape %3105 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3117 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3118 = tosa.transpose %arg316, %3117 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_809 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3119 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3116, %3118 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_809 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3120 = tosa.reshape %arg317 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3121 = tosa.add %3120, %3119 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3122 = tosa.reshape %3121 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3123 = tosa.reshape %3122 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3124 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3125 = tosa.transpose %3123, %3124 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3126 = tosa.reshape %3105 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3127 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3128 = tosa.transpose %arg318, %3127 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_810 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3129 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3126, %3128 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_810 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3130 = tosa.reshape %arg319 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3131 = tosa.add %3130, %3129 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3132 = tosa.reshape %3131 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3133 = tosa.reshape %3132 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3134 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3135 = tosa.transpose %3133, %3134 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3136 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3137 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3138 = tosa.mul %3115, %3136 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_811 = tensor.extract_slice %3115[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_812 = tensor.extract_slice %3115[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3139 = tensor.empty() : tensor<1x12x1x64xf32>
    %3140 = linalg.negf ins(%extracted_slice_812 : tensor<1x12x1x64xf32>) outs(%3139 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3141 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_813 = tensor.insert_slice %3140 into %3141[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_814 = tensor.insert_slice %extracted_slice_811 into %inserted_slice_813[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3142 = tosa.mul %inserted_slice_814, %3137 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3143 = tosa.add %3138, %3142 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3144 = tosa.mul %3125, %3136 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_815 = tensor.extract_slice %3125[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_816 = tensor.extract_slice %3125[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3145 = tensor.empty() : tensor<1x2x1x64xf32>
    %3146 = linalg.negf ins(%extracted_slice_816 : tensor<1x2x1x64xf32>) outs(%3145 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3147 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_817 = tensor.insert_slice %3146 into %3147[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_818 = tensor.insert_slice %extracted_slice_815 into %inserted_slice_817[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3148 = tosa.mul %inserted_slice_818, %3137 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3149 = tosa.add %3144, %3148 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3150 = bufferization.to_memref %arg320 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3151 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3152 = bufferization.to_memref %3149 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_819 = arith.constant 0 : index
    %c1_820 = arith.constant 1 : index
    %c1_821 = arith.constant 1 : index
    %c2_822 = arith.constant 2 : index
    %c1_823 = arith.constant 1 : index
    %c128_824 = arith.constant 128 : index
    scf.for %arg399 = %c0_819 to %c1_821 step %c1_820 {
      scf.for %arg400 = %c0_819 to %c2_822 step %c1_820 {
        scf.for %arg401 = %c0_819 to %c1_823 step %c1_820 {
          %3945 = memref.load %3151[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_819 to %c128_824 step %c1_820 {
            %3947 = memref.load %3152[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3150[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3153 = bufferization.to_tensor %3150 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3154 = bufferization.to_memref %arg321 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3155 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3156 = bufferization.to_memref %3135 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_825 = arith.constant 0 : index
    %c1_826 = arith.constant 1 : index
    %c1_827 = arith.constant 1 : index
    %c2_828 = arith.constant 2 : index
    %c1_829 = arith.constant 1 : index
    %c128_830 = arith.constant 128 : index
    scf.for %arg399 = %c0_825 to %c1_827 step %c1_826 {
      scf.for %arg400 = %c0_825 to %c2_828 step %c1_826 {
        scf.for %arg401 = %c0_825 to %c1_829 step %c1_826 {
          %3945 = memref.load %3155[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_825 to %c128_830 step %c1_826 {
            %3947 = memref.load %3156[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3154[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3157 = bufferization.to_tensor %3154 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3158 = tosa.reshape %3153 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3159 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3160 = tosa.add %3158, %3159 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3161 = tosa.reshape %3160 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3162 = tosa.reshape %3157 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3163 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3164 = tosa.add %3162, %3163 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3165 = tosa.reshape %3164 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3166 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_831 = arith.constant 0xFF800000 : f32
    %cst_832 = arith.constant 0.000000e+00 : f32
    %3167 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_833 = tensor.splat %cst_832 : tensor<1x1x1x1024xf32>
    %splat_834 = tensor.splat %cst_831 : tensor<1x1x1x1024xf32>
    %3168 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3166, %splat_833, %splat_834 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3167 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_835 = arith.constant 0.000000e+00 : f32
    %splat_836 = tensor.splat %cst_835 : tensor<1x1024xf32>
    %3169 = tosa.reshape %3168 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3170 = tosa.add %splat_836, %3169 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3171 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3172 = tosa.transpose %3161, %3171 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3173 = tosa.reshape %3143 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3174 = tosa.reshape %3172 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3175 = tosa.matmul %3173, %3174 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_837 = arith.constant 0.0883883461 : f32
    %splat_838 = tensor.splat %cst_837 : tensor<12x1x1024xf32>
    %3176 = tosa.mul %3175, %splat_838 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3177 = tosa.reshape %3170 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3178 = tosa.add %3176, %3177 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3179 = tosa.reduce_max %3178 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3180 = tosa.sub %3178, %3179 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3181 = math.exp %3180 : tensor<12x1x1024xf32>
    %3182 = tosa.reduce_sum %3181 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3183 = tosa.log %3182 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3184 = tosa.add %3179, %3183 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3185 = tosa.sub %3178, %3184 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3186 = math.exp %3185 : tensor<12x1x1024xf32>
    %3187 = tosa.reshape %3184 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3188 = tosa.reshape %3165 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3189 = tosa.matmul %3186, %3188 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3190 = tosa.reshape %3189 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3191 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3192 = tosa.transpose %3190, %3191 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3193 = tosa.reshape %3192 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3194 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3195 = tosa.transpose %arg322, %3194 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3196 = tosa.reshape %3193 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_839 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3197 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3196, %3195 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_839 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3198 = tosa.reshape %3197 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3199 = tosa.add %3092, %3198 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3200 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_840 = arith.constant 2 : i32
    %3201 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3199 : tensor<1x1x1536xf32>) outs(%3200 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_840 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3202 = tosa.reduce_sum %3201 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3203 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3204 = tosa.reciprocal %3203 : (tensor<1xf32>) -> tensor<1xf32>
    %3205 = tosa.reshape %3204 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3206 = tosa.mul %3205, %3202 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3207 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3208 = tosa.add %3206, %3207 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3209 = tosa.rsqrt %3208 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3210 = tosa.mul %3199, %3209 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3211 = tosa.reshape %arg323 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3212 = tosa.mul %3211, %3210 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3213 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3214 = tosa.transpose %arg324, %3213 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3215 = tosa.reshape %3212 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_841 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3216 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3215, %3214 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_841 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3217 = tosa.reshape %3216 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3218 = tosa.sigmoid %3217 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3219 = tosa.mul %3217, %3218 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3220 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3221 = tosa.transpose %arg325, %3220 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3222 = tosa.reshape %3212 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_842 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3223 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3222, %3221 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_842 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3224 = tosa.reshape %3223 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3225 = tosa.mul %3219, %3224 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3226 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3227 = tosa.transpose %arg326, %3226 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3228 = tosa.reshape %3225 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_843 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3229 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3228, %3227 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_843 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3230 = tosa.reshape %3229 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3231 = tosa.add %3199, %3230 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3232 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_844 = arith.constant 2 : i32
    %3233 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3231 : tensor<1x1x1536xf32>) outs(%3232 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_844 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3234 = tosa.reduce_sum %3233 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3235 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3236 = tosa.reciprocal %3235 : (tensor<1xf32>) -> tensor<1xf32>
    %3237 = tosa.reshape %3236 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3238 = tosa.mul %3237, %3234 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3239 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3240 = tosa.add %3238, %3239 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3241 = tosa.rsqrt %3240 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3242 = tosa.mul %3231, %3241 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3243 = tosa.reshape %arg327 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3244 = tosa.mul %3243, %3242 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3245 = tosa.reshape %3244 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3246 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3247 = tosa.transpose %arg328, %3246 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_845 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3248 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3245, %3247 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_845 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3249 = tosa.reshape %arg329 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %3250 = tosa.add %3249, %3248 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3251 = tosa.reshape %3250 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3252 = tosa.reshape %3251 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %3253 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3254 = tosa.transpose %3252, %3253 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %3255 = tosa.reshape %3244 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3256 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3257 = tosa.transpose %arg330, %3256 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_846 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3258 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3255, %3257 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_846 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3259 = tosa.reshape %arg331 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3260 = tosa.add %3259, %3258 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3261 = tosa.reshape %3260 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3262 = tosa.reshape %3261 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3263 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3264 = tosa.transpose %3262, %3263 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3265 = tosa.reshape %3244 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3266 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3267 = tosa.transpose %arg332, %3266 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_847 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3268 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3265, %3267 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_847 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3269 = tosa.reshape %arg333 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3270 = tosa.add %3269, %3268 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3271 = tosa.reshape %3270 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3272 = tosa.reshape %3271 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3273 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3274 = tosa.transpose %3272, %3273 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3275 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3276 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3277 = tosa.mul %3254, %3275 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_848 = tensor.extract_slice %3254[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_849 = tensor.extract_slice %3254[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3278 = tensor.empty() : tensor<1x12x1x64xf32>
    %3279 = linalg.negf ins(%extracted_slice_849 : tensor<1x12x1x64xf32>) outs(%3278 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3280 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_850 = tensor.insert_slice %3279 into %3280[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_851 = tensor.insert_slice %extracted_slice_848 into %inserted_slice_850[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3281 = tosa.mul %inserted_slice_851, %3276 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3282 = tosa.add %3277, %3281 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3283 = tosa.mul %3264, %3275 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_852 = tensor.extract_slice %3264[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_853 = tensor.extract_slice %3264[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3284 = tensor.empty() : tensor<1x2x1x64xf32>
    %3285 = linalg.negf ins(%extracted_slice_853 : tensor<1x2x1x64xf32>) outs(%3284 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3286 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_854 = tensor.insert_slice %3285 into %3286[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_855 = tensor.insert_slice %extracted_slice_852 into %inserted_slice_854[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3287 = tosa.mul %inserted_slice_855, %3276 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3288 = tosa.add %3283, %3287 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3289 = bufferization.to_memref %arg334 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3290 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3291 = bufferization.to_memref %3288 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_856 = arith.constant 0 : index
    %c1_857 = arith.constant 1 : index
    %c1_858 = arith.constant 1 : index
    %c2_859 = arith.constant 2 : index
    %c1_860 = arith.constant 1 : index
    %c128_861 = arith.constant 128 : index
    scf.for %arg399 = %c0_856 to %c1_858 step %c1_857 {
      scf.for %arg400 = %c0_856 to %c2_859 step %c1_857 {
        scf.for %arg401 = %c0_856 to %c1_860 step %c1_857 {
          %3945 = memref.load %3290[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_856 to %c128_861 step %c1_857 {
            %3947 = memref.load %3291[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3289[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3292 = bufferization.to_tensor %3289 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3293 = bufferization.to_memref %arg335 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3294 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3295 = bufferization.to_memref %3274 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_862 = arith.constant 0 : index
    %c1_863 = arith.constant 1 : index
    %c1_864 = arith.constant 1 : index
    %c2_865 = arith.constant 2 : index
    %c1_866 = arith.constant 1 : index
    %c128_867 = arith.constant 128 : index
    scf.for %arg399 = %c0_862 to %c1_864 step %c1_863 {
      scf.for %arg400 = %c0_862 to %c2_865 step %c1_863 {
        scf.for %arg401 = %c0_862 to %c1_866 step %c1_863 {
          %3945 = memref.load %3294[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_862 to %c128_867 step %c1_863 {
            %3947 = memref.load %3295[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3293[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3296 = bufferization.to_tensor %3293 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3297 = tosa.reshape %3292 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3298 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3299 = tosa.add %3297, %3298 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3300 = tosa.reshape %3299 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3301 = tosa.reshape %3296 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3302 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3303 = tosa.add %3301, %3302 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3304 = tosa.reshape %3303 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3305 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_868 = arith.constant 0xFF800000 : f32
    %cst_869 = arith.constant 0.000000e+00 : f32
    %3306 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_870 = tensor.splat %cst_869 : tensor<1x1x1x1024xf32>
    %splat_871 = tensor.splat %cst_868 : tensor<1x1x1x1024xf32>
    %3307 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3305, %splat_870, %splat_871 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3306 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_872 = arith.constant 0.000000e+00 : f32
    %splat_873 = tensor.splat %cst_872 : tensor<1x1024xf32>
    %3308 = tosa.reshape %3307 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3309 = tosa.add %splat_873, %3308 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3310 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3311 = tosa.transpose %3300, %3310 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3312 = tosa.reshape %3282 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3313 = tosa.reshape %3311 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3314 = tosa.matmul %3312, %3313 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_874 = arith.constant 0.0883883461 : f32
    %splat_875 = tensor.splat %cst_874 : tensor<12x1x1024xf32>
    %3315 = tosa.mul %3314, %splat_875 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3316 = tosa.reshape %3309 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3317 = tosa.add %3315, %3316 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3318 = tosa.reduce_max %3317 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3319 = tosa.sub %3317, %3318 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3320 = math.exp %3319 : tensor<12x1x1024xf32>
    %3321 = tosa.reduce_sum %3320 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3322 = tosa.log %3321 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3323 = tosa.add %3318, %3322 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3324 = tosa.sub %3317, %3323 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3325 = math.exp %3324 : tensor<12x1x1024xf32>
    %3326 = tosa.reshape %3323 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3327 = tosa.reshape %3304 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3328 = tosa.matmul %3325, %3327 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3329 = tosa.reshape %3328 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3330 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3331 = tosa.transpose %3329, %3330 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3332 = tosa.reshape %3331 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3333 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3334 = tosa.transpose %arg336, %3333 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3335 = tosa.reshape %3332 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_876 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3336 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3335, %3334 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_876 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3337 = tosa.reshape %3336 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3338 = tosa.add %3231, %3337 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3339 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_877 = arith.constant 2 : i32
    %3340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3338 : tensor<1x1x1536xf32>) outs(%3339 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_877 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3341 = tosa.reduce_sum %3340 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3342 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3343 = tosa.reciprocal %3342 : (tensor<1xf32>) -> tensor<1xf32>
    %3344 = tosa.reshape %3343 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3345 = tosa.mul %3344, %3341 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3346 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3347 = tosa.add %3345, %3346 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3348 = tosa.rsqrt %3347 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3349 = tosa.mul %3338, %3348 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3350 = tosa.reshape %arg337 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3351 = tosa.mul %3350, %3349 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3352 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3353 = tosa.transpose %arg338, %3352 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3354 = tosa.reshape %3351 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_878 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3355 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3354, %3353 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_878 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3356 = tosa.reshape %3355 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3357 = tosa.sigmoid %3356 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3358 = tosa.mul %3356, %3357 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3359 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3360 = tosa.transpose %arg339, %3359 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3361 = tosa.reshape %3351 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_879 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3362 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3361, %3360 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_879 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3363 = tosa.reshape %3362 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3364 = tosa.mul %3358, %3363 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3365 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3366 = tosa.transpose %arg340, %3365 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3367 = tosa.reshape %3364 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_880 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3368 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3367, %3366 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_880 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3369 = tosa.reshape %3368 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3370 = tosa.add %3338, %3369 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3371 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_881 = arith.constant 2 : i32
    %3372 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3370 : tensor<1x1x1536xf32>) outs(%3371 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_881 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3373 = tosa.reduce_sum %3372 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3374 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3375 = tosa.reciprocal %3374 : (tensor<1xf32>) -> tensor<1xf32>
    %3376 = tosa.reshape %3375 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3377 = tosa.mul %3376, %3373 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3378 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3379 = tosa.add %3377, %3378 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3380 = tosa.rsqrt %3379 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3381 = tosa.mul %3370, %3380 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3382 = tosa.reshape %arg341 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3383 = tosa.mul %3382, %3381 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3384 = tosa.reshape %3383 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3385 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3386 = tosa.transpose %arg342, %3385 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_882 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3387 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3384, %3386 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_882 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3388 = tosa.reshape %arg343 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %3389 = tosa.add %3388, %3387 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3390 = tosa.reshape %3389 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3391 = tosa.reshape %3390 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %3392 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3393 = tosa.transpose %3391, %3392 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %3394 = tosa.reshape %3383 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3395 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3396 = tosa.transpose %arg344, %3395 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_883 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3397 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3394, %3396 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_883 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3398 = tosa.reshape %arg345 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3399 = tosa.add %3398, %3397 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3400 = tosa.reshape %3399 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3401 = tosa.reshape %3400 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3402 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3403 = tosa.transpose %3401, %3402 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3404 = tosa.reshape %3383 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3405 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3406 = tosa.transpose %arg346, %3405 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_884 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3407 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3404, %3406 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_884 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3408 = tosa.reshape %arg347 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3409 = tosa.add %3408, %3407 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3410 = tosa.reshape %3409 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3411 = tosa.reshape %3410 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3412 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3413 = tosa.transpose %3411, %3412 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3414 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3415 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3416 = tosa.mul %3393, %3414 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_885 = tensor.extract_slice %3393[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_886 = tensor.extract_slice %3393[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3417 = tensor.empty() : tensor<1x12x1x64xf32>
    %3418 = linalg.negf ins(%extracted_slice_886 : tensor<1x12x1x64xf32>) outs(%3417 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3419 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_887 = tensor.insert_slice %3418 into %3419[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_888 = tensor.insert_slice %extracted_slice_885 into %inserted_slice_887[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3420 = tosa.mul %inserted_slice_888, %3415 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3421 = tosa.add %3416, %3420 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3422 = tosa.mul %3403, %3414 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_889 = tensor.extract_slice %3403[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_890 = tensor.extract_slice %3403[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3423 = tensor.empty() : tensor<1x2x1x64xf32>
    %3424 = linalg.negf ins(%extracted_slice_890 : tensor<1x2x1x64xf32>) outs(%3423 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3425 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_891 = tensor.insert_slice %3424 into %3425[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_892 = tensor.insert_slice %extracted_slice_889 into %inserted_slice_891[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3426 = tosa.mul %inserted_slice_892, %3415 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3427 = tosa.add %3422, %3426 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3428 = bufferization.to_memref %arg348 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3429 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3430 = bufferization.to_memref %3427 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_893 = arith.constant 0 : index
    %c1_894 = arith.constant 1 : index
    %c1_895 = arith.constant 1 : index
    %c2_896 = arith.constant 2 : index
    %c1_897 = arith.constant 1 : index
    %c128_898 = arith.constant 128 : index
    scf.for %arg399 = %c0_893 to %c1_895 step %c1_894 {
      scf.for %arg400 = %c0_893 to %c2_896 step %c1_894 {
        scf.for %arg401 = %c0_893 to %c1_897 step %c1_894 {
          %3945 = memref.load %3429[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_893 to %c128_898 step %c1_894 {
            %3947 = memref.load %3430[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3428[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3431 = bufferization.to_tensor %3428 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3432 = bufferization.to_memref %arg349 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3433 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3434 = bufferization.to_memref %3413 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_899 = arith.constant 0 : index
    %c1_900 = arith.constant 1 : index
    %c1_901 = arith.constant 1 : index
    %c2_902 = arith.constant 2 : index
    %c1_903 = arith.constant 1 : index
    %c128_904 = arith.constant 128 : index
    scf.for %arg399 = %c0_899 to %c1_901 step %c1_900 {
      scf.for %arg400 = %c0_899 to %c2_902 step %c1_900 {
        scf.for %arg401 = %c0_899 to %c1_903 step %c1_900 {
          %3945 = memref.load %3433[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_899 to %c128_904 step %c1_900 {
            %3947 = memref.load %3434[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3432[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3435 = bufferization.to_tensor %3432 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3436 = tosa.reshape %3431 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3437 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3438 = tosa.add %3436, %3437 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3439 = tosa.reshape %3438 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3440 = tosa.reshape %3435 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3441 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3442 = tosa.add %3440, %3441 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3443 = tosa.reshape %3442 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3444 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_905 = arith.constant 0xFF800000 : f32
    %cst_906 = arith.constant 0.000000e+00 : f32
    %3445 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_907 = tensor.splat %cst_906 : tensor<1x1x1x1024xf32>
    %splat_908 = tensor.splat %cst_905 : tensor<1x1x1x1024xf32>
    %3446 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3444, %splat_907, %splat_908 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3445 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_909 = arith.constant 0.000000e+00 : f32
    %splat_910 = tensor.splat %cst_909 : tensor<1x1024xf32>
    %3447 = tosa.reshape %3446 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3448 = tosa.add %splat_910, %3447 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3449 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3450 = tosa.transpose %3439, %3449 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3451 = tosa.reshape %3421 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3452 = tosa.reshape %3450 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3453 = tosa.matmul %3451, %3452 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_911 = arith.constant 0.0883883461 : f32
    %splat_912 = tensor.splat %cst_911 : tensor<12x1x1024xf32>
    %3454 = tosa.mul %3453, %splat_912 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3455 = tosa.reshape %3448 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3456 = tosa.add %3454, %3455 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3457 = tosa.reduce_max %3456 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3458 = tosa.sub %3456, %3457 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3459 = math.exp %3458 : tensor<12x1x1024xf32>
    %3460 = tosa.reduce_sum %3459 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3461 = tosa.log %3460 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3462 = tosa.add %3457, %3461 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3463 = tosa.sub %3456, %3462 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3464 = math.exp %3463 : tensor<12x1x1024xf32>
    %3465 = tosa.reshape %3462 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3466 = tosa.reshape %3443 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3467 = tosa.matmul %3464, %3466 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3468 = tosa.reshape %3467 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3469 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3470 = tosa.transpose %3468, %3469 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3471 = tosa.reshape %3470 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3472 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3473 = tosa.transpose %arg350, %3472 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3474 = tosa.reshape %3471 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_913 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3475 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3474, %3473 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_913 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3476 = tosa.reshape %3475 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3477 = tosa.add %3370, %3476 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3478 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_914 = arith.constant 2 : i32
    %3479 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3477 : tensor<1x1x1536xf32>) outs(%3478 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_914 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3480 = tosa.reduce_sum %3479 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3481 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3482 = tosa.reciprocal %3481 : (tensor<1xf32>) -> tensor<1xf32>
    %3483 = tosa.reshape %3482 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3484 = tosa.mul %3483, %3480 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3485 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3486 = tosa.add %3484, %3485 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3487 = tosa.rsqrt %3486 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3488 = tosa.mul %3477, %3487 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3489 = tosa.reshape %arg351 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3490 = tosa.mul %3489, %3488 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3491 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3492 = tosa.transpose %arg352, %3491 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3493 = tosa.reshape %3490 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_915 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3494 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3493, %3492 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_915 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3495 = tosa.reshape %3494 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3496 = tosa.sigmoid %3495 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3497 = tosa.mul %3495, %3496 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3498 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3499 = tosa.transpose %arg353, %3498 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3500 = tosa.reshape %3490 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_916 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3501 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3500, %3499 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_916 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3502 = tosa.reshape %3501 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3503 = tosa.mul %3497, %3502 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3504 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3505 = tosa.transpose %arg354, %3504 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3506 = tosa.reshape %3503 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_917 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3507 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3506, %3505 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_917 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3508 = tosa.reshape %3507 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3509 = tosa.add %3477, %3508 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3510 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_918 = arith.constant 2 : i32
    %3511 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3509 : tensor<1x1x1536xf32>) outs(%3510 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_918 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3512 = tosa.reduce_sum %3511 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3513 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3514 = tosa.reciprocal %3513 : (tensor<1xf32>) -> tensor<1xf32>
    %3515 = tosa.reshape %3514 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3516 = tosa.mul %3515, %3512 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3517 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3518 = tosa.add %3516, %3517 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3519 = tosa.rsqrt %3518 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3520 = tosa.mul %3509, %3519 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3521 = tosa.reshape %arg355 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3522 = tosa.mul %3521, %3520 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3523 = tosa.reshape %3522 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3524 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3525 = tosa.transpose %arg356, %3524 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_919 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3526 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3523, %3525 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_919 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3527 = tosa.reshape %arg357 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %3528 = tosa.add %3527, %3526 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3529 = tosa.reshape %3528 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3530 = tosa.reshape %3529 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %3531 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3532 = tosa.transpose %3530, %3531 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %3533 = tosa.reshape %3522 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3534 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3535 = tosa.transpose %arg358, %3534 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_920 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3536 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3533, %3535 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_920 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3537 = tosa.reshape %arg359 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3538 = tosa.add %3537, %3536 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3539 = tosa.reshape %3538 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3540 = tosa.reshape %3539 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3541 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3542 = tosa.transpose %3540, %3541 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3543 = tosa.reshape %3522 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3544 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3545 = tosa.transpose %arg360, %3544 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_921 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3546 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3543, %3545 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_921 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3547 = tosa.reshape %arg361 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3548 = tosa.add %3547, %3546 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3549 = tosa.reshape %3548 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3550 = tosa.reshape %3549 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3551 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3552 = tosa.transpose %3550, %3551 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3553 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3554 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3555 = tosa.mul %3532, %3553 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_922 = tensor.extract_slice %3532[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_923 = tensor.extract_slice %3532[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3556 = tensor.empty() : tensor<1x12x1x64xf32>
    %3557 = linalg.negf ins(%extracted_slice_923 : tensor<1x12x1x64xf32>) outs(%3556 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3558 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_924 = tensor.insert_slice %3557 into %3558[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_925 = tensor.insert_slice %extracted_slice_922 into %inserted_slice_924[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3559 = tosa.mul %inserted_slice_925, %3554 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3560 = tosa.add %3555, %3559 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3561 = tosa.mul %3542, %3553 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_926 = tensor.extract_slice %3542[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_927 = tensor.extract_slice %3542[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3562 = tensor.empty() : tensor<1x2x1x64xf32>
    %3563 = linalg.negf ins(%extracted_slice_927 : tensor<1x2x1x64xf32>) outs(%3562 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3564 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_928 = tensor.insert_slice %3563 into %3564[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_929 = tensor.insert_slice %extracted_slice_926 into %inserted_slice_928[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3565 = tosa.mul %inserted_slice_929, %3554 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3566 = tosa.add %3561, %3565 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3567 = bufferization.to_memref %arg362 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3568 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3569 = bufferization.to_memref %3566 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_930 = arith.constant 0 : index
    %c1_931 = arith.constant 1 : index
    %c1_932 = arith.constant 1 : index
    %c2_933 = arith.constant 2 : index
    %c1_934 = arith.constant 1 : index
    %c128_935 = arith.constant 128 : index
    scf.for %arg399 = %c0_930 to %c1_932 step %c1_931 {
      scf.for %arg400 = %c0_930 to %c2_933 step %c1_931 {
        scf.for %arg401 = %c0_930 to %c1_934 step %c1_931 {
          %3945 = memref.load %3568[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_930 to %c128_935 step %c1_931 {
            %3947 = memref.load %3569[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3567[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3570 = bufferization.to_tensor %3567 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3571 = bufferization.to_memref %arg363 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3572 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3573 = bufferization.to_memref %3552 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_936 = arith.constant 0 : index
    %c1_937 = arith.constant 1 : index
    %c1_938 = arith.constant 1 : index
    %c2_939 = arith.constant 2 : index
    %c1_940 = arith.constant 1 : index
    %c128_941 = arith.constant 128 : index
    scf.for %arg399 = %c0_936 to %c1_938 step %c1_937 {
      scf.for %arg400 = %c0_936 to %c2_939 step %c1_937 {
        scf.for %arg401 = %c0_936 to %c1_940 step %c1_937 {
          %3945 = memref.load %3572[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_936 to %c128_941 step %c1_937 {
            %3947 = memref.load %3573[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3571[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3574 = bufferization.to_tensor %3571 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3575 = tosa.reshape %3570 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3576 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3577 = tosa.add %3575, %3576 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3578 = tosa.reshape %3577 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3579 = tosa.reshape %3574 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3580 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3581 = tosa.add %3579, %3580 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3582 = tosa.reshape %3581 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3583 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_942 = arith.constant 0xFF800000 : f32
    %cst_943 = arith.constant 0.000000e+00 : f32
    %3584 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_944 = tensor.splat %cst_943 : tensor<1x1x1x1024xf32>
    %splat_945 = tensor.splat %cst_942 : tensor<1x1x1x1024xf32>
    %3585 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3583, %splat_944, %splat_945 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3584 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_946 = arith.constant 0.000000e+00 : f32
    %splat_947 = tensor.splat %cst_946 : tensor<1x1024xf32>
    %3586 = tosa.reshape %3585 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3587 = tosa.add %splat_947, %3586 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3588 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3589 = tosa.transpose %3578, %3588 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3590 = tosa.reshape %3560 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3591 = tosa.reshape %3589 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3592 = tosa.matmul %3590, %3591 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_948 = arith.constant 0.0883883461 : f32
    %splat_949 = tensor.splat %cst_948 : tensor<12x1x1024xf32>
    %3593 = tosa.mul %3592, %splat_949 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3594 = tosa.reshape %3587 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3595 = tosa.add %3593, %3594 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3596 = tosa.reduce_max %3595 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3597 = tosa.sub %3595, %3596 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3598 = math.exp %3597 : tensor<12x1x1024xf32>
    %3599 = tosa.reduce_sum %3598 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3600 = tosa.log %3599 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3601 = tosa.add %3596, %3600 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3602 = tosa.sub %3595, %3601 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3603 = math.exp %3602 : tensor<12x1x1024xf32>
    %3604 = tosa.reshape %3601 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3605 = tosa.reshape %3582 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3606 = tosa.matmul %3603, %3605 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3607 = tosa.reshape %3606 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3608 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3609 = tosa.transpose %3607, %3608 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3610 = tosa.reshape %3609 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3611 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3612 = tosa.transpose %arg364, %3611 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3613 = tosa.reshape %3610 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_950 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3614 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3613, %3612 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_950 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3615 = tosa.reshape %3614 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3616 = tosa.add %3509, %3615 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3617 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_951 = arith.constant 2 : i32
    %3618 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3616 : tensor<1x1x1536xf32>) outs(%3617 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_951 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3619 = tosa.reduce_sum %3618 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3620 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3621 = tosa.reciprocal %3620 : (tensor<1xf32>) -> tensor<1xf32>
    %3622 = tosa.reshape %3621 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3623 = tosa.mul %3622, %3619 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3624 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3625 = tosa.add %3623, %3624 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3626 = tosa.rsqrt %3625 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3627 = tosa.mul %3616, %3626 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3628 = tosa.reshape %arg365 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3629 = tosa.mul %3628, %3627 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3630 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3631 = tosa.transpose %arg366, %3630 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3632 = tosa.reshape %3629 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_952 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3633 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3632, %3631 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_952 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3634 = tosa.reshape %3633 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3635 = tosa.sigmoid %3634 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3636 = tosa.mul %3634, %3635 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3637 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3638 = tosa.transpose %arg367, %3637 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3639 = tosa.reshape %3629 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_953 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3640 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3639, %3638 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_953 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3641 = tosa.reshape %3640 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3642 = tosa.mul %3636, %3641 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3643 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3644 = tosa.transpose %arg368, %3643 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3645 = tosa.reshape %3642 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_954 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3646 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3645, %3644 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_954 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3647 = tosa.reshape %3646 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3648 = tosa.add %3616, %3647 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3649 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_955 = arith.constant 2 : i32
    %3650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3648 : tensor<1x1x1536xf32>) outs(%3649 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_955 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3651 = tosa.reduce_sum %3650 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3652 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3653 = tosa.reciprocal %3652 : (tensor<1xf32>) -> tensor<1xf32>
    %3654 = tosa.reshape %3653 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3655 = tosa.mul %3654, %3651 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3656 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3657 = tosa.add %3655, %3656 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3658 = tosa.rsqrt %3657 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3659 = tosa.mul %3648, %3658 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3660 = tosa.reshape %arg369 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3661 = tosa.mul %3660, %3659 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3662 = tosa.reshape %3661 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3663 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3664 = tosa.transpose %arg370, %3663 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_956 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3665 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3662, %3664 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_956 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3666 = tosa.reshape %arg371 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %3667 = tosa.add %3666, %3665 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3668 = tosa.reshape %3667 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3669 = tosa.reshape %3668 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %3670 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3671 = tosa.transpose %3669, %3670 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %3672 = tosa.reshape %3661 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3673 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3674 = tosa.transpose %arg372, %3673 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_957 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3675 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3672, %3674 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_957 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3676 = tosa.reshape %arg373 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3677 = tosa.add %3676, %3675 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3678 = tosa.reshape %3677 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3679 = tosa.reshape %3678 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3680 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3681 = tosa.transpose %3679, %3680 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3682 = tosa.reshape %3661 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3683 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3684 = tosa.transpose %arg374, %3683 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_958 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3685 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3682, %3684 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_958 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3686 = tosa.reshape %arg375 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3687 = tosa.add %3686, %3685 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3688 = tosa.reshape %3687 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3689 = tosa.reshape %3688 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3690 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3691 = tosa.transpose %3689, %3690 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3692 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3693 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3694 = tosa.mul %3671, %3692 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_959 = tensor.extract_slice %3671[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_960 = tensor.extract_slice %3671[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3695 = tensor.empty() : tensor<1x12x1x64xf32>
    %3696 = linalg.negf ins(%extracted_slice_960 : tensor<1x12x1x64xf32>) outs(%3695 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3697 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_961 = tensor.insert_slice %3696 into %3697[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_962 = tensor.insert_slice %extracted_slice_959 into %inserted_slice_961[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3698 = tosa.mul %inserted_slice_962, %3693 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3699 = tosa.add %3694, %3698 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3700 = tosa.mul %3681, %3692 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_963 = tensor.extract_slice %3681[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_964 = tensor.extract_slice %3681[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3701 = tensor.empty() : tensor<1x2x1x64xf32>
    %3702 = linalg.negf ins(%extracted_slice_964 : tensor<1x2x1x64xf32>) outs(%3701 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3703 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_965 = tensor.insert_slice %3702 into %3703[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_966 = tensor.insert_slice %extracted_slice_963 into %inserted_slice_965[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3704 = tosa.mul %inserted_slice_966, %3693 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3705 = tosa.add %3700, %3704 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3706 = bufferization.to_memref %arg376 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3707 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3708 = bufferization.to_memref %3705 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_967 = arith.constant 0 : index
    %c1_968 = arith.constant 1 : index
    %c1_969 = arith.constant 1 : index
    %c2_970 = arith.constant 2 : index
    %c1_971 = arith.constant 1 : index
    %c128_972 = arith.constant 128 : index
    scf.for %arg399 = %c0_967 to %c1_969 step %c1_968 {
      scf.for %arg400 = %c0_967 to %c2_970 step %c1_968 {
        scf.for %arg401 = %c0_967 to %c1_971 step %c1_968 {
          %3945 = memref.load %3707[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_967 to %c128_972 step %c1_968 {
            %3947 = memref.load %3708[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3706[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3709 = bufferization.to_tensor %3706 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3710 = bufferization.to_memref %arg377 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3711 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3712 = bufferization.to_memref %3691 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_973 = arith.constant 0 : index
    %c1_974 = arith.constant 1 : index
    %c1_975 = arith.constant 1 : index
    %c2_976 = arith.constant 2 : index
    %c1_977 = arith.constant 1 : index
    %c128_978 = arith.constant 128 : index
    scf.for %arg399 = %c0_973 to %c1_975 step %c1_974 {
      scf.for %arg400 = %c0_973 to %c2_976 step %c1_974 {
        scf.for %arg401 = %c0_973 to %c1_977 step %c1_974 {
          %3945 = memref.load %3711[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_973 to %c128_978 step %c1_974 {
            %3947 = memref.load %3712[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3710[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3713 = bufferization.to_tensor %3710 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3714 = tosa.reshape %3709 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3715 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3716 = tosa.add %3714, %3715 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3717 = tosa.reshape %3716 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3718 = tosa.reshape %3713 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3719 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3720 = tosa.add %3718, %3719 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3721 = tosa.reshape %3720 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3722 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_979 = arith.constant 0xFF800000 : f32
    %cst_980 = arith.constant 0.000000e+00 : f32
    %3723 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_981 = tensor.splat %cst_980 : tensor<1x1x1x1024xf32>
    %splat_982 = tensor.splat %cst_979 : tensor<1x1x1x1024xf32>
    %3724 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3722, %splat_981, %splat_982 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3723 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_983 = arith.constant 0.000000e+00 : f32
    %splat_984 = tensor.splat %cst_983 : tensor<1x1024xf32>
    %3725 = tosa.reshape %3724 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3726 = tosa.add %splat_984, %3725 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3727 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3728 = tosa.transpose %3717, %3727 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3729 = tosa.reshape %3699 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3730 = tosa.reshape %3728 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3731 = tosa.matmul %3729, %3730 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_985 = arith.constant 0.0883883461 : f32
    %splat_986 = tensor.splat %cst_985 : tensor<12x1x1024xf32>
    %3732 = tosa.mul %3731, %splat_986 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3733 = tosa.reshape %3726 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3734 = tosa.add %3732, %3733 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3735 = tosa.reduce_max %3734 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3736 = tosa.sub %3734, %3735 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3737 = math.exp %3736 : tensor<12x1x1024xf32>
    %3738 = tosa.reduce_sum %3737 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3739 = tosa.log %3738 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3740 = tosa.add %3735, %3739 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3741 = tosa.sub %3734, %3740 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3742 = math.exp %3741 : tensor<12x1x1024xf32>
    %3743 = tosa.reshape %3740 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3744 = tosa.reshape %3721 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3745 = tosa.matmul %3742, %3744 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3746 = tosa.reshape %3745 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3747 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3748 = tosa.transpose %3746, %3747 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3749 = tosa.reshape %3748 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3750 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3751 = tosa.transpose %arg378, %3750 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3752 = tosa.reshape %3749 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_987 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3753 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3752, %3751 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_987 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3754 = tosa.reshape %3753 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3755 = tosa.add %3648, %3754 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3756 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_988 = arith.constant 2 : i32
    %3757 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3755 : tensor<1x1x1536xf32>) outs(%3756 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_988 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3758 = tosa.reduce_sum %3757 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3759 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3760 = tosa.reciprocal %3759 : (tensor<1xf32>) -> tensor<1xf32>
    %3761 = tosa.reshape %3760 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3762 = tosa.mul %3761, %3758 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3763 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3764 = tosa.add %3762, %3763 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3765 = tosa.rsqrt %3764 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3766 = tosa.mul %3755, %3765 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3767 = tosa.reshape %arg379 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3768 = tosa.mul %3767, %3766 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3769 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3770 = tosa.transpose %arg380, %3769 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3771 = tosa.reshape %3768 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_989 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3772 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3771, %3770 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_989 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3773 = tosa.reshape %3772 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3774 = tosa.sigmoid %3773 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3775 = tosa.mul %3773, %3774 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3776 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3777 = tosa.transpose %arg381, %3776 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3778 = tosa.reshape %3768 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_990 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3779 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3778, %3777 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_990 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3780 = tosa.reshape %3779 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3781 = tosa.mul %3775, %3780 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3782 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3783 = tosa.transpose %arg382, %3782 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3784 = tosa.reshape %3781 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_991 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3785 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3784, %3783 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_991 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3786 = tosa.reshape %3785 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3787 = tosa.add %3755, %3786 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3788 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_992 = arith.constant 2 : i32
    %3789 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3787 : tensor<1x1x1536xf32>) outs(%3788 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_992 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3790 = tosa.reduce_sum %3789 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3791 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3792 = tosa.reciprocal %3791 : (tensor<1xf32>) -> tensor<1xf32>
    %3793 = tosa.reshape %3792 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3794 = tosa.mul %3793, %3790 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3795 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3796 = tosa.add %3794, %3795 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3797 = tosa.rsqrt %3796 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3798 = tosa.mul %3787, %3797 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3799 = tosa.reshape %arg383 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3800 = tosa.mul %3799, %3798 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3801 = tosa.reshape %3800 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3802 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3803 = tosa.transpose %arg384, %3802 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %cst_993 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3804 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3801, %3803 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_993 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3805 = tosa.reshape %arg385 {new_shape = array<i64: 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1536xf32>
    %3806 = tosa.add %3805, %3804 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3807 = tosa.reshape %3806 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3808 = tosa.reshape %3807 {new_shape = array<i64: 1, 1, 12, 128>} : (tensor<1x1x1536xf32>) -> tensor<1x1x12x128xf32>
    %3809 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3810 = tosa.transpose %3808, %3809 : (tensor<1x1x12x128xf32>, tensor<4xi32>) -> tensor<1x12x1x128xf32>
    %3811 = tosa.reshape %3800 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3812 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3813 = tosa.transpose %arg386, %3812 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_994 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3814 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3811, %3813 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_994 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3815 = tosa.reshape %arg387 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3816 = tosa.add %3815, %3814 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3817 = tosa.reshape %3816 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3818 = tosa.reshape %3817 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3819 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3820 = tosa.transpose %3818, %3819 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3821 = tosa.reshape %3800 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %3822 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3823 = tosa.transpose %arg388, %3822 : (tensor<256x1536xf32>, tensor<2xi32>) -> tensor<1536x256xf32>
    %cst_995 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %3824 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3821, %3823 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_995 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %3825 = tosa.reshape %arg389 {new_shape = array<i64: 1, 256>} : (tensor<256xf32>) -> tensor<1x256xf32>
    %3826 = tosa.add %3825, %3824 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %3827 = tosa.reshape %3826 {new_shape = array<i64: 1, 1, 256>} : (tensor<1x256xf32>) -> tensor<1x1x256xf32>
    %3828 = tosa.reshape %3827 {new_shape = array<i64: 1, 1, 2, 128>} : (tensor<1x1x256xf32>) -> tensor<1x1x2x128xf32>
    %3829 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3830 = tosa.transpose %3828, %3829 : (tensor<1x1x2x128xf32>, tensor<4xi32>) -> tensor<1x2x1x128xf32>
    %3831 = tosa.reshape %31 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3832 = tosa.reshape %34 {new_shape = array<i64: 1, 1, 1, 128>} : (tensor<1x1x128xf32>) -> tensor<1x1x1x128xf32>
    %3833 = tosa.mul %3810, %3831 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %extracted_slice_996 = tensor.extract_slice %3810[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_997 = tensor.extract_slice %3810[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %3834 = tensor.empty() : tensor<1x12x1x64xf32>
    %3835 = linalg.negf ins(%extracted_slice_997 : tensor<1x12x1x64xf32>) outs(%3834 : tensor<1x12x1x64xf32>) -> tensor<1x12x1x64xf32>
    %3836 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_998 = tensor.insert_slice %3835 into %3836[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_999 = tensor.insert_slice %extracted_slice_996 into %inserted_slice_998[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %3837 = tosa.mul %inserted_slice_999, %3832 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3838 = tosa.add %3833, %3837 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3839 = tosa.mul %3820, %3831 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %extracted_slice_1000 = tensor.extract_slice %3820[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_1001 = tensor.extract_slice %3820[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %3840 = tensor.empty() : tensor<1x2x1x64xf32>
    %3841 = linalg.negf ins(%extracted_slice_1001 : tensor<1x2x1x64xf32>) outs(%3840 : tensor<1x2x1x64xf32>) -> tensor<1x2x1x64xf32>
    %3842 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_1002 = tensor.insert_slice %3841 into %3842[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_1003 = tensor.insert_slice %extracted_slice_1000 into %inserted_slice_1002[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %3843 = tosa.mul %inserted_slice_1003, %3832 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3844 = tosa.add %3839, %3843 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %3845 = bufferization.to_memref %arg390 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3846 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3847 = bufferization.to_memref %3844 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_1004 = arith.constant 0 : index
    %c1_1005 = arith.constant 1 : index
    %c1_1006 = arith.constant 1 : index
    %c2_1007 = arith.constant 2 : index
    %c1_1008 = arith.constant 1 : index
    %c128_1009 = arith.constant 128 : index
    scf.for %arg399 = %c0_1004 to %c1_1006 step %c1_1005 {
      scf.for %arg400 = %c0_1004 to %c2_1007 step %c1_1005 {
        scf.for %arg401 = %c0_1004 to %c1_1008 step %c1_1005 {
          %3945 = memref.load %3846[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_1004 to %c128_1009 step %c1_1005 {
            %3947 = memref.load %3847[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3845[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3848 = bufferization.to_tensor %3845 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3849 = bufferization.to_memref %arg391 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %3850 = bufferization.to_memref %arg3 : tensor<1xi64> to memref<1xi64>
    %3851 = bufferization.to_memref %3830 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    %c0_1010 = arith.constant 0 : index
    %c1_1011 = arith.constant 1 : index
    %c1_1012 = arith.constant 1 : index
    %c2_1013 = arith.constant 2 : index
    %c1_1014 = arith.constant 1 : index
    %c128_1015 = arith.constant 128 : index
    scf.for %arg399 = %c0_1010 to %c1_1012 step %c1_1011 {
      scf.for %arg400 = %c0_1010 to %c2_1013 step %c1_1011 {
        scf.for %arg401 = %c0_1010 to %c1_1014 step %c1_1011 {
          %3945 = memref.load %3850[%arg401] : memref<1xi64>
          %3946 = arith.index_cast %3945 : i64 to index
          scf.for %arg402 = %c0_1010 to %c128_1015 step %c1_1011 {
            %3947 = memref.load %3851[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            memref.store %3947, %3849[%arg399, %arg400, %3946, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %3852 = bufferization.to_tensor %3849 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %3853 = tosa.reshape %3848 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3854 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3855 = tosa.add %3853, %3854 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3856 = tosa.reshape %3855 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3857 = tosa.reshape %3852 {new_shape = array<i64: 1, 2, 1, 1024, 128>} : (tensor<1x2x1024x128xf32>) -> tensor<1x2x1x1024x128xf32>
    %3858 = "tosa.const"() <{value = dense<0.000000e+00> : tensor<1x2x6x1024x128xf32>}> : () -> tensor<1x2x6x1024x128xf32>
    %3859 = tosa.add %3857, %3858 : (tensor<1x2x1x1024x128xf32>, tensor<1x2x6x1024x128xf32>) -> tensor<1x2x6x1024x128xf32>
    %3860 = tosa.reshape %3859 {new_shape = array<i64: 1, 12, 1024, 128>} : (tensor<1x2x6x1024x128xf32>) -> tensor<1x12x1024x128xf32>
    %3861 = tosa.reshape %17 {new_shape = array<i64: 1, 1, 1, 1024>} : (tensor<1x1024xi1>) -> tensor<1x1x1x1024xi1>
    %cst_1016 = arith.constant 0xFF800000 : f32
    %cst_1017 = arith.constant 0.000000e+00 : f32
    %3862 = tensor.empty() : tensor<1x1x1x1024xf32>
    %splat_1018 = tensor.splat %cst_1017 : tensor<1x1x1x1024xf32>
    %splat_1019 = tensor.splat %cst_1016 : tensor<1x1x1x1024xf32>
    %3863 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3861, %splat_1018, %splat_1019 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%3862 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_1031: f32, %in_1032: f32, %out: f32):
      %3945 = arith.select %in, %in_1031, %in_1032 : f32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1x1024xf32>
    %cst_1020 = arith.constant 0.000000e+00 : f32
    %splat_1021 = tensor.splat %cst_1020 : tensor<1x1024xf32>
    %3864 = tosa.reshape %3863 {new_shape = array<i64: 1, 1024>} : (tensor<1x1x1x1024xf32>) -> tensor<1x1024xf32>
    %3865 = tosa.add %splat_1021, %3864 : (tensor<1x1024xf32>, tensor<1x1024xf32>) -> tensor<1x1024xf32>
    %3866 = "tosa.const"() <{value = dense<[0, 1, 3, 2]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3867 = tosa.transpose %3856, %3866 : (tensor<1x12x1024x128xf32>, tensor<4xi32>) -> tensor<1x12x128x1024xf32>
    %3868 = tosa.reshape %3838 {new_shape = array<i64: 12, 1, 128>} : (tensor<1x12x1x128xf32>) -> tensor<12x1x128xf32>
    %3869 = tosa.reshape %3867 {new_shape = array<i64: 12, 128, 1024>} : (tensor<1x12x128x1024xf32>) -> tensor<12x128x1024xf32>
    %3870 = tosa.matmul %3868, %3869 : (tensor<12x1x128xf32>, tensor<12x128x1024xf32>) -> tensor<12x1x1024xf32>
    %cst_1022 = arith.constant 0.0883883461 : f32
    %splat_1023 = tensor.splat %cst_1022 : tensor<12x1x1024xf32>
    %3871 = tosa.mul %3870, %splat_1023 : (tensor<12x1x1024xf32>, tensor<12x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3872 = tosa.reshape %3865 {new_shape = array<i64: 1, 1, 1024>} : (tensor<1x1024xf32>) -> tensor<1x1x1024xf32>
    %3873 = tosa.add %3871, %3872 : (tensor<12x1x1024xf32>, tensor<1x1x1024xf32>) -> tensor<12x1x1024xf32>
    %3874 = tosa.reduce_max %3873 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3875 = tosa.sub %3873, %3874 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3876 = math.exp %3875 : tensor<12x1x1024xf32>
    %3877 = tosa.reduce_sum %3876 {axis = 2 : i32} : (tensor<12x1x1024xf32>) -> tensor<12x1x1xf32>
    %3878 = tosa.log %3877 : (tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3879 = tosa.add %3874, %3878 : (tensor<12x1x1xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1xf32>
    %3880 = tosa.sub %3873, %3879 : (tensor<12x1x1024xf32>, tensor<12x1x1xf32>) -> tensor<12x1x1024xf32>
    %3881 = math.exp %3880 : tensor<12x1x1024xf32>
    %3882 = tosa.reshape %3879 {new_shape = array<i64: 1, 12, 1>} : (tensor<12x1x1xf32>) -> tensor<1x12x1xf32>
    %3883 = tosa.reshape %3860 {new_shape = array<i64: 12, 1024, 128>} : (tensor<1x12x1024x128xf32>) -> tensor<12x1024x128xf32>
    %3884 = tosa.matmul %3881, %3883 : (tensor<12x1x1024xf32>, tensor<12x1024x128xf32>) -> tensor<12x1x128xf32>
    %3885 = tosa.reshape %3884 {new_shape = array<i64: 1, 12, 1, 128>} : (tensor<12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %3886 = "tosa.const"() <{value = dense<[0, 2, 1, 3]> : tensor<4xi32>}> : () -> tensor<4xi32>
    %3887 = tosa.transpose %3885, %3886 : (tensor<1x12x1x128xf32>, tensor<4xi32>) -> tensor<1x1x12x128xf32>
    %3888 = tosa.reshape %3887 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1x12x128xf32>) -> tensor<1x1x1536xf32>
    %3889 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3890 = tosa.transpose %arg392, %3889 : (tensor<1536x1536xf32>, tensor<2xi32>) -> tensor<1536x1536xf32>
    %3891 = tosa.reshape %3888 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_1024 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3892 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3891, %3890 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_1024 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3893 = tosa.reshape %3892 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3894 = tosa.add %3787, %3893 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3895 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_1025 = arith.constant 2 : i32
    %3896 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3894 : tensor<1x1x1536xf32>) outs(%3895 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_1025 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3897 = tosa.reduce_sum %3896 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3898 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3899 = tosa.reciprocal %3898 : (tensor<1xf32>) -> tensor<1xf32>
    %3900 = tosa.reshape %3899 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3901 = tosa.mul %3900, %3897 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3902 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3903 = tosa.add %3901, %3902 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3904 = tosa.rsqrt %3903 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3905 = tosa.mul %3894, %3904 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3906 = tosa.reshape %arg393 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3907 = tosa.mul %3906, %3905 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %3908 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3909 = tosa.transpose %arg394, %3908 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3910 = tosa.reshape %3907 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_1026 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3911 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3910, %3909 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_1026 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3912 = tosa.reshape %3911 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3913 = tosa.sigmoid %3912 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3914 = tosa.mul %3912, %3913 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3915 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3916 = tosa.transpose %arg395, %3915 : (tensor<8960x1536xf32>, tensor<2xi32>) -> tensor<1536x8960xf32>
    %3917 = tosa.reshape %3907 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_1027 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %3918 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3917, %3916 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_1027 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %3919 = tosa.reshape %3918 {new_shape = array<i64: 1, 1, 8960>} : (tensor<1x8960xf32>) -> tensor<1x1x8960xf32>
    %3920 = tosa.mul %3914, %3919 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %3921 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3922 = tosa.transpose %arg396, %3921 : (tensor<1536x8960xf32>, tensor<2xi32>) -> tensor<8960x1536xf32>
    %3923 = tosa.reshape %3920 {new_shape = array<i64: 1, 8960>} : (tensor<1x1x8960xf32>) -> tensor<1x8960xf32>
    %cst_1028 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %3924 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3923, %3922 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_1028 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %3925 = tosa.reshape %3924 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1x1536xf32>) -> tensor<1x1x1536xf32>
    %3926 = tosa.add %3894, %3925 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    
    
    //rms norm
    %3927 = tensor.empty() : tensor<1x1x1536xf32>
    %c2_i32_1029 = arith.constant 2 : i32
    %3928 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3926 : tensor<1x1x1536xf32>) outs(%3927 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3945 = math.fpowi %in, %c2_i32_1029 : f32, i32
      linalg.yield %3945 : f32
    } -> tensor<1x1x1536xf32>
    %3929 = tosa.reduce_sum %3928 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %3930 = "tosa.const"() <{value = dense<1.536000e+03> : tensor<1xf32>}> : () -> tensor<1xf32>
    %3931 = tosa.reciprocal %3930 : (tensor<1xf32>) -> tensor<1xf32>
    %3932 = tosa.reshape %3931 {new_shape = array<i64: 1, 1, 1>} : (tensor<1xf32>) -> tensor<1x1x1xf32>
    %3933 = tosa.mul %3932, %3929 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3934 = "tosa.const"() <{value = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %3935 = tosa.add %3933, %3934 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3936 = tosa.rsqrt %3935 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %3937 = tosa.mul %3926, %3936 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1536xf32>
    %3938 = tosa.reshape %arg397 {new_shape = array<i64: 1, 1, 1536>} : (tensor<1536xf32>) -> tensor<1x1x1536xf32>
    %3939 = tosa.mul %3938, %3937 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    // ===========================================
    // 10. FINAL OUTPUT PROJECTION LAYER
    // ===========================================
    // Project the final hidden states back to vocabulary space
    // Input: Final hidden states (1x40x1536) from last transformer layer
    // Weights: %arg341 (151936x1536) - vocabulary_size x hidden_dim
    // Output: Logits (1x40x151936) - probabilities over vocabulary
    
    %3940 = "tosa.const"() <{value = dense<[1, 0]> : tensor<2xi32>}> : () -> tensor<2xi32>
    %3941 = tosa.transpose %arg398, %3940 : (tensor<151936x1536xf32>, tensor<2xi32>) -> tensor<1536x151936xf32>
    %3942 = tosa.reshape %3939 {new_shape = array<i64: 1, 1536>} : (tensor<1x1x1536xf32>) -> tensor<1x1536xf32>
    %cst_1030 = arith.constant dense<0.000000e+00> : tensor<1x151936xf32>
    %3943 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%3942, %3941 : tensor<1x1536xf32>, tensor<1536x151936xf32>) outs(%cst_1030 : tensor<1x151936xf32>) -> tensor<1x151936xf32>
    %3944 = tosa.reshape %3943 {new_shape = array<i64: 1, 1, 151936>} : (tensor<1x151936xf32>) -> tensor<1x1x151936xf32>
    return %95, %99, %234, %238, %373, %377, %512, %516, %651, %655, %790, %794, %929, %933, %1068, %1072, %1207, %1211, %1346, %1350, %1485, %1489, %1624, %1628, %1763, %1767, %1902, %1906, %2041, %2045, %2180, %2184, %2319, %2323, %2458, %2462, %2597, %2601, %2736, %2740, %2875, %2879, %3014, %3018, %3153, %3157, %3292, %3296, %3431, %3435, %3570, %3574, %3709, %3713, %3848, %3852, %3944 : tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x1x151936xf32>
  }
}

